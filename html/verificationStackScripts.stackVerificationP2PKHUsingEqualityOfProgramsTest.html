<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="basicBitcoinDataType.html" class="Module">basicBitcoinDataType</a>

<a id="35" class="Keyword">module</a> <a id="42" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html" class="Module">verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest</a> <a id="117" class="Symbol">(</a><a id="118" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#118" class="Bound">param</a> <a id="124" class="Symbol">:</a> <a id="126" href="basicBitcoinDataType.html#1548" class="Record">GlobalParameters</a><a id="142" class="Symbol">)</a> <a id="144" class="Keyword">where</a>


<a id="152" class="Keyword">open</a> <a id="157" class="Keyword">import</a> <a id="164" href="Data.Nat.html" class="Module">Data.Nat</a>  <a id="174" class="Keyword">hiding</a> <a id="181" class="Symbol">(</a><a id="182" href="Data.Nat.Base.html#1535" class="Datatype Operator">_≤_</a><a id="185" class="Symbol">)</a>
<a id="187" class="Keyword">open</a> <a id="192" class="Keyword">import</a> <a id="199" href="Data.List.html" class="Module">Data.List</a> <a id="209" class="Keyword">hiding</a> <a id="216" class="Symbol">(</a><a id="217" href="Data.List.Base.html#1810" class="Function Operator">_++_</a><a id="221" class="Symbol">)</a>
<a id="223" class="Keyword">open</a> <a id="228" class="Keyword">import</a> <a id="235" href="Data.Unit.html" class="Module">Data.Unit</a>  <a id="246" class="Keyword">hiding</a> <a id="253" class="Symbol">(</a><a id="254" href="Data.Unit.Base.html#1023" class="Record Operator">_≤_</a><a id="257" class="Symbol">)</a>
<a id="259" class="Keyword">open</a> <a id="264" class="Keyword">import</a> <a id="271" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="282" class="Keyword">open</a> <a id="287" class="Keyword">import</a> <a id="294" href="Data.Sum.html" class="Module">Data.Sum</a>
<a id="303" class="Keyword">open</a> <a id="308" class="Keyword">import</a> <a id="315" href="Data.Bool.html" class="Module">Data.Bool</a>  <a id="326" class="Keyword">hiding</a> <a id="333" class="Symbol">(</a><a id="334" href="Data.Bool.Base.html#672" class="Datatype Operator">_≤_</a> <a id="338" class="Symbol">;</a> <a id="340" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a> <a id="354" class="Symbol">)</a> <a id="356" class="Keyword">renaming</a> <a id="365" class="Symbol">(</a><a id="366" href="Data.Bool.Base.html#986" class="Function Operator">_∧_</a> <a id="370" class="Symbol">to</a> <a id="373" class="Function Operator">_∧b_</a> <a id="378" class="Symbol">;</a> <a id="380" href="Data.Bool.Base.html#1044" class="Function Operator">_∨_</a> <a id="384" class="Symbol">to</a> <a id="387" class="Function Operator">_∨b_</a> <a id="392" class="Symbol">;</a> <a id="394" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="396" class="Symbol">to</a> <a id="399" class="Function">True</a><a id="403" class="Symbol">)</a>
<a id="405" class="Keyword">open</a> <a id="410" class="Keyword">import</a> <a id="417" href="Data.Product.html" class="Module">Data.Product</a> <a id="430" class="Keyword">renaming</a> <a id="439" class="Symbol">(</a><a id="440" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="444" class="Symbol">to</a> <a id="447" class="InductiveConstructor Operator">_,,_</a> <a id="452" class="Symbol">)</a>
<a id="454" class="Keyword">open</a> <a id="459" class="Keyword">import</a> <a id="466" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="480" class="Keyword">hiding</a> <a id="487" class="Symbol">(</a><a id="488" href="Data.Nat.Base.html#1535" class="Datatype Operator">_≤_</a><a id="491" class="Symbol">)</a>
<a id="493" class="Keyword">open</a> <a id="498" class="Keyword">import</a> <a id="505" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="524" class="Keyword">hiding</a> <a id="531" class="Symbol">(</a><a id="532" href="Data.List.NonEmpty.Base.html#1141" class="Field">head</a> <a id="537" class="Symbol">;</a> <a id="539" href="Data.List.NonEmpty.Base.html#1268" class="Function Operator">[_]</a> <a id="543" class="Symbol">)</a>
<a id="545" class="Keyword">open</a> <a id="550" class="Keyword">import</a> <a id="557" href="Data.Maybe.html" class="Module">Data.Maybe</a>
<a id="568" class="Keyword">open</a> <a id="573" class="Keyword">import</a> <a id="580" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>

<a id="598" class="Keyword">import</a> <a id="605" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="643" class="Symbol">as</a> <a id="646" class="Module">Eq</a>
<a id="649" class="Keyword">open</a> <a id="654" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="657" class="Keyword">using</a> <a id="663" class="Symbol">(</a><a id="664" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="667" class="Symbol">;</a> <a id="669" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="673" class="Symbol">;</a> <a id="675" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a><a id="679" class="Symbol">;</a> <a id="681" class="Keyword">module</a> <a id="688" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a><a id="699" class="Symbol">;</a> <a id="701" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a><a id="704" class="Symbol">)</a>
<a id="706" class="Keyword">open</a> <a id="711" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>
<a id="723" class="Keyword">open</a> <a id="728" class="Keyword">import</a> <a id="735" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>


<a id="759" class="Comment">--our libraries</a>
<a id="775" class="Keyword">open</a> <a id="780" class="Keyword">import</a> <a id="787" href="libraries.listLib.html" class="Module">libraries.listLib</a>
<a id="805" class="Keyword">open</a> <a id="810" class="Keyword">import</a> <a id="817" href="libraries.equalityLib.html" class="Module">libraries.equalityLib</a>
<a id="839" class="Keyword">open</a> <a id="844" class="Keyword">import</a> <a id="851" href="libraries.natLib.html" class="Module">libraries.natLib</a>
<a id="868" class="Keyword">open</a> <a id="873" class="Keyword">import</a> <a id="880" href="libraries.boolLib.html" class="Module">libraries.boolLib</a>
<a id="898" class="Keyword">open</a> <a id="903" class="Keyword">import</a> <a id="910" href="libraries.emptyLib.html" class="Module">libraries.emptyLib</a>
<a id="929" class="Keyword">open</a> <a id="934" class="Keyword">import</a> <a id="941" href="libraries.andLib.html" class="Module">libraries.andLib</a>
<a id="958" class="Keyword">open</a> <a id="963" class="Keyword">import</a> <a id="970" href="libraries.miscLib.html" class="Module">libraries.miscLib</a>
<a id="988" class="Keyword">open</a> <a id="993" class="Keyword">import</a> <a id="1000" href="libraries.maybeLib.html" class="Module">libraries.maybeLib</a>

<a id="1020" class="Keyword">open</a> <a id="1025" class="Keyword">import</a> <a id="1032" href="stack.html" class="Module">stack</a>
<a id="1038" class="Keyword">open</a> <a id="1043" class="Keyword">import</a> <a id="1050" href="stackPredicate.html" class="Module">stackPredicate</a>
<a id="1065" class="Keyword">open</a> <a id="1070" class="Keyword">import</a> <a id="1077" href="semanticBasicOperations.html" class="Module">semanticBasicOperations</a> <a id="1101" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#118" class="Bound">param</a>
<a id="1107" class="Keyword">open</a> <a id="1112" class="Keyword">import</a> <a id="1119" href="hoareTripleStack.html" class="Module">hoareTripleStack</a> <a id="1136" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#118" class="Bound">param</a>
<a id="1142" class="Keyword">open</a> <a id="1147" class="Keyword">import</a> <a id="1154" href="instruction.html" class="Module">instruction</a>
<a id="1166" class="Keyword">open</a> <a id="1171" class="Keyword">import</a> <a id="1178" href="verificationStackScripts.stackState.html" class="Module">verificationStackScripts.stackState</a>
<a id="1214" class="Keyword">open</a> <a id="1219" class="Keyword">import</a> <a id="1226" href="verificationStackScripts.sPredicate.html" class="Module">verificationStackScripts.sPredicate</a>
<a id="1262" class="Keyword">open</a> <a id="1267" class="Keyword">import</a> <a id="1274" href="verificationStackScripts.stackHoareTriple.html" class="Module">verificationStackScripts.stackHoareTriple</a> <a id="1316" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#118" class="Bound">param</a>
<a id="1322" class="Keyword">open</a> <a id="1327" class="Keyword">import</a> <a id="1334" href="verificationStackScripts.stackVerificationLemmas.html" class="Module">verificationStackScripts.stackVerificationLemmas</a> <a id="1383" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#118" class="Bound">param</a>
<a id="1389" class="Keyword">open</a> <a id="1394" class="Keyword">import</a> <a id="1401" href="verificationStackScripts.stackSemanticsInstructionsBasic.html" class="Module">verificationStackScripts.stackSemanticsInstructionsBasic</a> <a id="1458" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#118" class="Bound">param</a>
<a id="1464" class="Keyword">open</a> <a id="1469" class="Keyword">import</a> <a id="1476" href="verificationStackScripts.semanticsStackInstructions.html" class="Module">verificationStackScripts.semanticsStackInstructions</a> <a id="1528" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#118" class="Bound">param</a>
<a id="1534" class="Keyword">open</a> <a id="1539" class="Keyword">import</a> <a id="1546" href="verificationStackScripts.stackVerificationP2PKH.html" class="Module">verificationStackScripts.stackVerificationP2PKH</a> <a id="1594" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#118" class="Bound">param</a>
<a id="1600" class="Keyword">open</a> <a id="1605" class="Keyword">import</a> <a id="1612" href="verificationStackScripts.stackVerificationP2PKHindexed.html" class="Module">verificationStackScripts.stackVerificationP2PKHindexed</a> <a id="1667" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#118" class="Bound">param</a>





<a id="1678" class="Keyword">postulate</a> <a id="timeTest"></a><a id="1688" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1688" class="Postulate">timeTest</a> <a id="1697" class="Symbol">:</a> <a id="1699" href="basicBitcoinDataType.html#694" class="Function">Time</a>
<a id="1704" class="Keyword">postulate</a> <a id="msgTest₁"></a><a id="1714" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1714" class="Postulate">msgTest₁</a> <a id="1723" class="Symbol">:</a> <a id="1725" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a>
<a id="1729" class="Keyword">postulate</a> <a id="stackTest"></a><a id="1739" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1739" class="Postulate">stackTest</a> <a id="1749" class="Symbol">:</a> <a id="1751" href="stack.html#772" class="Function">Stack</a>
<a id="1757" class="Keyword">postulate</a> <a id="stackTest2"></a><a id="1767" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1767" class="Postulate">stackTest2</a> <a id="1778" class="Symbol">:</a> <a id="1780" href="stack.html#772" class="Function">Stack</a>
<a id="1786" class="Keyword">postulate</a> <a id="pbkhTest"></a><a id="1796" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1796" class="Postulate">pbkhTest</a> <a id="1805" class="Symbol">:</a> <a id="1807" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1809" class="Keyword">postulate</a> <a id="pbk"></a><a id="1819" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1819" class="Postulate">pbk</a> <a id="1823" class="Symbol">:</a> <a id="1825" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1827" class="Keyword">postulate</a> <a id="xTest"></a><a id="1837" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1837" class="Postulate">xTest</a> <a id="1843" class="Symbol">:</a> <a id="1845" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1847" class="Keyword">postulate</a> <a id="sigTest"></a><a id="1857" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1857" class="Postulate">sigTest</a> <a id="1865" class="Symbol">:</a> <a id="1867" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1869" class="Keyword">postulate</a> <a id="yTest"></a><a id="1879" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1879" class="Postulate">yTest</a> <a id="1885" class="Symbol">:</a> <a id="1887" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="1890" class="Comment">{- We first create a symbolic execution of the scriptP2PKH pbkhTest to see what kind
   of case distinction happens -}</a>

<a id="check"></a><a id="2010" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#2010" class="Function">check</a> <a id="2016" class="Symbol">=</a> <a id="2018" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a>

<a id="2032" class="Comment">--test P2PKH script</a>
<a id="testP2PKHscript"></a><a id="2052" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#2052" class="Function">testP2PKHscript</a> <a id="2068" class="Symbol">:</a> <a id="2070" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2076" href="stack.html#772" class="Function">Stack</a>
<a id="2082" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#2052" class="Function">testP2PKHscript</a> <a id="2098" class="Symbol">=</a> <a id="2100" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="2102" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="2115" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1796" class="Postulate">pbkhTest</a> <a id="2124" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="2127" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1688" class="Postulate">timeTest</a> <a id="2136" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1714" class="Postulate">msgTest₁</a> <a id="2145" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1739" class="Postulate">stackTest</a>



<a id="2158" class="Comment">--⟦ scriptP2PKH pbkhTest ⟧ˢ timeTest msgTest₁ stackTest</a>

<a id="2215" class="Comment">{- evaluation gives

executeStackDup stackTest &gt;&gt;=
(λ stack₁ →
   executeOpHash stack₁ &gt;&gt;=
   (λ stack₂ →
      executeStackEquality (pbkhTest ∷ stack₂) &gt;&gt;=
      (λ stack₄ →
         executeStackVerify stack₄ &gt;&gt;=
         (λ stack₄ → executeStackCheckSig msgTest₁ stack₄))))

-- Older was:

lift2Maybe
(λ stack₁ →
   lift2Maybe
   (λ stack₂ →
      lift2Maybe
      (λ stack₄ →
         lift2Maybe (λ stack₄ → executeStackCheckSig msgTest₁ stack₄)
         (executeStackVerify stack₄))
      (executeStackEquality (pbkhTest ∷ stack₂)))
   (executeOpHash stack₁))
(executeStackDup stackTest)

-}</a>


<a id="2813" class="Comment">{-
If we execute the last line
(executeStackDup stackTest)

we see it will give
nothing if stackTest = []
just something if stackTest is nonempty

So let&#39;s check what happens if stackTest = []
-}</a>


<a id="3011" class="Comment">--Empty</a>
<a id="testP2PKHscriptEmpty"></a><a id="3019" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#3019" class="Function">testP2PKHscriptEmpty</a> <a id="3040" class="Symbol">:</a> <a id="3042" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3048" href="stack.html#772" class="Function">Stack</a>
<a id="3054" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#3019" class="Function">testP2PKHscriptEmpty</a> <a id="3075" class="Symbol">=</a> <a id="3077" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="3079" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="3092" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1796" class="Postulate">pbkhTest</a> <a id="3101" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="3104" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1688" class="Postulate">timeTest</a> <a id="3113" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1714" class="Postulate">msgTest₁</a> <a id="3122" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>



<a id="3128" class="Comment">--⟦ scriptP2PKH pbkhTest ⟧ˢ timeTest msgTest₁ []</a>



<a id="3180" class="Comment">{- if we evaluate it we get:

nothing

So now get the first (trivial) theorem
(without the postulated parameters)
-}</a>


<a id="3299" class="Comment">--nothing</a>
<a id="stackfunP2PKHemptyIsNothing"></a><a id="3309" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#3309" class="Function">stackfunP2PKHemptyIsNothing</a> <a id="3337" class="Symbol">:</a> <a id="3339" class="Symbol">(</a><a id="3340" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#3340" class="Bound">pubKeyHash</a> <a id="3351" class="Symbol">:</a> <a id="3353" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="3354" class="Symbol">)(</a><a id="3356" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#3356" class="Bound">time₁</a> <a id="3362" class="Symbol">:</a> <a id="3364" href="basicBitcoinDataType.html#694" class="Function">Time</a><a id="3368" class="Symbol">)(</a><a id="3370" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#3370" class="Bound">msg₁</a> <a id="3375" class="Symbol">:</a> <a id="3377" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="3380" class="Symbol">)</a>
                              <a id="3412" class="Symbol">→</a> <a id="3414" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="3416" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="3429" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#3340" class="Bound">pubKeyHash</a> <a id="3440" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="3443" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#3356" class="Bound">time₁</a> <a id="3449" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#3370" class="Bound">msg₁</a> <a id="3454" class="InductiveConstructor">[]</a> <a id="3457" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3459" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="3467" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#3309" class="Function">stackfunP2PKHemptyIsNothing</a> <a id="3495" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#3495" class="Bound">pubKeyHash</a> <a id="3506" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#3506" class="Bound">time₁</a> <a id="3512" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#3512" class="Bound">msg₁</a> <a id="3517" class="Symbol">=</a> <a id="3519" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>




<a id="3528" class="Comment">{- Now we look at what happens if the stack is non empty

lets a test for symbolic execution -}</a>


<a id="3626" class="Comment">--nonestack</a>
<a id="teststackfunP2PKHNonEmptyStack"></a><a id="3638" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#3638" class="Function">teststackfunP2PKHNonEmptyStack</a> <a id="3669" class="Symbol">:</a>  <a id="3672" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3678" href="stack.html#772" class="Function">Stack</a>
<a id="3684" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#3638" class="Function">teststackfunP2PKHNonEmptyStack</a> <a id="3715" class="Symbol">=</a>  <a id="3718" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="3720" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="3733" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1796" class="Postulate">pbkhTest</a> <a id="3742" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="3745" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1688" class="Postulate">timeTest</a> <a id="3754" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1714" class="Postulate">msgTest₁</a> <a id="3763" class="Symbol">(</a><a id="3764" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1819" class="Postulate">pbk</a> <a id="3768" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3770" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1739" class="Postulate">stackTest</a><a id="3779" class="Symbol">)</a>


<a id="3783" class="Comment">{- If we compute it we get

executeStackVerify (compareNaturals pbkhTest (hashfun pbk) ∷ pbk ∷ stackTest)
&gt;&gt;= (λ stack₁ → executeStackCheckSig msgTest₁ stack₁)


-- Older version was
lift2Maybe (λ stack₁ → executeStackCheckSig msgTest₁ stack₁)
(executeStackVerify
 (compareNaturals pbkhTest (hashFun pbk) ∷ pbk ∷ stackTest))



We see that

(λ stack₁ → executeStackCheckSig msgTest₁ stack₁) = executeStackCheckSig msgTest₁

and can therefore use


executeStackVerify (compareNaturals pbkhTest (hashfun pbk) ∷ pbk ∷ stackTest)
&gt;&gt;= executeStackCheckSig msgTest₁

-- older version was
lift2Maybe (executeStackCheckSig msgTest₁)
(executeStackVerify
 (compareNaturals pbkhTest (hashFun pbk) ∷ pbk ∷ stackTest))

 -}</a>



<a id="4497" class="Comment">--stack empty</a>
<a id="stackfunP2PKHNonEmptyStack"></a><a id="4511" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4511" class="Function">stackfunP2PKHNonEmptyStack</a> <a id="4538" class="Symbol">:</a> <a id="4540" class="Symbol">(</a><a id="4541" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4541" class="Bound">pubKeyHash</a> <a id="4552" class="Symbol">:</a> <a id="4554" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="4555" class="Symbol">)(</a><a id="4557" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4557" class="Bound">msg₁</a> <a id="4562" class="Symbol">:</a> <a id="4564" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="4567" class="Symbol">)(</a><a id="4569" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4569" class="Bound">pbk</a> <a id="4573" class="Symbol">:</a> <a id="4575" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="4576" class="Symbol">)(</a><a id="4578" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4578" class="Bound">stack₁</a> <a id="4585" class="Symbol">:</a> <a id="4587" href="stack.html#772" class="Function">Stack</a><a id="4592" class="Symbol">)</a> <a id="4594" class="Symbol">→</a> <a id="4596" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="4602" href="stack.html#772" class="Function">Stack</a>
<a id="4608" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4511" class="Function">stackfunP2PKHNonEmptyStack</a> <a id="4635" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4635" class="Bound">pubKeyHash</a> <a id="4646" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4646" class="Bound">msg₁</a> <a id="4651" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4651" class="Bound">pbk</a> <a id="4655" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4655" class="Bound">stack₁</a>
              <a id="4676" class="Symbol">=</a> <a id="4678" href="semanticBasicOperations.html#1515" class="Function">executeStackVerify</a> <a id="4697" class="Symbol">(</a><a id="4698" href="libraries.natLib.html#1060" class="Function">compareNaturals</a> <a id="4714" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4635" class="Bound">pubKeyHash</a> <a id="4725" class="Symbol">(</a><a id="4726" href="semanticBasicOperations.html#1123" class="Function">hashFun</a> <a id="4734" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4651" class="Bound">pbk</a><a id="4737" class="Symbol">)</a> <a id="4739" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4741" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4651" class="Bound">pbk</a> <a id="4745" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4747" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4655" class="Bound">stack₁</a><a id="4753" class="Symbol">)</a>
                <a id="4771" href="Data.Maybe.Base.html#2227" class="Function Operator">&gt;&gt;=</a> <a id="4775" href="semanticBasicOperations.html#3305" class="Function">executeStackCheckSig</a> <a id="4796" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4646" class="Bound">msg₁</a>




<a id="4805" class="Comment">{-
and check that this is correct
-}</a>

<a id="stackfunP2PKHemptyNonEmptyStackCorrect"></a><a id="4843" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4843" class="Function">stackfunP2PKHemptyNonEmptyStackCorrect</a> <a id="4882" class="Symbol">:</a> <a id="4884" class="Symbol">(</a><a id="4885" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4885" class="Bound">pubKeyHash</a> <a id="4896" class="Symbol">:</a> <a id="4898" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="4899" class="Symbol">)(</a><a id="4901" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4901" class="Bound">time₁</a> <a id="4907" class="Symbol">:</a> <a id="4909" href="basicBitcoinDataType.html#694" class="Function">Time</a><a id="4913" class="Symbol">)(</a><a id="4915" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4915" class="Bound">msg₁</a> <a id="4920" class="Symbol">:</a> <a id="4922" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="4925" class="Symbol">)(</a><a id="4927" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4927" class="Bound">pbk</a> <a id="4931" class="Symbol">:</a> <a id="4933" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="4934" class="Symbol">)(</a><a id="4936" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4936" class="Bound">stack₁</a> <a id="4943" class="Symbol">:</a> <a id="4945" href="stack.html#772" class="Function">Stack</a><a id="4950" class="Symbol">)</a>
        <a id="4960" class="Symbol">→</a> <a id="4962" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="4964" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="4977" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4885" class="Bound">pubKeyHash</a>  <a id="4989" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="4992" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4901" class="Bound">time₁</a> <a id="4998" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4915" class="Bound">msg₁</a> <a id="5003" class="Symbol">(</a><a id="5004" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4927" class="Bound">pbk</a> <a id="5008" class="InductiveConstructor Operator">∷</a> <a id="5010" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4936" class="Bound">stack₁</a><a id="5016" class="Symbol">)</a> <a id="5018" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5020" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4511" class="Function">stackfunP2PKHNonEmptyStack</a> <a id="5047" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4885" class="Bound">pubKeyHash</a> <a id="5058" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4915" class="Bound">msg₁</a>  <a id="5064" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4927" class="Bound">pbk</a> <a id="5068" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4936" class="Bound">stack₁</a>
<a id="5075" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#4843" class="Function">stackfunP2PKHemptyNonEmptyStackCorrect</a> <a id="5114" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5114" class="Bound">pubKeyHash</a> <a id="5125" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5125" class="Bound">time₁</a> <a id="5131" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5131" class="Bound">msg₁</a> <a id="5136" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5136" class="Bound">pbk</a> <a id="5140" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5140" class="Bound">stack₁</a> <a id="5147" class="Symbol">=</a> <a id="5149" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>



<a id="5157" class="Comment">{- We see now the case distinction depends on
   compres := compareNaturals pbkhTest (hashFun pbk)

since

executeStackVerify    (compres ∷  pbk ∷ stackTest)

will depend on whether compres is 0 or  suc x&#39;

so we abstract from

compres = compareNaturals pubKeyHash (hashFun pbk)

-}</a>

<a id="5441" class="Comment">--abstract</a>
<a id="stackfunP2PKHNonEmptyStackAbstracted"></a><a id="5452" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5452" class="Function">stackfunP2PKHNonEmptyStackAbstracted</a> <a id="5489" class="Symbol">:</a> <a id="5491" class="Symbol">(</a><a id="5492" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5492" class="Bound">msg₁</a> <a id="5497" class="Symbol">:</a> <a id="5499" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="5502" class="Symbol">)(</a><a id="5504" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5504" class="Bound">pbk</a> <a id="5508" class="Symbol">:</a> <a id="5510" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="5511" class="Symbol">)(</a><a id="5513" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5513" class="Bound">stack₁</a> <a id="5520" class="Symbol">:</a> <a id="5522" href="stack.html#772" class="Function">Stack</a><a id="5527" class="Symbol">)(</a><a id="5529" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5529" class="Bound">compareRes</a> <a id="5540" class="Symbol">:</a> <a id="5542" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="5543" class="Symbol">)</a>
                               <a id="5576" class="Symbol">→</a> <a id="5578" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5584" href="stack.html#772" class="Function">Stack</a>
<a id="5590" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5452" class="Function">stackfunP2PKHNonEmptyStackAbstracted</a> <a id="5627" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5627" class="Bound">msg₁</a> <a id="5632" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5632" class="Bound">pbk</a> <a id="5636" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5636" class="Bound">stack₁</a> <a id="5643" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5643" class="Bound">compareRes</a>
       <a id="5661" class="Symbol">=</a>  <a id="5664" href="semanticBasicOperations.html#1515" class="Function">executeStackVerify</a> <a id="5683" class="Symbol">(</a><a id="5684" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5643" class="Bound">compareRes</a> <a id="5695" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a>  <a id="5698" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5632" class="Bound">pbk</a> <a id="5702" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5704" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5636" class="Bound">stack₁</a><a id="5710" class="Symbol">)</a> <a id="5712" href="Data.Maybe.Base.html#2227" class="Function Operator">&gt;&gt;=</a> <a id="5716" href="semanticBasicOperations.html#3305" class="Function">executeStackCheckSig</a> <a id="5737" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5627" class="Bound">msg₁</a>



<a id="5745" class="Comment">{- and we show that this is the right function
-}</a>

<a id="stackfunP2PKHNonEmptyStackAbstractedCor"></a><a id="5796" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5796" class="Function">stackfunP2PKHNonEmptyStackAbstractedCor</a> <a id="5836" class="Symbol">:</a>  <a id="5839" class="Symbol">(</a><a id="5840" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5840" class="Bound">pubKeyHash</a> <a id="5851" class="Symbol">:</a> <a id="5853" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="5854" class="Symbol">)(</a><a id="5856" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5856" class="Bound">time₁</a> <a id="5862" class="Symbol">:</a> <a id="5864" href="basicBitcoinDataType.html#694" class="Function">Time</a><a id="5868" class="Symbol">)(</a><a id="5870" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5870" class="Bound">msg₁</a> <a id="5875" class="Symbol">:</a> <a id="5877" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="5880" class="Symbol">)(</a><a id="5882" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5882" class="Bound">pbk</a> <a id="5886" class="Symbol">:</a> <a id="5888" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="5889" class="Symbol">)(</a><a id="5891" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5891" class="Bound">stack₁</a> <a id="5898" class="Symbol">:</a> <a id="5900" href="stack.html#772" class="Function">Stack</a><a id="5905" class="Symbol">)</a>
                <a id="5923" class="Symbol">→</a> <a id="5925" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="5927" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="5940" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5840" class="Bound">pubKeyHash</a> <a id="5951" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="5954" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5856" class="Bound">time₁</a> <a id="5960" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5870" class="Bound">msg₁</a> <a id="5965" class="Symbol">(</a><a id="5966" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5882" class="Bound">pbk</a> <a id="5970" class="InductiveConstructor Operator">∷</a> <a id="5972" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5891" class="Bound">stack₁</a><a id="5978" class="Symbol">)</a>
                   <a id="5999" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6001" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5452" class="Function">stackfunP2PKHNonEmptyStackAbstracted</a>  <a id="6039" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5870" class="Bound">msg₁</a> <a id="6044" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5882" class="Bound">pbk</a> <a id="6048" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5891" class="Bound">stack₁</a>
                           <a id="6082" class="Symbol">(</a><a id="6083" href="libraries.natLib.html#1060" class="Function">compareNaturals</a> <a id="6099" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5840" class="Bound">pubKeyHash</a> <a id="6110" class="Symbol">(</a><a id="6111" href="semanticBasicOperations.html#1123" class="Function">hashFun</a> <a id="6119" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5882" class="Bound">pbk</a><a id="6122" class="Symbol">))</a>
<a id="6125" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5796" class="Function">stackfunP2PKHNonEmptyStackAbstractedCor</a> <a id="6165" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#6165" class="Bound">pubKeyHash</a> <a id="6176" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#6176" class="Bound">time₁</a> <a id="6182" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#6182" class="Bound">msg₁</a> <a id="6187" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#6187" class="Bound">pbk</a> <a id="6191" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#6191" class="Bound">stack₁</a> <a id="6198" class="Symbol">=</a> <a id="6200" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>


<a id="6207" class="Comment">{- Now we investigate what  stackfunP2PKHNonEmptyStackAbstracted
When looking at it and see that

 stackfunP2PKHNonEmptyStackAbstracted msg₁ pbk stack₁ compareRes

will execute
executeStackVerify (compareRes ∷  pbk ∷ stack₁)
which will in turn make a case disctintion on whether compareRes is 0 or  not zero

(that corresponds to what the original function does because it makes this comparison
   compareNaturals pubKeyHash (hashFun pbk)
  which checks  whether the pbk provided  by the user hashes to the pubKeyHash of the locking script
    if it  is 0 it should fail, and if it is 1 it should succeed.

So lets make the test
-}</a>

<a id="testStackfunP2PKHNonEmptyStackAbstractedCompre0"></a><a id="6840" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#6840" class="Function">testStackfunP2PKHNonEmptyStackAbstractedCompre0</a> <a id="6888" class="Symbol">:</a> <a id="6890" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="6896" href="stack.html#772" class="Function">Stack</a>
<a id="6902" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#6840" class="Function">testStackfunP2PKHNonEmptyStackAbstractedCompre0</a> <a id="6950" class="Symbol">=</a> <a id="6952" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5452" class="Function">stackfunP2PKHNonEmptyStackAbstracted</a> <a id="6989" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1714" class="Postulate">msgTest₁</a> <a id="6998" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1819" class="Postulate">pbk</a> <a id="7002" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1739" class="Postulate">stackTest</a> <a id="7012" class="Number">0</a>

<a id="7015" class="Comment">{- if we evaluate it we get

nothing


We  show now this is always the case

-}</a>

<a id="stackfunP2PKHNonEmptyStackAbstractedCorCompr0IsNothing"></a><a id="7096" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#7096" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorCompr0IsNothing</a> <a id="7151" class="Symbol">:</a> <a id="7153" class="Symbol">(</a><a id="7154" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#7154" class="Bound">msg₁</a> <a id="7159" class="Symbol">:</a> <a id="7161" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="7164" class="Symbol">)(</a><a id="7166" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#7166" class="Bound">pbk</a> <a id="7170" class="Symbol">:</a> <a id="7172" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="7173" class="Symbol">)(</a><a id="7175" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#7175" class="Bound">stack₁</a> <a id="7182" class="Symbol">:</a> <a id="7184" href="stack.html#772" class="Function">Stack</a><a id="7189" class="Symbol">)</a>
      <a id="7197" class="Symbol">→</a>  <a id="7200" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5452" class="Function">stackfunP2PKHNonEmptyStackAbstracted</a> <a id="7237" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#7154" class="Bound">msg₁</a> <a id="7242" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#7166" class="Bound">pbk</a> <a id="7246" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#7175" class="Bound">stack₁</a> <a id="7253" class="Number">0</a> <a id="7255" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="7257" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="7265" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#7096" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorCompr0IsNothing</a> <a id="7320" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#7320" class="Bound">msg₁</a> <a id="7325" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#7325" class="Bound">pbk</a> <a id="7329" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#7329" class="Bound">stack₁</a> <a id="7336" class="Symbol">=</a> <a id="7338" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>


<a id="7345" class="Comment">{- Now we look at what happens  if the value is non zero -}</a>


<a id="testStackfunP2PKHNonEmptyStackAbstractedCompreSucCase"></a><a id="7407" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#7407" class="Function">testStackfunP2PKHNonEmptyStackAbstractedCompreSucCase</a> <a id="7461" class="Symbol">:</a> <a id="7463" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="7469" href="stack.html#772" class="Function">Stack</a>
<a id="7475" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#7407" class="Function">testStackfunP2PKHNonEmptyStackAbstractedCompreSucCase</a> <a id="7529" class="Symbol">=</a> <a id="7531" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5452" class="Function">stackfunP2PKHNonEmptyStackAbstracted</a> <a id="7568" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1714" class="Postulate">msgTest₁</a> <a id="7577" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1819" class="Postulate">pbk</a> <a id="7581" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1739" class="Postulate">stackTest</a> <a id="7591" class="Symbol">(</a><a id="7592" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="7596" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1837" class="Postulate">xTest</a><a id="7601" class="Symbol">)</a>

<a id="7604" class="Comment">{- if we evalute
     testStackfunP2PKHNonEmptyStackAbstractedCompreSucCase
    we get

executeStackCheckSig msgTest₁ (pbk ∷ stackTest)


This corresponds to the situation where
the original stack was non empty, and the comparision of the pbk with the pbkhash
got a result &gt; 0



If we look at
executeStackCheckSig

we see that it gives nothing when the stack has height &lt; 2
and otherwise does something,

so we can  make a case distinction on whether in

stackfunP2PKHNonEmptyStackAbstracted msg₁ pbk stack x

stack is [] or nonempty

So lets look at the easy case []

    -}</a>


<a id="8183" class="Comment">--easy case</a>
<a id="testStackfunP2PKHNonEmptyStackAbstractedCompreSucEmpty"></a><a id="8195" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8195" class="Function">testStackfunP2PKHNonEmptyStackAbstractedCompreSucEmpty</a> <a id="8250" class="Symbol">:</a> <a id="8252" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="8258" href="stack.html#772" class="Function">Stack</a>
<a id="8264" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8195" class="Function">testStackfunP2PKHNonEmptyStackAbstractedCompreSucEmpty</a> <a id="8319" class="Symbol">=</a>
                           <a id="8348" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5452" class="Function">stackfunP2PKHNonEmptyStackAbstracted</a> <a id="8385" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1714" class="Postulate">msgTest₁</a> <a id="8394" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1819" class="Postulate">pbk</a> <a id="8398" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="8401" class="Symbol">(</a><a id="8402" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="8406" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1837" class="Postulate">xTest</a><a id="8411" class="Symbol">)</a>


<a id="8415" class="Comment">{- if we evaluate it we get  result

nothing

we check that this always holds
-}</a>


<a id="stackfunP2PKHNonEmptyStackAbstractedCorComprSucStackEmpty"></a><a id="8498" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8498" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorComprSucStackEmpty</a> <a id="8556" class="Symbol">:</a> <a id="8558" class="Symbol">(</a><a id="8559" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8559" class="Bound">msg₁</a> <a id="8564" class="Symbol">:</a> <a id="8566" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="8569" class="Symbol">)(</a><a id="8571" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8571" class="Bound">pbk</a> <a id="8575" class="Symbol">:</a> <a id="8577" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="8578" class="Symbol">)(</a><a id="8580" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8580" class="Bound">x</a> <a id="8582" class="Symbol">:</a> <a id="8584" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="8585" class="Symbol">)</a>
             <a id="8600" class="Symbol">→</a> <a id="8602" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5452" class="Function">stackfunP2PKHNonEmptyStackAbstracted</a> <a id="8639" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8559" class="Bound">msg₁</a> <a id="8644" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8571" class="Bound">pbk</a> <a id="8648" class="InductiveConstructor">[]</a> <a id="8651" class="Symbol">(</a><a id="8652" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="8656" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8580" class="Bound">x</a><a id="8657" class="Symbol">)</a> <a id="8659" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="8661" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="8669" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8498" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorComprSucStackEmpty</a> <a id="8727" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8727" class="Bound">msg₁</a> <a id="8732" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8732" class="Bound">pbk</a> <a id="8736" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8736" class="Bound">x</a>  <a id="8739" class="Symbol">=</a> <a id="8741" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="8747" class="Comment">{-  Intermezzo: we can see that the fanction gives always nothing if the stack is empty
   independent of the result

But this result is not really needed (so can be probably be ommitted in the paper)
   -}</a>



<a id="stackfunP2PKHNonEmptyStackAbstractedCorEmptysNothing"></a><a id="8957" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8957" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorEmptysNothing</a> <a id="9010" class="Symbol">:</a> <a id="9012" class="Symbol">(</a><a id="9013" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9013" class="Bound">msg₁</a> <a id="9018" class="Symbol">:</a> <a id="9020" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="9023" class="Symbol">)(</a><a id="9025" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9025" class="Bound">pbk</a> <a id="9029" class="Symbol">:</a> <a id="9031" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="9032" class="Symbol">)(</a><a id="9034" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9034" class="Bound">x</a> <a id="9036" class="Symbol">:</a> <a id="9038" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="9039" class="Symbol">)</a>
      <a id="9047" class="Symbol">→</a>  <a id="9050" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5452" class="Function">stackfunP2PKHNonEmptyStackAbstracted</a> <a id="9087" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9013" class="Bound">msg₁</a> <a id="9092" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9025" class="Bound">pbk</a> <a id="9096" class="InductiveConstructor">[]</a> <a id="9099" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9034" class="Bound">x</a> <a id="9101" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="9103" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

<a id="9112" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8957" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorEmptysNothing</a> <a id="9165" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9165" class="Bound">msg₁</a> <a id="9170" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9170" class="Bound">pbk₁</a> <a id="9175" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="9180" class="Symbol">=</a> <a id="9182" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="9187" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8957" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorEmptysNothing</a> <a id="9240" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9240" class="Bound">msg₁</a> <a id="9245" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9245" class="Bound">pbk₁</a> <a id="9250" class="Symbol">(</a><a id="9251" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="9255" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9255" class="Bound">x</a><a id="9256" class="Symbol">)</a> <a id="9258" class="Symbol">=</a> <a id="9260" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="9266" class="Comment">{- Now we look at what happens if we have non empty stack and comparision &gt; 0
-}</a>

<a id="9348" class="Comment">{- if we evaluate it we get

just (boolToNat (isSigned  msgTest₁ sigTest pbk) ∷ stackTest)



and we show that this is the case

-}</a>

<a id="9481" class="Comment">--stack nonempty</a>
<a id="testStackfunP2PKHNonEmptyStackAbstractedCompreSucNonEmpty"></a><a id="9498" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9498" class="Function">testStackfunP2PKHNonEmptyStackAbstractedCompreSucNonEmpty</a> <a id="9556" class="Symbol">:</a> <a id="9558" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="9564" href="stack.html#772" class="Function">Stack</a>
<a id="9570" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9498" class="Function">testStackfunP2PKHNonEmptyStackAbstractedCompreSucNonEmpty</a> <a id="9628" class="Symbol">=</a> <a id="9630" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5452" class="Function">stackfunP2PKHNonEmptyStackAbstracted</a> <a id="9667" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1714" class="Postulate">msgTest₁</a> <a id="9676" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1819" class="Postulate">pbk</a> <a id="9680" class="Symbol">(</a><a id="9681" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1857" class="Postulate">sigTest</a>  <a id="9690" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9692" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1739" class="Postulate">stackTest</a><a id="9701" class="Symbol">)</a> <a id="9703" class="Symbol">(</a><a id="9704" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="9708" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#1837" class="Postulate">xTest</a><a id="9713" class="Symbol">)</a>



<a id="stackfunP2PKHNonEmptyStackAbstractedCorComprSucStackNonEmptyCor"></a><a id="9718" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9718" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorComprSucStackNonEmptyCor</a> <a id="9782" class="Symbol">:</a>
       <a id="9791" class="Symbol">(</a><a id="9792" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9792" class="Bound">msg₁</a> <a id="9797" class="Symbol">:</a> <a id="9799" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="9802" class="Symbol">)(</a><a id="9804" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9804" class="Bound">pbk</a> <a id="9808" class="Symbol">:</a> <a id="9810" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="9811" class="Symbol">)(</a><a id="9813" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9813" class="Bound">x</a> <a id="9815" class="Symbol">:</a> <a id="9817" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="9818" class="Symbol">)(</a><a id="9820" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9820" class="Bound">sig₁</a> <a id="9825" class="Symbol">:</a> <a id="9827" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="9828" class="Symbol">)(</a><a id="9830" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9830" class="Bound">stack₁</a> <a id="9837" class="Symbol">:</a> <a id="9839" href="stack.html#772" class="Function">Stack</a><a id="9844" class="Symbol">)</a>
       <a id="9853" class="Symbol">→</a> <a id="9855" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5452" class="Function">stackfunP2PKHNonEmptyStackAbstracted</a> <a id="9892" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9792" class="Bound">msg₁</a> <a id="9897" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9804" class="Bound">pbk</a> <a id="9901" class="Symbol">(</a><a id="9902" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9820" class="Bound">sig₁</a>  <a id="9908" class="InductiveConstructor Operator">∷</a> <a id="9910" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9830" class="Bound">stack₁</a><a id="9916" class="Symbol">)</a> <a id="9918" class="Symbol">(</a><a id="9919" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="9923" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9813" class="Bound">x</a><a id="9924" class="Symbol">)</a>
          <a id="9936" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a>  <a id="9939" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="9944" class="Symbol">(</a><a id="9945" href="libraries.natLib.html#890" class="Function">boolToNat</a> <a id="9955" class="Symbol">(</a><a id="9956" href="semanticBasicOperations.html#3104" class="Function">isSigned</a>  <a id="9966" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9792" class="Bound">msg₁</a> <a id="9971" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9820" class="Bound">sig₁</a> <a id="9976" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9804" class="Bound">pbk</a><a id="9979" class="Symbol">)</a> <a id="9981" class="InductiveConstructor Operator">∷</a> <a id="9983" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9830" class="Bound">stack₁</a><a id="9989" class="Symbol">)</a>
<a id="9991" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#9718" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorComprSucStackNonEmptyCor</a> <a id="10055" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10055" class="Bound">msg₂</a> <a id="10060" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10060" class="Bound">pbk₁</a> <a id="10065" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10065" class="Bound">sig₁</a> <a id="10070" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10070" class="Bound">x</a> <a id="10072" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10072" class="Bound">stack₂</a> <a id="10079" class="Symbol">=</a> <a id="10081" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="10087" class="Comment">{- the following can be ommitted probably
   since we have digged out the function completely
   but here is anyway a theorem that the original function gives you nothing
         if the stack has hight 1 only

-}</a>


<a id="10303" class="Comment">{- this function is obolete but an interesting observation -}</a>

<a id="stackfunP2PKHemptySingleStackIsNothing"></a><a id="10366" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10366" class="Function">stackfunP2PKHemptySingleStackIsNothing</a> <a id="10405" class="Symbol">:</a> <a id="10407" class="Symbol">(</a><a id="10408" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10408" class="Bound">pubKeyHash</a> <a id="10419" class="Symbol">:</a> <a id="10421" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="10422" class="Symbol">)(</a><a id="10424" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10424" class="Bound">time₁</a> <a id="10430" class="Symbol">:</a> <a id="10432" href="basicBitcoinDataType.html#694" class="Function">Time</a><a id="10436" class="Symbol">)(</a><a id="10438" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10438" class="Bound">msg₁</a> <a id="10443" class="Symbol">:</a> <a id="10445" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="10448" class="Symbol">)(</a><a id="10450" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10450" class="Bound">pbk</a> <a id="10454" class="Symbol">:</a> <a id="10456" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="10457" class="Symbol">)</a>
        <a id="10467" class="Symbol">→</a> <a id="10469" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="10471" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="10484" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10408" class="Bound">pubKeyHash</a> <a id="10495" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="10498" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10424" class="Bound">time₁</a> <a id="10504" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10438" class="Bound">msg₁</a> <a id="10509" class="Symbol">(</a><a id="10510" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10450" class="Bound">pbk</a> <a id="10514" class="InductiveConstructor Operator">∷</a> <a id="10516" class="InductiveConstructor">[]</a><a id="10518" class="Symbol">)</a> <a id="10520" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="10522" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="10530" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10366" class="Function">stackfunP2PKHemptySingleStackIsNothing</a>  <a id="10570" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10570" class="Bound">pubKeyHash</a> <a id="10581" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10581" class="Bound">time₁</a> <a id="10587" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10587" class="Bound">msg₁</a> <a id="10592" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10592" class="Bound">pbk</a>
  <a id="10598" class="Symbol">=</a>  <a id="10601" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="10603" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="10616" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10570" class="Bound">pubKeyHash</a> <a id="10627" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="10630" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10581" class="Bound">time₁</a> <a id="10636" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10587" class="Bound">msg₁</a> <a id="10641" class="Symbol">(</a><a id="10642" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10592" class="Bound">pbk</a> <a id="10646" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10648" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="10650" class="Symbol">)</a>
               <a id="10667" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="10670" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5796" class="Function">stackfunP2PKHNonEmptyStackAbstractedCor</a> <a id="10710" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10570" class="Bound">pubKeyHash</a> <a id="10721" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10581" class="Bound">time₁</a> <a id="10727" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10587" class="Bound">msg₁</a> <a id="10732" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10592" class="Bound">pbk</a> <a id="10736" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>   <a id="10741" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
     <a id="10748" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5452" class="Function">stackfunP2PKHNonEmptyStackAbstracted</a>  <a id="10786" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10587" class="Bound">msg₁</a> <a id="10791" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10592" class="Bound">pbk</a> <a id="10795" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="10798" class="Symbol">(</a><a id="10799" href="libraries.natLib.html#1060" class="Function">compareNaturals</a> <a id="10815" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10570" class="Bound">pubKeyHash</a> <a id="10826" class="Symbol">(</a><a id="10827" href="semanticBasicOperations.html#1123" class="Function">hashFun</a> <a id="10835" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10592" class="Bound">pbk</a><a id="10838" class="Symbol">))</a>
               <a id="10856" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="10859" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8957" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorEmptysNothing</a> <a id="10912" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10587" class="Bound">msg₁</a> <a id="10917" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10592" class="Bound">pbk</a> <a id="10921" class="Symbol">(</a><a id="10922" href="libraries.natLib.html#1060" class="Function">compareNaturals</a> <a id="10938" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10570" class="Bound">pubKeyHash</a> <a id="10949" class="Symbol">(</a><a id="10950" href="semanticBasicOperations.html#1123" class="Function">hashFun</a> <a id="10958" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#10592" class="Bound">pbk</a><a id="10961" class="Symbol">))</a>   <a id="10966" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
     <a id="10973" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
     <a id="10986" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

<a id="10989" class="Comment">{- Now we have decoded the function -}</a>

<a id="11029" class="Comment">-- should be equal to stackfunP2PKHNonEmptyStackAbstracted (ignorning time)</a>
<a id="pspkhFunctionDecodedaux1"></a><a id="11105" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11105" class="Function">pspkhFunctionDecodedaux1</a> <a id="11130" class="Symbol">:</a> <a id="11132" class="Symbol">(</a><a id="11133" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11133" class="Bound">pbk</a> <a id="11137" class="Symbol">:</a> <a id="11139" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="11140" class="Symbol">)(</a><a id="11142" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11142" class="Bound">msg₁</a> <a id="11147" class="Symbol">:</a> <a id="11149" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="11152" class="Symbol">)(</a><a id="11154" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11154" class="Bound">stack₁</a> <a id="11161" class="Symbol">:</a> <a id="11163" href="stack.html#772" class="Function">Stack</a><a id="11168" class="Symbol">)(</a><a id="11170" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11170" class="Bound">cpRes</a> <a id="11176" class="Symbol">:</a> <a id="11178" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="11179" class="Symbol">)</a> <a id="11181" class="Symbol">→</a> <a id="11183" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="11189" href="stack.html#772" class="Function">Stack</a>
<a id="11195" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11105" class="Function">pspkhFunctionDecodedaux1</a> <a id="11220" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11220" class="Bound">pbk</a> <a id="11224" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11224" class="Bound">msg₁</a> <a id="11229" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="11232" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11232" class="Bound">cpRes</a> <a id="11238" class="Symbol">=</a> <a id="11240" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="11248" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11105" class="Function">pspkhFunctionDecodedaux1</a> <a id="11273" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11273" class="Bound">pbk</a> <a id="11277" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11277" class="Bound">msg₁</a> <a id="11282" class="Symbol">(</a><a id="11283" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11283" class="Bound">sig₁</a> <a id="11288" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="11290" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11290" class="Bound">stack₁</a><a id="11296" class="Symbol">)</a> <a id="11298" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="11303" class="Symbol">=</a> <a id="11305" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="11313" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11105" class="Function">pspkhFunctionDecodedaux1</a> <a id="11338" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11338" class="Bound">pbk</a> <a id="11342" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11342" class="Bound">msg₁</a> <a id="11347" class="Symbol">(</a><a id="11348" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11348" class="Bound">sig₁</a> <a id="11353" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="11355" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11355" class="Bound">stack₁</a><a id="11361" class="Symbol">)</a> <a id="11363" class="Symbol">(</a><a id="11364" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="11368" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11368" class="Bound">cpRes</a><a id="11373" class="Symbol">)</a> <a id="11375" class="Symbol">=</a> <a id="11377" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="11382" class="Symbol">(</a><a id="11383" href="libraries.natLib.html#890" class="Function">boolToNat</a> <a id="11393" class="Symbol">(</a><a id="11394" href="semanticBasicOperations.html#3104" class="Function">isSigned</a>  <a id="11404" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11342" class="Bound">msg₁</a> <a id="11409" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11348" class="Bound">sig₁</a> <a id="11414" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11338" class="Bound">pbk</a><a id="11417" class="Symbol">)</a> <a id="11419" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="11421" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11355" class="Bound">stack₁</a><a id="11427" class="Symbol">)</a>

<a id="11430" class="Comment">-- should be equal to   ⟦ scriptP2PKHᵇ pubKeyHash ⟧ˢ time₁ msg₁ stack₁   (where time is irrelevant)</a>
<a id="pspkhFunctionDecoded"></a><a id="11530" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11530" class="Function">pspkhFunctionDecoded</a> <a id="11551" class="Symbol">:</a> <a id="11553" class="Symbol">(</a><a id="11554" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11554" class="Bound">pbkh</a> <a id="11559" class="Symbol">:</a> <a id="11561" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="11562" class="Symbol">)(</a><a id="11564" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11564" class="Bound">msg₁</a> <a id="11569" class="Symbol">:</a> <a id="11571" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="11574" class="Symbol">)(</a><a id="11576" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11576" class="Bound">stack₁</a> <a id="11583" class="Symbol">:</a> <a id="11585" href="stack.html#772" class="Function">Stack</a><a id="11590" class="Symbol">)</a> <a id="11592" class="Symbol">→</a> <a id="11594" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="11600" href="stack.html#772" class="Function">Stack</a>
<a id="11606" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11530" class="Function">pspkhFunctionDecoded</a> <a id="11627" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11627" class="Bound">pbkh</a> <a id="11632" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11632" class="Bound">msg₁</a> <a id="11637" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="11640" class="Symbol">=</a> <a id="11642" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="11650" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11530" class="Function">pspkhFunctionDecoded</a> <a id="11671" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11671" class="Bound">pbkh</a> <a id="11676" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11676" class="Bound">msg₁</a> <a id="11681" class="Symbol">(</a><a id="11682" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11682" class="Bound">pbk</a> <a id="11686" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="11688" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11688" class="Bound">stack₁</a><a id="11694" class="Symbol">)</a> <a id="11696" class="Symbol">=</a> <a id="11698" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11105" class="Function">pspkhFunctionDecodedaux1</a> <a id="11723" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11682" class="Bound">pbk</a> <a id="11727" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11676" class="Bound">msg₁</a> <a id="11732" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11688" class="Bound">stack₁</a> <a id="11739" class="Symbol">(</a><a id="11740" href="libraries.natLib.html#1060" class="Function">compareNaturals</a> <a id="11756" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11671" class="Bound">pbkh</a> <a id="11761" class="Symbol">(</a><a id="11762" href="semanticBasicOperations.html#1123" class="Function">hashFun</a> <a id="11770" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11682" class="Bound">pbk</a><a id="11773" class="Symbol">))</a>

<a id="11777" class="Comment">{- we show it is correct
-}</a>

<a id="pspkhFunctionDecodedaux1cor"></a><a id="11806" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11806" class="Function">pspkhFunctionDecodedaux1cor</a> <a id="11834" class="Symbol">:</a> <a id="11836" class="Symbol">(</a><a id="11837" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11837" class="Bound">pbk</a> <a id="11841" class="Symbol">:</a> <a id="11843" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="11844" class="Symbol">)(</a><a id="11846" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11846" class="Bound">msg₁</a> <a id="11851" class="Symbol">:</a> <a id="11853" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="11856" class="Symbol">)(</a><a id="11858" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11858" class="Bound">stack₁</a> <a id="11865" class="Symbol">:</a> <a id="11867" href="stack.html#772" class="Function">Stack</a><a id="11872" class="Symbol">)(</a><a id="11874" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11874" class="Bound">cpRes</a> <a id="11880" class="Symbol">:</a> <a id="11882" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="11883" class="Symbol">)</a>
                          <a id="11911" class="Symbol">→</a> <a id="11913" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5452" class="Function">stackfunP2PKHNonEmptyStackAbstracted</a> <a id="11950" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11846" class="Bound">msg₁</a> <a id="11955" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11837" class="Bound">pbk</a> <a id="11959" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11858" class="Bound">stack₁</a> <a id="11966" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11874" class="Bound">cpRes</a>
                             <a id="12001" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12003" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11105" class="Function">pspkhFunctionDecodedaux1</a> <a id="12028" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11837" class="Bound">pbk</a> <a id="12032" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11846" class="Bound">msg₁</a> <a id="12037" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11858" class="Bound">stack₁</a> <a id="12044" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11874" class="Bound">cpRes</a>
<a id="12050" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11806" class="Function">pspkhFunctionDecodedaux1cor</a> <a id="12078" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12078" class="Bound">pbk₁</a> <a id="12083" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12083" class="Bound">msg₁</a> <a id="12088" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="12091" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12091" class="Bound">cpRes</a> <a id="12097" class="Symbol">=</a> <a id="12099" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#8957" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorEmptysNothing</a> <a id="12152" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12083" class="Bound">msg₁</a> <a id="12157" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12078" class="Bound">pbk₁</a> <a id="12162" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12091" class="Bound">cpRes</a>
<a id="12168" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11806" class="Function">pspkhFunctionDecodedaux1cor</a> <a id="12196" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12196" class="Bound">pbk₁</a> <a id="12201" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12201" class="Bound">msg₁</a> <a id="12206" class="Symbol">(</a><a id="12207" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12207" class="Bound">x</a> <a id="12209" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="12211" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12211" class="Bound">stack₁</a><a id="12217" class="Symbol">)</a> <a id="12219" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="12224" class="Symbol">=</a> <a id="12226" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="12231" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11806" class="Function">pspkhFunctionDecodedaux1cor</a> <a id="12259" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12259" class="Bound">pbk₁</a> <a id="12264" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12264" class="Bound">msg₁</a> <a id="12269" class="Symbol">(</a><a id="12270" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12270" class="Bound">x</a> <a id="12272" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="12274" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12274" class="Bound">stack₁</a><a id="12280" class="Symbol">)</a> <a id="12282" class="Symbol">(</a><a id="12283" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="12287" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12287" class="Bound">cpRes</a><a id="12292" class="Symbol">)</a> <a id="12294" class="Symbol">=</a> <a id="12296" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>


<a id="pspkhFunctionDecodedcor"></a><a id="12303" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12303" class="Function">pspkhFunctionDecodedcor</a> <a id="12327" class="Symbol">:</a> <a id="12329" class="Symbol">(</a><a id="12330" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12330" class="Bound">time₁</a> <a id="12336" class="Symbol">:</a> <a id="12338" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="12339" class="Symbol">)</a> <a id="12341" class="Symbol">(</a><a id="12342" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12342" class="Bound">pbkh</a> <a id="12347" class="Symbol">:</a> <a id="12349" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="12350" class="Symbol">)(</a><a id="12352" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12352" class="Bound">msg₁</a> <a id="12357" class="Symbol">:</a> <a id="12359" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="12362" class="Symbol">)(</a><a id="12364" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12364" class="Bound">stack₁</a> <a id="12371" class="Symbol">:</a> <a id="12373" href="stack.html#772" class="Function">Stack</a><a id="12378" class="Symbol">)</a>
           <a id="12391" class="Symbol">→</a> <a id="12393" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="12395" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="12408" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12342" class="Bound">pbkh</a> <a id="12413" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="12416" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12330" class="Bound">time₁</a> <a id="12422" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12352" class="Bound">msg₁</a> <a id="12427" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12364" class="Bound">stack₁</a>  <a id="12435" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12437" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11530" class="Function">pspkhFunctionDecoded</a> <a id="12458" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12342" class="Bound">pbkh</a>  <a id="12464" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12352" class="Bound">msg₁</a> <a id="12469" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12364" class="Bound">stack₁</a>
<a id="12476" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12303" class="Function">pspkhFunctionDecodedcor</a> <a id="12500" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12500" class="Bound">time₁</a> <a id="12506" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12506" class="Bound">pbkh</a> <a id="12511" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12511" class="Bound">msg₁</a> <a id="12516" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="12519" class="Symbol">=</a> <a id="12521" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="12526" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12303" class="Function">pspkhFunctionDecodedcor</a> <a id="12550" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12550" class="Bound">time₁</a> <a id="12556" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12556" class="Bound">pbkh</a> <a id="12561" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12561" class="Bound">msg₁</a> <a id="12566" class="Symbol">(</a><a id="12567" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12567" class="Bound">pbk</a> <a id="12571" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="12573" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12573" class="Bound">stack₁</a><a id="12579" class="Symbol">)</a> <a id="12581" class="Symbol">=</a>
       <a id="12590" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="12592" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="12605" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12556" class="Bound">pbkh</a> <a id="12610" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="12613" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12550" class="Bound">time₁</a> <a id="12619" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12561" class="Bound">msg₁</a> <a id="12624" class="Symbol">(</a><a id="12625" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12567" class="Bound">pbk</a> <a id="12629" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="12631" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12573" class="Bound">stack₁</a><a id="12637" class="Symbol">)</a>
          <a id="12649" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="12652" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5796" class="Function">stackfunP2PKHNonEmptyStackAbstractedCor</a> <a id="12692" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12556" class="Bound">pbkh</a> <a id="12697" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12550" class="Bound">time₁</a> <a id="12703" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12561" class="Bound">msg₁</a> <a id="12708" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12567" class="Bound">pbk</a> <a id="12712" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12573" class="Bound">stack₁</a> <a id="12719" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="12728" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#5452" class="Function">stackfunP2PKHNonEmptyStackAbstracted</a>  <a id="12766" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12561" class="Bound">msg₁</a> <a id="12771" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12567" class="Bound">pbk</a> <a id="12775" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12573" class="Bound">stack₁</a> <a id="12782" class="Symbol">(</a><a id="12783" href="libraries.natLib.html#1060" class="Function">compareNaturals</a> <a id="12799" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12556" class="Bound">pbkh</a> <a id="12804" class="Symbol">(</a><a id="12805" href="semanticBasicOperations.html#1123" class="Function">hashFun</a> <a id="12813" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12567" class="Bound">pbk</a><a id="12816" class="Symbol">))</a>
          <a id="12829" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="12832" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11806" class="Function">pspkhFunctionDecodedaux1cor</a> <a id="12860" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12567" class="Bound">pbk</a> <a id="12864" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12561" class="Bound">msg₁</a> <a id="12869" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12573" class="Bound">stack₁</a> <a id="12876" class="Symbol">(</a><a id="12877" href="libraries.natLib.html#1060" class="Function">compareNaturals</a> <a id="12893" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12556" class="Bound">pbkh</a> <a id="12898" class="Symbol">(</a><a id="12899" href="semanticBasicOperations.html#1123" class="Function">hashFun</a> <a id="12907" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12567" class="Bound">pbk</a><a id="12910" class="Symbol">))</a> <a id="12913" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="12922" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11105" class="Function">pspkhFunctionDecodedaux1</a> <a id="12947" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12567" class="Bound">pbk</a> <a id="12951" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12561" class="Bound">msg₁</a> <a id="12956" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12573" class="Bound">stack₁</a>    <a id="12966" class="Symbol">(</a><a id="12967" href="libraries.natLib.html#1060" class="Function">compareNaturals</a> <a id="12983" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12556" class="Bound">pbkh</a> <a id="12988" class="Symbol">(</a><a id="12989" href="semanticBasicOperations.html#1123" class="Function">hashFun</a> <a id="12997" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#12567" class="Bound">pbk</a><a id="13000" class="Symbol">))</a>
       <a id="13010" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

<a id="13013" class="Comment">{- Now we just verify the   hoare triple for the function we have found we have decoded

-}</a>

<a id="lemmaPHKcoraux3"></a><a id="13106" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13106" class="Function">lemmaPHKcoraux3</a> <a id="13122" class="Symbol">:</a> <a id="13124" class="Symbol">(</a><a id="13125" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13125" class="Bound">x₁</a> <a id="13128" class="Symbol">:</a> <a id="13130" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="13131" class="Symbol">)(</a><a id="13133" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13133" class="Bound">time</a> <a id="13138" class="Symbol">:</a> <a id="13140" href="basicBitcoinDataType.html#694" class="Function">Time</a><a id="13144" class="Symbol">)</a> <a id="13146" class="Symbol">(</a><a id="13147" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13147" class="Bound">msg₁</a> <a id="13152" class="Symbol">:</a> <a id="13154" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="13157" class="Symbol">)</a> <a id="13159" class="Symbol">(</a><a id="13160" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13160" class="Bound">x₂</a> <a id="13163" class="Symbol">:</a> <a id="13165" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="13166" class="Symbol">)(</a><a id="13168" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13168" class="Bound">s</a> <a id="13170" class="Symbol">:</a> <a id="13172" href="stack.html#772" class="Function">Stack</a><a id="13177" class="Symbol">)</a> <a id="13179" class="Symbol">(</a><a id="13180" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13180" class="Bound">x</a> <a id="13182" class="Symbol">:</a> <a id="13184" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="13185" class="Symbol">)</a> <a id="13187" class="Symbol">→</a>
                 <a id="13206" href="libraries.maybeLib.html#967" class="Function">liftPred2Maybe</a> <a id="13221" class="Symbol">(λ</a> <a id="13224" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13224" class="Bound">s₁</a> <a id="13227" class="Symbol">→</a> <a id="13229" href="stackPredicate.html#1397" class="Function">acceptStateˢ</a> <a id="13242" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13133" class="Bound">time</a> <a id="13247" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13147" class="Bound">msg₁</a> <a id="13252" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13224" class="Bound">s₁</a><a id="13254" class="Symbol">)</a>
                  <a id="13274" class="Symbol">(</a><a id="13275" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11105" class="Function">pspkhFunctionDecodedaux1</a> <a id="13300" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13125" class="Bound">x₁</a> <a id="13303" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13147" class="Bound">msg₁</a> <a id="13308" class="Symbol">(</a><a id="13309" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13160" class="Bound">x₂</a> <a id="13312" class="InductiveConstructor Operator">∷</a> <a id="13314" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13168" class="Bound">s</a><a id="13315" class="Symbol">)</a> <a id="13317" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13180" class="Bound">x</a><a id="13318" class="Symbol">)</a>
                  <a id="13338" class="Symbol">→</a> <a id="13340" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="13342" class="Symbol">(</a><a id="13343" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13180" class="Bound">x</a> <a id="13345" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13347" class="Number">0</a><a id="13348" class="Symbol">)</a>
<a id="13350" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13106" class="Function">lemmaPHKcoraux3</a> <a id="13366" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13366" class="Bound">x₁</a> <a id="13369" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13369" class="Bound">time</a> <a id="13374" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13374" class="Bound">msg₁</a> <a id="13379" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13379" class="Bound">x₂</a> <a id="13382" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13382" class="Bound">s</a> <a id="13384" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="13389" class="Symbol">()</a> <a id="13392" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13392" class="Bound">x₄</a>
<a id="13395" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13106" class="Function">lemmaPHKcoraux3</a> <a id="13411" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13411" class="Bound">x₁</a> <a id="13414" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13414" class="Bound">time</a> <a id="13419" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13419" class="Bound">msg₁</a> <a id="13424" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13424" class="Bound">x₂</a> <a id="13427" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13427" class="Bound">s</a> <a id="13429" class="Symbol">(</a><a id="13430" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="13434" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13434" class="Bound">x</a><a id="13435" class="Symbol">)</a> <a id="13437" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13437" class="Bound">x₃</a> <a id="13440" class="Symbol">()</a>

<a id="lemmaCompareNat2"></a><a id="13444" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13444" class="Function">lemmaCompareNat2</a> <a id="13461" class="Symbol">:</a> <a id="13463" class="Symbol">(</a> <a id="13465" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13465" class="Bound">x</a> <a id="13467" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13467" class="Bound">y</a> <a id="13469" class="Symbol">:</a> <a id="13471" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="13473" class="Symbol">)</a> <a id="13475" class="Symbol">→</a> <a id="13477" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="13479" class="Symbol">(</a><a id="13480" href="libraries.natLib.html#1060" class="Function">compareNaturals</a> <a id="13496" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13465" class="Bound">x</a> <a id="13498" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13467" class="Bound">y</a> <a id="13500" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13502" class="Number">0</a><a id="13503" class="Symbol">)</a> <a id="13505" class="Symbol">→</a> <a id="13507" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13465" class="Bound">x</a> <a id="13509" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13511" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13467" class="Bound">y</a>
<a id="13513" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13444" class="Function">lemmaCompareNat2</a> <a id="13530" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="13535" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="13540" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13540" class="Bound">p</a> <a id="13542" class="Symbol">=</a> <a id="13544" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="13549" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13444" class="Function">lemmaCompareNat2</a> <a id="13566" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="13571" class="Symbol">(</a><a id="13572" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="13576" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13576" class="Bound">y</a><a id="13577" class="Symbol">)</a> <a id="13579" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13579" class="Bound">p</a> <a id="13581" class="Symbol">=</a> <a id="13583" href="libraries.emptyLib.html#84" class="Function">efq</a> <a id="13587" class="Symbol">(</a><a id="13588" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13579" class="Bound">p</a> <a id="13590" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="13594" class="Symbol">)</a>
<a id="13596" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13444" class="Function">lemmaCompareNat2</a> <a id="13613" class="Symbol">(</a><a id="13614" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="13618" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13618" class="Bound">x</a><a id="13619" class="Symbol">)</a> <a id="13621" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="13626" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13626" class="Bound">p</a> <a id="13628" class="Symbol">=</a> <a id="13630" href="libraries.emptyLib.html#84" class="Function">efq</a> <a id="13634" class="Symbol">(</a><a id="13635" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13626" class="Bound">p</a> <a id="13637" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="13641" class="Symbol">)</a>
<a id="13643" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13444" class="Function">lemmaCompareNat2</a> <a id="13660" class="Symbol">(</a><a id="13661" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="13665" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13665" class="Bound">x</a><a id="13666" class="Symbol">)</a> <a id="13668" class="Symbol">(</a><a id="13669" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="13673" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13673" class="Bound">y</a><a id="13674" class="Symbol">)</a> <a id="13676" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13676" class="Bound">p</a> <a id="13678" class="Symbol">=</a> <a id="13680" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="13685" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="13689" class="Symbol">(</a><a id="13690" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13444" class="Function">lemmaCompareNat2</a> <a id="13707" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13665" class="Bound">x</a> <a id="13709" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13673" class="Bound">y</a> <a id="13711" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13676" class="Bound">p</a><a id="13712" class="Symbol">)</a>


<a id="lemmaPHKcoraux2"></a><a id="13716" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13716" class="Function">lemmaPHKcoraux2</a> <a id="13732" class="Symbol">:</a> <a id="13734" class="Symbol">(</a><a id="13735" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13735" class="Bound">pbk</a> <a id="13739" class="Symbol">:</a> <a id="13741" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="13742" class="Symbol">)(</a><a id="13744" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13744" class="Bound">time</a> <a id="13749" class="Symbol">:</a> <a id="13751" href="basicBitcoinDataType.html#694" class="Function">Time</a><a id="13755" class="Symbol">)</a> <a id="13757" class="Symbol">(</a><a id="13758" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13758" class="Bound">msg₁</a> <a id="13763" class="Symbol">:</a> <a id="13765" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="13768" class="Symbol">)</a> <a id="13770" class="Symbol">(</a><a id="13771" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13771" class="Bound">sig</a> <a id="13775" class="Symbol">:</a> <a id="13777" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="13778" class="Symbol">)(</a><a id="13780" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13780" class="Bound">s</a> <a id="13782" class="Symbol">:</a> <a id="13784" href="stack.html#772" class="Function">Stack</a><a id="13789" class="Symbol">)</a> <a id="13791" class="Symbol">(</a><a id="13792" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13792" class="Bound">cpRes</a> <a id="13798" class="Symbol">:</a> <a id="13800" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="13801" class="Symbol">)</a> <a id="13803" class="Symbol">→</a>
                 <a id="13822" href="libraries.maybeLib.html#967" class="Function">liftPred2Maybe</a> <a id="13837" class="Symbol">(λ</a> <a id="13840" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13840" class="Bound">s₁</a> <a id="13843" class="Symbol">→</a> <a id="13845" href="stackPredicate.html#1397" class="Function">acceptStateˢ</a> <a id="13858" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13744" class="Bound">time</a> <a id="13863" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13758" class="Bound">msg₁</a> <a id="13868" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13840" class="Bound">s₁</a><a id="13870" class="Symbol">)</a>
                  <a id="13890" class="Symbol">(</a><a id="13891" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#11105" class="Function">pspkhFunctionDecodedaux1</a> <a id="13916" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13735" class="Bound">pbk</a> <a id="13920" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13758" class="Bound">msg₁</a> <a id="13925" class="Symbol">(</a><a id="13926" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13771" class="Bound">sig</a> <a id="13930" class="InductiveConstructor Operator">∷</a> <a id="13932" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13780" class="Bound">s</a><a id="13933" class="Symbol">)</a> <a id="13935" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13792" class="Bound">cpRes</a><a id="13940" class="Symbol">)</a>
                  <a id="13960" class="Symbol">→</a> <a id="13962" href="libraries.natLib.html#1478" class="Function">NotFalse</a> <a id="13971" class="Symbol">(</a><a id="13972" href="libraries.natLib.html#890" class="Function">boolToNat</a> <a id="13982" class="Symbol">(</a><a id="13983" href="semanticBasicOperations.html#3104" class="Function">isSigned</a>  <a id="13993" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13758" class="Bound">msg₁</a> <a id="13998" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13771" class="Bound">sig</a> <a id="14002" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13735" class="Bound">pbk</a><a id="14005" class="Symbol">))</a>
<a id="14008" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#13716" class="Function">lemmaPHKcoraux2</a> <a id="14024" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#14024" class="Bound">pbk</a> <a id="14028" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#14028" class="Bound">time</a> <a id="14033" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#14033" class="Bound">msg₁</a> <a id="14038" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#14038" class="Bound">sig</a> <a id="14042" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#14042" class="Bound">s</a> <a id="14044" class="Symbol">(</a><a id="14045" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="14049" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#14049" class="Bound">cpRes</a><a id="14054" class="Symbol">)</a> <a id="14056" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#14056" class="Bound">p</a> <a id="14058" class="Symbol">=</a> <a id="14060" href="verificationStackScripts.stackVerificationP2PKHUsingEqualityOfProgramsTest.html#14056" class="Bound">p</a>
<a id="14062" class="Comment">{-
lemmaPTKHcoraux : (pbkh : ℕ)
   → &lt; weakestPreConditionP2PKHˢ pbkh &gt;gˢ
      (λ time msg₁ s → pspkhFunctionDecoded pbkh msg₁ s)
      &lt; acceptStateˢ &gt;
lemmaPTKHcoraux .(hashFun pbk) .==&gt;stg time msg₁ (pbk ∷ sig ∷ s) (conj refl and4)
      rewrite (lemmaCompareNat (hashFun pbk))
      = boolToNatNotFalseLemma (isSigned  msg₁ sig pbk) and4
lemmaPTKHcoraux pbkh .&lt;==stg time msg₁ (pbk ∷ sig ∷ s) x
    = conj (sym (lemmaCompareNat2 pbkh (hashFun pbk)
                 (lemmaPHKcoraux3 pbk time msg₁ sig s (compareNaturals pbkh (hashFun pbk)) x)))
           (boolToNatNotFalseLemma2 (isSigned  msg₁ sig pbk)
             (lemmaPHKcoraux2 pbk time msg₁ sig s ((compareNaturals pbkh (hashFun pbk))) x))

{- This lemma  is actually for the paper 1
   and follows because
    ⟦ scriptP2PKHᵇ pbkh ⟧ˢ  =  (λ time msg₁ s → pspkhFunctionDecoded pbkh msg₁ s)
-}

LemmaPTPKHcor : (pubKeyHash : ℕ)
  →   &lt;  weakestPreConditionP2PKHˢ pubKeyHash &gt;stack
        scriptP2PKHᵇ pubKeyHash
      &lt; acceptStateˢ   &gt;
LemmaPTPKHcor pbkh
    = lemmaTransferHoareTripleStack (weakestPreConditionP2PKHˢ pbkh) acceptStateˢ
        (λ time msg s → pspkhFunctionDecoded pbkh msg s )
        ⟦ scriptP2PKHᵇ pbkh ⟧ˢ
        (λ t m s → sym (pspkhFunctionDecodedcor t pbkh m s))
        (lemmaPTKHcoraux pbkh)
-}</a>

<a id="15347" class="Comment">{-
  The theorem follows because if the condition holds for the stackpredicate only
    it holds for with the ifstack as well

this step would only be done in paper 2

-}</a>
<a id="15518" class="Comment">{-
theoremPTPKHcor : (pubKeyHash : ℕ)(ifStack₁ : IfStack)
                (active : IsActiveIfStack ifStack₁)
  →   &lt;  liftStackPred2Pred (weakestPreConditionP2PKHˢ pubKeyHash)  ifStack₁ &gt;iff
        scriptP2PKHᵇ pubKeyHash
    &lt; liftStackPred2Pred acceptStateˢ  ifStack₁ &gt;
theoremPTPKHcor pubKeyHash ifStack₁ active =
   hoareTripleStack2HoareTriple ifStack₁ active (scriptP2PKHᵇ pubKeyHash) tt
      (wPreCondP2PKHˢ pubKeyHash) acceptStateˢ (LemmaPTPKHcor pubKeyHash)
-}</a>




<a id="15995" class="Comment">-- Some test cases used in the development</a>
<a id="16038" class="Comment">-- shows how to check for each step  what the functions are and how they compute</a>

<a id="16120" class="Comment">------------------------------------------- Tests ------------------------------------------------------------</a>






<a id="16237" class="Comment">{-
  stackfunP2PKHemptyNotCorrectPbkIsNothing : (pubKeyHash : ℕ)(time₁ : Time)(msg₁ : Msg)(stack₁ : State1)
        → ¬  (pubKeyHash ≡ hashFun pbk)
        → ⟦ scriptP2PKHᵇ pubKeyHash ⟧ˢ time₁ msg₁ (pbk ∷ []) ≡ nothing
  stackfunP2PKHemptyNotCorrectPbkIsNothing pubKeyHash time₁ msg₁ stack₁ = {!!}
-}</a>
</pre></body></html>