<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>verificationStackScripts.stackVerificationP2PKHsymbolicExecution</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="basicBitcoinDataType.html" class="Module">basicBitcoinDataType</a>

<a id="35" class="Keyword">module</a> <a id="42" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html" class="Module">verificationStackScripts.stackVerificationP2PKHsymbolicExecution</a> <a id="107" class="Symbol">(</a><a id="108" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#108" class="Bound">param</a> <a id="114" class="Symbol">:</a> <a id="116" href="basicBitcoinDataType.html#1548" class="Record">GlobalParameters</a><a id="132" class="Symbol">)</a>  <a id="135" class="Keyword">where</a>



<a id="144" class="Keyword">open</a> <a id="149" class="Keyword">import</a> <a id="156" href="Data.Nat.html" class="Module">Data.Nat</a>  <a id="166" class="Keyword">hiding</a> <a id="173" class="Symbol">(</a><a id="174" href="Data.Nat.Base.html#1535" class="Datatype Operator">_≤_</a><a id="177" class="Symbol">)</a>
<a id="179" class="Keyword">open</a> <a id="184" class="Keyword">import</a> <a id="191" href="Data.List.html" class="Module">Data.List</a> <a id="201" class="Keyword">hiding</a> <a id="208" class="Symbol">(</a><a id="209" href="Data.List.Base.html#1810" class="Function Operator">_++_</a><a id="213" class="Symbol">)</a>
<a id="215" class="Keyword">open</a> <a id="220" class="Keyword">import</a> <a id="227" href="Data.Unit.html" class="Module">Data.Unit</a>  <a id="238" class="Keyword">hiding</a> <a id="245" class="Symbol">(</a><a id="246" href="Data.Unit.Base.html#1023" class="Record Operator">_≤_</a><a id="249" class="Symbol">)</a>
<a id="251" class="Keyword">open</a> <a id="256" class="Keyword">import</a> <a id="263" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="274" class="Keyword">open</a> <a id="279" class="Keyword">import</a> <a id="286" href="Data.Sum.html" class="Module">Data.Sum</a>
<a id="295" class="Keyword">open</a> <a id="300" class="Keyword">import</a> <a id="307" href="Data.Bool.html" class="Module">Data.Bool</a>  <a id="318" class="Keyword">hiding</a> <a id="325" class="Symbol">(</a><a id="326" href="Data.Bool.Base.html#672" class="Datatype Operator">_≤_</a> <a id="330" class="Symbol">;</a> <a id="332" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a> <a id="346" class="Symbol">)</a> <a id="348" class="Keyword">renaming</a> <a id="357" class="Symbol">(</a><a id="358" href="Data.Bool.Base.html#986" class="Function Operator">_∧_</a> <a id="362" class="Symbol">to</a> <a id="365" class="Function Operator">_∧b_</a> <a id="370" class="Symbol">;</a> <a id="372" href="Data.Bool.Base.html#1044" class="Function Operator">_∨_</a> <a id="376" class="Symbol">to</a> <a id="379" class="Function Operator">_∨b_</a> <a id="384" class="Symbol">;</a> <a id="386" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="388" class="Symbol">to</a> <a id="391" class="Function">True</a><a id="395" class="Symbol">)</a>
<a id="397" class="Keyword">open</a> <a id="402" class="Keyword">import</a> <a id="409" href="Data.Product.html" class="Module">Data.Product</a> <a id="422" class="Keyword">renaming</a> <a id="431" class="Symbol">(</a><a id="432" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="436" class="Symbol">to</a> <a id="439" class="InductiveConstructor Operator">_,,_</a> <a id="444" class="Symbol">)</a>
<a id="446" class="Keyword">open</a> <a id="451" class="Keyword">import</a> <a id="458" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="472" class="Keyword">hiding</a> <a id="479" class="Symbol">(</a><a id="480" href="Data.Nat.Base.html#1535" class="Datatype Operator">_≤_</a><a id="483" class="Symbol">)</a>
<a id="485" class="Keyword">open</a> <a id="490" class="Keyword">import</a> <a id="497" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="516" class="Keyword">hiding</a> <a id="523" class="Symbol">(</a><a id="524" href="Data.List.NonEmpty.Base.html#1141" class="Field">head</a> <a id="529" class="Symbol">;</a> <a id="531" href="Data.List.NonEmpty.Base.html#1268" class="Function Operator">[_]</a> <a id="535" class="Symbol">)</a>
<a id="537" class="Keyword">open</a> <a id="542" class="Keyword">import</a> <a id="549" href="Data.Maybe.html" class="Module">Data.Maybe</a>
<a id="560" class="Keyword">open</a> <a id="565" class="Keyword">import</a> <a id="572" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>

<a id="590" class="Keyword">import</a> <a id="597" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="635" class="Symbol">as</a> <a id="638" class="Module">Eq</a>
<a id="641" class="Keyword">open</a> <a id="646" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="649" class="Keyword">using</a> <a id="655" class="Symbol">(</a><a id="656" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="659" class="Symbol">;</a> <a id="661" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="665" class="Symbol">;</a> <a id="667" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a><a id="671" class="Symbol">;</a> <a id="673" class="Keyword">module</a> <a id="680" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a><a id="691" class="Symbol">;</a> <a id="693" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a><a id="696" class="Symbol">)</a>
<a id="698" class="Keyword">open</a> <a id="703" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>
<a id="715" class="Keyword">open</a> <a id="720" class="Keyword">import</a> <a id="727" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>


<a id="751" class="Comment">--our libraries</a>
<a id="767" class="Keyword">open</a> <a id="772" class="Keyword">import</a> <a id="779" href="libraries.listLib.html" class="Module">libraries.listLib</a>
<a id="797" class="Keyword">open</a> <a id="802" class="Keyword">import</a> <a id="809" href="libraries.equalityLib.html" class="Module">libraries.equalityLib</a>
<a id="831" class="Keyword">open</a> <a id="836" class="Keyword">import</a> <a id="843" href="libraries.natLib.html" class="Module">libraries.natLib</a>
<a id="860" class="Keyword">open</a> <a id="865" class="Keyword">import</a> <a id="872" href="libraries.boolLib.html" class="Module">libraries.boolLib</a>
<a id="890" class="Keyword">open</a> <a id="895" class="Keyword">import</a> <a id="902" href="libraries.emptyLib.html" class="Module">libraries.emptyLib</a>
<a id="921" class="Keyword">open</a> <a id="926" class="Keyword">import</a> <a id="933" href="libraries.andLib.html" class="Module">libraries.andLib</a>
<a id="950" class="Keyword">open</a> <a id="955" class="Keyword">import</a> <a id="962" href="libraries.miscLib.html" class="Module">libraries.miscLib</a>
<a id="980" class="Keyword">open</a> <a id="985" class="Keyword">import</a> <a id="992" href="libraries.maybeLib.html" class="Module">libraries.maybeLib</a>

<a id="1012" class="Keyword">open</a> <a id="1017" class="Keyword">import</a> <a id="1024" href="stack.html" class="Module">stack</a>
<a id="1030" class="Keyword">open</a> <a id="1035" class="Keyword">import</a> <a id="1042" href="stackPredicate.html" class="Module">stackPredicate</a>
<a id="1057" class="Keyword">open</a> <a id="1062" class="Keyword">import</a> <a id="1069" href="semanticBasicOperations.html" class="Module">semanticBasicOperations</a> <a id="1093" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#108" class="Bound">param</a>
<a id="1099" class="Keyword">open</a> <a id="1104" class="Keyword">import</a> <a id="1111" href="hoareTripleStack.html" class="Module">hoareTripleStack</a> <a id="1128" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#108" class="Bound">param</a>
<a id="1134" class="Keyword">open</a> <a id="1139" class="Keyword">import</a> <a id="1146" href="instruction.html" class="Module">instruction</a>
<a id="1158" class="Keyword">open</a> <a id="1163" class="Keyword">import</a> <a id="1170" href="verificationStackScripts.stackState.html" class="Module">verificationStackScripts.stackState</a>
<a id="1206" class="Keyword">open</a> <a id="1211" class="Keyword">import</a> <a id="1218" href="verificationStackScripts.sPredicate.html" class="Module">verificationStackScripts.sPredicate</a>
<a id="1254" class="Keyword">open</a> <a id="1259" class="Keyword">import</a> <a id="1266" href="verificationStackScripts.stackHoareTriple.html" class="Module">verificationStackScripts.stackHoareTriple</a> <a id="1308" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#108" class="Bound">param</a>
<a id="1314" class="Keyword">open</a> <a id="1319" class="Keyword">import</a> <a id="1326" href="verificationStackScripts.stackVerificationLemmas.html" class="Module">verificationStackScripts.stackVerificationLemmas</a> <a id="1375" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#108" class="Bound">param</a>
<a id="1381" class="Keyword">open</a> <a id="1386" class="Keyword">import</a> <a id="1393" href="verificationStackScripts.stackSemanticsInstructionsBasic.html" class="Module">verificationStackScripts.stackSemanticsInstructionsBasic</a> <a id="1450" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#108" class="Bound">param</a>
<a id="1456" class="Keyword">open</a> <a id="1461" class="Keyword">import</a> <a id="1468" href="verificationStackScripts.semanticsStackInstructions.html" class="Module">verificationStackScripts.semanticsStackInstructions</a> <a id="1520" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#108" class="Bound">param</a>
<a id="1526" class="Keyword">open</a> <a id="1531" class="Keyword">import</a> <a id="1538" href="verificationStackScripts.stackVerificationP2PKH.html" class="Module">verificationStackScripts.stackVerificationP2PKH</a> <a id="1586" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#108" class="Bound">param</a>
<a id="1592" class="Keyword">open</a> <a id="1597" class="Keyword">import</a> <a id="1604" href="verificationStackScripts.stackVerificationP2PKHindexed.html" class="Module">verificationStackScripts.stackVerificationP2PKHindexed</a> <a id="1659" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#108" class="Bound">param</a>

<a id="1666" class="Comment">-------------------------------------------------------------</a>
<a id="1728" class="Comment">--   This file explores the symoblic execution of the P2PKH program</a>
<a id="1796" class="Comment">--     in order to determine the case distinction</a>
<a id="1846" class="Comment">--     and extract a program from it</a>
<a id="1883" class="Comment">--</a>
<a id="1886" class="Comment">--   This is done by postulating parameters and applying ⟦ scriptP2PKHᵇ pbkh ⟧ˢ</a>
<a id="1966" class="Comment">--     to parameters</a>
<a id="1987" class="Comment">--------------------------------------------------------------------------------</a>


<a id="2070" class="Keyword">private</a>
  <a id="2080" class="Keyword">postulate</a> <a id="time₁"></a><a id="2090" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2090" class="Postulate">time₁</a> <a id="2096" class="Symbol">:</a> <a id="2098" href="basicBitcoinDataType.html#694" class="Function">Time</a>
  <a id="2105" class="Keyword">postulate</a> <a id="msg₁"></a><a id="2115" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2115" class="Postulate">msg₁</a> <a id="2120" class="Symbol">:</a> <a id="2122" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a>
  <a id="2128" class="Keyword">postulate</a> <a id="stack₁"></a><a id="2138" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2138" class="Postulate">stack₁</a> <a id="2145" class="Symbol">:</a> <a id="2147" href="stack.html#772" class="Function">Stack</a>
  <a id="2155" class="Keyword">postulate</a> <a id="pbkh"></a><a id="2165" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2165" class="Postulate">pbkh</a> <a id="2170" class="Symbol">:</a> <a id="2172" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
  <a id="2176" class="Keyword">postulate</a> <a id="pbk"></a><a id="2186" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2186" class="Postulate">pbk</a> <a id="2190" class="Symbol">:</a> <a id="2192" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
  <a id="2196" class="Keyword">postulate</a> <a id="x₁"></a><a id="2206" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2206" class="Postulate">x₁</a> <a id="2209" class="Symbol">:</a> <a id="2211" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
  <a id="2215" class="Keyword">postulate</a> <a id="sig₁"></a><a id="2225" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2225" class="Postulate">sig₁</a> <a id="2230" class="Symbol">:</a> <a id="2232" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>


<a id="2236" class="Comment">{- We first create a symbolic execution of the scriptP2PKHᵇ pbkh to see what kind
   of case distinction happens -}</a>

<a id="check"></a><a id="2353" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2353" class="Function">check</a> <a id="2359" class="Symbol">=</a> <a id="2361" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a>

<a id="2375" class="Comment">--test P2PKHscript</a>
<a id="testP2PKHscript"></a><a id="2394" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2394" class="Function">testP2PKHscript</a> <a id="2410" class="Symbol">:</a> <a id="2412" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2418" href="stack.html#772" class="Function">Stack</a>
<a id="2424" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2394" class="Function">testP2PKHscript</a> <a id="2440" class="Symbol">=</a> <a id="2442" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="2444" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="2457" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2165" class="Postulate">pbkh</a> <a id="2462" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="2465" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2090" class="Postulate">time₁</a> <a id="2471" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2115" class="Postulate">msg₁</a> <a id="2476" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2138" class="Postulate">stack₁</a>



<a id="2486" class="Comment">--⟦ scriptP2PKHᵇ pbkh ⟧ˢ time₁ msg₁ stack</a>

<a id="2529" class="Comment">{- evaluation gives

executeStackDup stack₁ &gt;&gt;=
(λ stack₂ →
   executeOpHash stack₂ &gt;&gt;=
   (λ stack₃ →
      executeStackEquality (pbkh ∷ stack₃) &gt;&gt;=
      (λ stack₄ →
         executeStackVerify stack₄ &gt;&gt;=
         (λ stack₅ → executeStackCheckSig msg₁ stack₅))))

Improved layout
executeStackDup stack₁ &gt;&gt;= (λ stack₂ →  executeOpHash stack₂ &gt;&gt;=
   (λ stack₃ →  executeStackEquality (pbkh ∷ stack₃) &gt;&gt;=
   (λ stack₄ →  executeStackVerify stack₄ &gt;&gt;=
   (λ stack₅ → executeStackCheckSig msg₁ stack₅))))



-- old version was

lift2Maybe
(λ stack₂ →
   lift2Maybe
   (λ stack₃ →
      lift2Maybe
      (λ stack₄ →
         lift2Maybe (λ stack₅ → executeStackCheckSig msg₁ stack₅)
         (executeStackVerify stack₄))
      (executeStackEquality (pbkh ∷ stack₃)))
   (executeOpHash stack₂))
(executeStackDup stack₁)

-}</a>

<a id="3348" class="Comment">-- We define a term giving the result of the evaluation</a>

<a id="testP2PKHscript2"></a><a id="3405" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#3405" class="Function">testP2PKHscript2</a> <a id="3422" class="Symbol">:</a> <a id="3424" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3430" href="stack.html#772" class="Function">Stack</a>
<a id="3436" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#3405" class="Function">testP2PKHscript2</a> <a id="3453" class="Symbol">=</a> <a id="3455" href="semanticBasicOperations.html#2255" class="Function">executeStackDup</a> <a id="3471" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2138" class="Postulate">stack₁</a> <a id="3478" href="Data.Maybe.Base.html#2227" class="Function Operator">&gt;&gt;=</a> <a id="3482" class="Symbol">λ</a> <a id="3484" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#3484" class="Bound">stack₂</a> <a id="3491" class="Symbol">→</a>  <a id="3494" href="semanticBasicOperations.html#1208" class="Function">executeOpHash</a> <a id="3508" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#3484" class="Bound">stack₂</a> <a id="3515" href="Data.Maybe.Base.html#2227" class="Function Operator">&gt;&gt;=</a> <a id="3519" class="Symbol">λ</a> <a id="3521" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#3521" class="Bound">stack₃</a> <a id="3528" class="Symbol">→</a>
                   <a id="3549" href="semanticBasicOperations.html#1692" class="Function">executeStackEquality</a> <a id="3570" class="Symbol">(</a><a id="3571" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2165" class="Postulate">pbkh</a> <a id="3576" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3578" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#3521" class="Bound">stack₃</a><a id="3584" class="Symbol">)</a> <a id="3586" href="Data.Maybe.Base.html#2227" class="Function Operator">&gt;&gt;=</a>   <a id="3592" class="Symbol">λ</a> <a id="3594" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#3594" class="Bound">stack₄</a> <a id="3601" class="Symbol">→</a>  <a id="3604" href="semanticBasicOperations.html#1515" class="Function">executeStackVerify</a> <a id="3623" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#3594" class="Bound">stack₄</a> <a id="3630" href="Data.Maybe.Base.html#2227" class="Function Operator">&gt;&gt;=</a> <a id="3634" class="Symbol">λ</a> <a id="3636" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#3636" class="Bound">stack₅</a> <a id="3643" class="Symbol">→</a>
                   <a id="3664" href="semanticBasicOperations.html#3305" class="Function">executeStackCheckSig</a> <a id="3685" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2115" class="Postulate">msg₁</a> <a id="3690" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#3636" class="Bound">stack₅</a>



<a id="3700" class="Comment">{-
If we execute the first line
(executeStackDup stack₁)

we see it will give
nothing if stack₁ = []
just something if stack₁ is nonempty

So let&#39;s check what happens if stack₁ = []
-}</a>


<a id="3887" class="Comment">--Empty</a>
<a id="testP2PKHscriptEmpty"></a><a id="3895" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#3895" class="Function">testP2PKHscriptEmpty</a> <a id="3916" class="Symbol">:</a> <a id="3918" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3924" href="stack.html#772" class="Function">Stack</a>
<a id="3930" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#3895" class="Function">testP2PKHscriptEmpty</a> <a id="3951" class="Symbol">=</a> <a id="3953" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="3955" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="3968" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2165" class="Postulate">pbkh</a> <a id="3973" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="3976" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2090" class="Postulate">time₁</a> <a id="3982" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2115" class="Postulate">msg₁</a> <a id="3987" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>



<a id="3993" class="Comment">--⟦ scriptP2PKHᵇ pbkh ⟧ˢ time₁ msg₁ []</a>



<a id="4035" class="Comment">{- if we evaluate it we get:

nothing

So now get the first (trivial) theorem
(without the postulated parameters)
-}</a>


<a id="4154" class="Comment">--nothing</a>
<a id="stackfunP2PKHemptyIsNothing"></a><a id="4164" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#4164" class="Function">stackfunP2PKHemptyIsNothing</a> <a id="4192" class="Symbol">:</a> <a id="4194" class="Symbol">(</a><a id="4195" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#4195" class="Bound">pubKeyHash</a> <a id="4206" class="Symbol">:</a> <a id="4208" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="4209" class="Symbol">)(</a><a id="4211" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#4211" class="Bound">time₁</a> <a id="4217" class="Symbol">:</a> <a id="4219" href="basicBitcoinDataType.html#694" class="Function">Time</a><a id="4223" class="Symbol">)(</a><a id="4225" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#4225" class="Bound">msg₁</a> <a id="4230" class="Symbol">:</a> <a id="4232" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="4235" class="Symbol">)</a>
                              <a id="4267" class="Symbol">→</a> <a id="4269" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="4271" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="4284" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#4195" class="Bound">pubKeyHash</a> <a id="4295" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="4298" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#4211" class="Bound">time₁</a> <a id="4304" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#4225" class="Bound">msg₁</a> <a id="4309" class="InductiveConstructor">[]</a> <a id="4312" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4314" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="4322" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#4164" class="Function">stackfunP2PKHemptyIsNothing</a> <a id="4350" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#4350" class="Bound">pubKeyHash</a> <a id="4361" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#4361" class="Bound">time₁</a> <a id="4367" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#4367" class="Bound">msg₁</a> <a id="4372" class="Symbol">=</a> <a id="4374" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>




<a id="4383" class="Comment">{- Now we look at what happens if the stack is non empty

lets a test for symbolic execution -}</a>


<a id="4481" class="Comment">--nonestack</a>
<a id="teststackfunP2PKHNonEmptyStack"></a><a id="4493" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#4493" class="Function">teststackfunP2PKHNonEmptyStack</a> <a id="4524" class="Symbol">:</a>  <a id="4527" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="4533" href="stack.html#772" class="Function">Stack</a>
<a id="4539" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#4493" class="Function">teststackfunP2PKHNonEmptyStack</a> <a id="4570" class="Symbol">=</a>  <a id="4573" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="4575" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="4588" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2165" class="Postulate">pbkh</a> <a id="4593" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="4596" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2090" class="Postulate">time₁</a> <a id="4602" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2115" class="Postulate">msg₁</a> <a id="4607" class="Symbol">(</a><a id="4608" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2186" class="Postulate">pbk</a> <a id="4612" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4614" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2138" class="Postulate">stack₁</a><a id="4620" class="Symbol">)</a>


<a id="4624" class="Comment">{- If we compute it we get
executeStackVerify (compareNaturals pbkh (param .hash pbk) ∷ pbk ∷ stack₁)
&gt;&gt;= (λ stack₂ → executeStackCheckSig msg₁ stack₂)

-- older version was
lift2Maybe (λ stack₂ → executeStackCheckSig msg₁ stack₂)
(executeStackVerify
 (compareNaturals pbkh (hashFun pbk) ∷ pbk ∷ stack₁))



We see that

(λ stack₂ → executeStackCheckSig msg₁ stack₂) = executeStackCheckSig msg₁

and can therefore use

executeStackVerify (compareNaturals pbkh (param .hash pbk) ∷ pbk ∷ stack₁)
&gt;&gt;= executeStackCheckSig msg₁

-- older version
lift2Maybe (executeStackCheckSig msg₁)
(executeStackVerify
 (compareNaturals pbkh (hashFun pbk) ∷ pbk ∷ stack₁))

 -}</a>



<a id="5287" class="Comment">--stack empty</a>
<a id="stackfunP2PKHNonEmptyStack"></a><a id="5301" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5301" class="Function">stackfunP2PKHNonEmptyStack</a> <a id="5328" class="Symbol">:</a> <a id="5330" class="Symbol">(</a><a id="5331" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5331" class="Bound">pubKeyHash</a> <a id="5342" class="Symbol">:</a> <a id="5344" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="5345" class="Symbol">)(</a><a id="5347" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5347" class="Bound">msg₁</a> <a id="5352" class="Symbol">:</a> <a id="5354" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="5357" class="Symbol">)(</a><a id="5359" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5359" class="Bound">pbk</a> <a id="5363" class="Symbol">:</a> <a id="5365" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="5366" class="Symbol">)(</a><a id="5368" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5368" class="Bound">stack₂</a> <a id="5375" class="Symbol">:</a> <a id="5377" href="stack.html#772" class="Function">Stack</a><a id="5382" class="Symbol">)</a> <a id="5384" class="Symbol">→</a> <a id="5386" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5392" href="stack.html#772" class="Function">Stack</a>
<a id="5398" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5301" class="Function">stackfunP2PKHNonEmptyStack</a> <a id="5425" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5425" class="Bound">pubKeyHash</a> <a id="5436" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5436" class="Bound">msg₁</a> <a id="5441" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5441" class="Bound">pbk</a> <a id="5445" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5445" class="Bound">stack₂</a>
              <a id="5466" class="Symbol">=</a> <a id="5468" href="semanticBasicOperations.html#1515" class="Function">executeStackVerify</a> <a id="5487" class="Symbol">(</a><a id="5488" href="libraries.natLib.html#1060" class="Function">compareNaturals</a> <a id="5504" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5425" class="Bound">pubKeyHash</a> <a id="5515" class="Symbol">(</a><a id="5516" href="semanticBasicOperations.html#1123" class="Function">hashFun</a> <a id="5524" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5441" class="Bound">pbk</a><a id="5527" class="Symbol">)</a> <a id="5529" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5531" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5441" class="Bound">pbk</a> <a id="5535" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5537" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5445" class="Bound">stack₂</a><a id="5543" class="Symbol">)</a>
                 <a id="5562" href="Data.Maybe.Base.html#2227" class="Function Operator">&gt;&gt;=</a> <a id="5566" href="semanticBasicOperations.html#3305" class="Function">executeStackCheckSig</a> <a id="5587" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5436" class="Bound">msg₁</a>




<a id="5596" class="Comment">{-
and check that this is correct
-}</a>

<a id="stackfunP2PKHemptyNonEmptyStackCorrect"></a><a id="5634" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5634" class="Function">stackfunP2PKHemptyNonEmptyStackCorrect</a> <a id="5673" class="Symbol">:</a> <a id="5675" class="Symbol">(</a><a id="5676" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5676" class="Bound">pubKeyHash</a> <a id="5687" class="Symbol">:</a> <a id="5689" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="5690" class="Symbol">)(</a><a id="5692" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5692" class="Bound">time₁</a> <a id="5698" class="Symbol">:</a> <a id="5700" href="basicBitcoinDataType.html#694" class="Function">Time</a><a id="5704" class="Symbol">)(</a><a id="5706" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5706" class="Bound">msg₁</a> <a id="5711" class="Symbol">:</a> <a id="5713" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="5716" class="Symbol">)(</a><a id="5718" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5718" class="Bound">pbk</a> <a id="5722" class="Symbol">:</a> <a id="5724" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="5725" class="Symbol">)(</a><a id="5727" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5727" class="Bound">stack₂</a> <a id="5734" class="Symbol">:</a> <a id="5736" href="stack.html#772" class="Function">Stack</a><a id="5741" class="Symbol">)</a>
        <a id="5751" class="Symbol">→</a> <a id="5753" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="5755" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="5768" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5676" class="Bound">pubKeyHash</a>  <a id="5780" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="5783" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5692" class="Bound">time₁</a> <a id="5789" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5706" class="Bound">msg₁</a> <a id="5794" class="Symbol">(</a><a id="5795" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5718" class="Bound">pbk</a> <a id="5799" class="InductiveConstructor Operator">∷</a> <a id="5801" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5727" class="Bound">stack₂</a><a id="5807" class="Symbol">)</a> <a id="5809" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5811" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5301" class="Function">stackfunP2PKHNonEmptyStack</a> <a id="5838" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5676" class="Bound">pubKeyHash</a> <a id="5849" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5706" class="Bound">msg₁</a>  <a id="5855" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5718" class="Bound">pbk</a> <a id="5859" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5727" class="Bound">stack₂</a>
<a id="5866" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5634" class="Function">stackfunP2PKHemptyNonEmptyStackCorrect</a> <a id="5905" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5905" class="Bound">pubKeyHash</a> <a id="5916" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5916" class="Bound">time₁</a> <a id="5922" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5922" class="Bound">msg₁</a> <a id="5927" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5927" class="Bound">pbk</a> <a id="5931" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#5931" class="Bound">stack₂</a> <a id="5938" class="Symbol">=</a> <a id="5940" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>



<a id="5948" class="Comment">{- We see now the case distinction depends on
   compres := compareNaturals pbkh (hashFun pbk)

since

executeStackVerify    (compres ∷  pbk ∷ stack₁)

will depend on whether compres is 0 or  suc x&#39;

so we abstract from

compres = compareNaturals pubKeyHash (hashFun pbk)

-}</a>

<a id="6225" class="Comment">-- This function will be repeated in stackVerificationP2PKHextractedProgram.agda</a>
<a id="6306" class="Comment">-- and therefore is kept private in this section in order to avoid a conflict</a>
<a id="6384" class="Keyword">private</a>
<a id="6392" class="Comment">--abstract</a>
  <a id="p2PKHNonEmptyStackAbstr"></a><a id="6405" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6405" class="Function">p2PKHNonEmptyStackAbstr</a> <a id="6429" class="Symbol">:</a> <a id="6431" class="Symbol">(</a><a id="6432" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6432" class="Bound">msg₁</a> <a id="6437" class="Symbol">:</a> <a id="6439" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="6442" class="Symbol">)(</a><a id="6444" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6444" class="Bound">pbk</a> <a id="6448" class="Symbol">:</a> <a id="6450" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="6451" class="Symbol">)(</a><a id="6453" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6453" class="Bound">stack₂</a> <a id="6460" class="Symbol">:</a> <a id="6462" href="stack.html#772" class="Function">Stack</a><a id="6467" class="Symbol">)(</a><a id="6469" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6469" class="Bound">cmp</a> <a id="6473" class="Symbol">:</a> <a id="6475" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="6476" class="Symbol">)</a>
                                <a id="6510" class="Symbol">→</a> <a id="6512" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="6518" href="stack.html#772" class="Function">Stack</a>
  <a id="6526" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6405" class="Function">p2PKHNonEmptyStackAbstr</a> <a id="6550" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6550" class="Bound">msg₁</a> <a id="6555" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6555" class="Bound">pbk</a> <a id="6559" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6559" class="Bound">stack₂</a> <a id="6566" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6566" class="Bound">cmp</a>
       <a id="6577" class="Symbol">=</a>  <a id="6580" href="semanticBasicOperations.html#1515" class="Function">executeStackVerify</a> <a id="6599" class="Symbol">(</a><a id="6600" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6566" class="Bound">cmp</a> <a id="6604" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a>  <a id="6607" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6555" class="Bound">pbk</a> <a id="6611" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6613" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6559" class="Bound">stack₂</a><a id="6619" class="Symbol">)</a> <a id="6621" href="Data.Maybe.Base.html#2227" class="Function Operator">&gt;&gt;=</a> <a id="6625" href="semanticBasicOperations.html#3305" class="Function">executeStackCheckSig</a> <a id="6646" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6550" class="Bound">msg₁</a>



<a id="6654" class="Comment">{- and we show that this is the right function
-}</a>

<a id="6705" class="Comment">-- This function will be repeated in stackVerificationP2PKHextractedProgram.agda</a>
<a id="6786" class="Comment">-- and therefore is kept private in this section in order to avoid a conflict</a>
<a id="6864" class="Keyword">private</a>
  <a id="stackfunP2PKHNonEmptyStackAbstractedCor"></a><a id="6874" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6874" class="Function">stackfunP2PKHNonEmptyStackAbstractedCor</a> <a id="6914" class="Symbol">:</a>  <a id="6917" class="Symbol">(</a><a id="6918" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6918" class="Bound">pubKeyHash</a> <a id="6929" class="Symbol">:</a> <a id="6931" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="6932" class="Symbol">)(</a><a id="6934" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6934" class="Bound">time₁</a> <a id="6940" class="Symbol">:</a> <a id="6942" href="basicBitcoinDataType.html#694" class="Function">Time</a><a id="6946" class="Symbol">)(</a><a id="6948" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6948" class="Bound">msg₁</a> <a id="6953" class="Symbol">:</a> <a id="6955" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="6958" class="Symbol">)(</a><a id="6960" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6960" class="Bound">pbk</a> <a id="6964" class="Symbol">:</a> <a id="6966" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="6967" class="Symbol">)(</a><a id="6969" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6969" class="Bound">stack₂</a> <a id="6976" class="Symbol">:</a> <a id="6978" href="stack.html#772" class="Function">Stack</a><a id="6983" class="Symbol">)</a>
                  <a id="7003" class="Symbol">→</a> <a id="7005" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="7007" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="7020" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6918" class="Bound">pubKeyHash</a> <a id="7031" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="7034" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6934" class="Bound">time₁</a> <a id="7040" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6948" class="Bound">msg₁</a> <a id="7045" class="Symbol">(</a><a id="7046" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6960" class="Bound">pbk</a> <a id="7050" class="InductiveConstructor Operator">∷</a> <a id="7052" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6969" class="Bound">stack₂</a><a id="7058" class="Symbol">)</a>
                     <a id="7081" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="7083" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6405" class="Function">p2PKHNonEmptyStackAbstr</a>  <a id="7108" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6948" class="Bound">msg₁</a> <a id="7113" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6960" class="Bound">pbk</a> <a id="7117" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6969" class="Bound">stack₂</a>
                             <a id="7153" class="Symbol">(</a><a id="7154" href="libraries.natLib.html#1060" class="Function">compareNaturals</a> <a id="7170" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6918" class="Bound">pubKeyHash</a> <a id="7181" class="Symbol">(</a><a id="7182" href="semanticBasicOperations.html#1123" class="Function">hashFun</a> <a id="7190" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6960" class="Bound">pbk</a><a id="7193" class="Symbol">))</a>
  <a id="7198" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6874" class="Function">stackfunP2PKHNonEmptyStackAbstractedCor</a> <a id="7238" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#7238" class="Bound">pubKeyHash</a> <a id="7249" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#7249" class="Bound">time₁</a> <a id="7255" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#7255" class="Bound">msg₁</a> <a id="7260" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#7260" class="Bound">pbk</a> <a id="7264" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#7264" class="Bound">stack₂</a> <a id="7271" class="Symbol">=</a> <a id="7273" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>


<a id="7280" class="Comment">{- Now we investigate what  p2PKHNonEmptyStackAbstr
When looking at it and see that

 p2PKHNonEmptyStackAbstr msg₁ pbk stack₂ cmp

will execute
executeStackVerify (cmp ∷  pbk ∷ stack₂)
which will in turn make a case disctintion on whether cmp is 0 or  not zero

(that corresponds to what the original function does because it makes this comparison
   compareNaturals pubKeyHash (hashFun pbk)
  which checks  whether the pbk provided  by the user hashes to the pubKeyHash of the locking script
    if it  is 0 it should fail, and if it is 1 it should succeed.

So lets make the test
-}</a>

<a id="testStackfunP2PKHNonEmptyStackAbstractedCompre0"></a><a id="7866" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#7866" class="Function">testStackfunP2PKHNonEmptyStackAbstractedCompre0</a> <a id="7914" class="Symbol">:</a> <a id="7916" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="7922" href="stack.html#772" class="Function">Stack</a>
<a id="7928" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#7866" class="Function">testStackfunP2PKHNonEmptyStackAbstractedCompre0</a> <a id="7976" class="Symbol">=</a> <a id="7978" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6405" class="Function">p2PKHNonEmptyStackAbstr</a> <a id="8002" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2115" class="Postulate">msg₁</a> <a id="8007" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2186" class="Postulate">pbk</a> <a id="8011" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2138" class="Postulate">stack₁</a> <a id="8018" class="Number">0</a>

<a id="8021" class="Comment">{- if we evaluate it we get

nothing


We  show now this is always the case

-}</a>

<a id="8102" class="Comment">-- This function will be repeated in stackVerificationP2PKHextractedProgram.agda</a>
<a id="8183" class="Comment">-- and therefore is kept private in this section in order to avoid a conflict</a>
<a id="8261" class="Keyword">private</a>
  <a id="stackfunP2PKHNonEmptyStackAbstractedCorCompr0IsNothing"></a><a id="8271" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#8271" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorCompr0IsNothing</a> <a id="8326" class="Symbol">:</a> <a id="8328" class="Symbol">(</a><a id="8329" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#8329" class="Bound">msg₁</a> <a id="8334" class="Symbol">:</a> <a id="8336" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="8339" class="Symbol">)(</a><a id="8341" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#8341" class="Bound">pbk</a> <a id="8345" class="Symbol">:</a> <a id="8347" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="8348" class="Symbol">)(</a><a id="8350" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#8350" class="Bound">stack₂</a> <a id="8357" class="Symbol">:</a> <a id="8359" href="stack.html#772" class="Function">Stack</a><a id="8364" class="Symbol">)</a>
        <a id="8374" class="Symbol">→</a>  <a id="8377" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6405" class="Function">p2PKHNonEmptyStackAbstr</a> <a id="8401" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#8329" class="Bound">msg₁</a> <a id="8406" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#8341" class="Bound">pbk</a> <a id="8410" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#8350" class="Bound">stack₂</a> <a id="8417" class="Number">0</a> <a id="8419" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="8421" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
  <a id="8431" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#8271" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorCompr0IsNothing</a> <a id="8486" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#8486" class="Bound">msg₁</a> <a id="8491" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#8491" class="Bound">pbk</a> <a id="8495" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#8495" class="Bound">stack₂</a> <a id="8502" class="Symbol">=</a> <a id="8504" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>


<a id="8511" class="Comment">{- Now we look at what happens  if the value is non zero -}</a>


<a id="testStackfunP2PKHNonEmptyStackAbstractedCompreSucCase"></a><a id="8573" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#8573" class="Function">testStackfunP2PKHNonEmptyStackAbstractedCompreSucCase</a> <a id="8627" class="Symbol">:</a> <a id="8629" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="8635" href="stack.html#772" class="Function">Stack</a>
<a id="8641" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#8573" class="Function">testStackfunP2PKHNonEmptyStackAbstractedCompreSucCase</a> <a id="8695" class="Symbol">=</a> <a id="8697" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6405" class="Function">p2PKHNonEmptyStackAbstr</a> <a id="8721" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2115" class="Postulate">msg₁</a> <a id="8726" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2186" class="Postulate">pbk</a> <a id="8730" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2138" class="Postulate">stack₁</a> <a id="8737" class="Symbol">(</a><a id="8738" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="8742" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2206" class="Postulate">x₁</a><a id="8744" class="Symbol">)</a>

<a id="8747" class="Comment">{- if we evalute
     testStackfunP2PKHNonEmptyStackAbstractedCompreSucCase
    we get

executeStackCheckSig msg₁ (pbk ∷ stack₁)


This corresponds to the situation where
the original stack₁ was non empty, and the comparision of the pbk with the pbkhash
got a result &gt; 0



If we look at
executeStackCheckSig

we see that it gives nothing when the stack has height &lt; 2
and otherwise does something,

so we can  make a case distinction on whether in

p2PKHNonEmptyStackAbstr msg₁ pbk stack₁ x

stack₁ is [] or nonempty

So lets look at the easy case []

    -}</a>


<a id="9309" class="Comment">--easy case</a>
<a id="testStackfunP2PKHNonEmptyStackAbstractedCompreSucEmpty"></a><a id="9321" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#9321" class="Function">testStackfunP2PKHNonEmptyStackAbstractedCompreSucEmpty</a> <a id="9376" class="Symbol">:</a> <a id="9378" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="9384" href="stack.html#772" class="Function">Stack</a>
<a id="9390" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#9321" class="Function">testStackfunP2PKHNonEmptyStackAbstractedCompreSucEmpty</a> <a id="9445" class="Symbol">=</a>
                           <a id="9474" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6405" class="Function">p2PKHNonEmptyStackAbstr</a> <a id="9498" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2115" class="Postulate">msg₁</a> <a id="9503" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2186" class="Postulate">pbk</a> <a id="9507" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="9510" class="Symbol">(</a><a id="9511" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="9515" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2206" class="Postulate">x₁</a><a id="9517" class="Symbol">)</a>


<a id="9521" class="Comment">{- if we evaluate it we get  result

nothing

we check that this always holds
-}</a>


<a id="stackfunP2PKHNonEmptyStackAbstractedCorComprSucStackEmpty"></a><a id="9604" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#9604" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorComprSucStackEmpty</a> <a id="9662" class="Symbol">:</a> <a id="9664" class="Symbol">(</a><a id="9665" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#9665" class="Bound">msg₁</a> <a id="9670" class="Symbol">:</a> <a id="9672" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="9675" class="Symbol">)(</a><a id="9677" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#9677" class="Bound">pbk</a> <a id="9681" class="Symbol">:</a> <a id="9683" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="9684" class="Symbol">)(</a><a id="9686" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#9686" class="Bound">x</a> <a id="9688" class="Symbol">:</a> <a id="9690" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="9691" class="Symbol">)</a>
             <a id="9706" class="Symbol">→</a> <a id="9708" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6405" class="Function">p2PKHNonEmptyStackAbstr</a> <a id="9732" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#9665" class="Bound">msg₁</a> <a id="9737" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#9677" class="Bound">pbk</a> <a id="9741" class="InductiveConstructor">[]</a> <a id="9744" class="Symbol">(</a><a id="9745" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="9749" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#9686" class="Bound">x</a><a id="9750" class="Symbol">)</a> <a id="9752" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="9754" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="9762" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#9604" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorComprSucStackEmpty</a> <a id="9820" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#9820" class="Bound">msg₁</a> <a id="9825" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#9825" class="Bound">pbk</a> <a id="9829" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#9829" class="Bound">x</a>  <a id="9832" class="Symbol">=</a> <a id="9834" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="9840" class="Comment">{-  Intermezzo: we can see that the fanction gives always nothing if the stack is empty
   independent of the result

But this result is not really needed (so can be probably be ommitted in the paper)
   -}</a>

<a id="10048" class="Comment">-- This function will be repeated in stackVerificationP2PKHextractedProgram.agda</a>
<a id="10129" class="Comment">-- and therefore is kept private in this section in order to avoid a conflict</a>
<a id="10207" class="Keyword">private</a>
  <a id="stackfunP2PKHNonEmptyStackAbstractedCorEmptysNothing"></a><a id="10217" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10217" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorEmptysNothing</a> <a id="10270" class="Symbol">:</a> <a id="10272" class="Symbol">(</a><a id="10273" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10273" class="Bound">msg₁</a> <a id="10278" class="Symbol">:</a> <a id="10280" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="10283" class="Symbol">)(</a><a id="10285" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10285" class="Bound">pbk</a> <a id="10289" class="Symbol">:</a> <a id="10291" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="10292" class="Symbol">)(</a><a id="10294" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10294" class="Bound">x</a> <a id="10296" class="Symbol">:</a> <a id="10298" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="10299" class="Symbol">)</a>
        <a id="10309" class="Symbol">→</a>  <a id="10312" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6405" class="Function">p2PKHNonEmptyStackAbstr</a> <a id="10336" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10273" class="Bound">msg₁</a> <a id="10341" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10285" class="Bound">pbk</a> <a id="10345" class="InductiveConstructor">[]</a> <a id="10348" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10294" class="Bound">x</a> <a id="10350" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="10352" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

  <a id="10363" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10217" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorEmptysNothing</a> <a id="10416" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10416" class="Bound">msg₁</a> <a id="10421" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10421" class="Bound">pbk₁</a> <a id="10426" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="10431" class="Symbol">=</a> <a id="10433" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="10440" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10217" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorEmptysNothing</a> <a id="10493" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10493" class="Bound">msg₁</a> <a id="10498" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10498" class="Bound">pbk₁</a> <a id="10503" class="Symbol">(</a><a id="10504" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="10508" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10508" class="Bound">x</a><a id="10509" class="Symbol">)</a> <a id="10511" class="Symbol">=</a> <a id="10513" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="10519" class="Comment">{- Now we look at what happens if we have non empty stack₁ and comparision &gt; 0
-}</a>

<a id="10602" class="Comment">{- if we evaluate it we get

just (boolToNat (isSigned  msg₁ sig₁ pbk) ∷ stack₁)



and we show that this is the case

-}</a>

<a id="10725" class="Comment">--stack nonempty</a>
<a id="testStackfunP2PKHNonEmptyStackAbstractedCompreSucNonEmpty"></a><a id="10742" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10742" class="Function">testStackfunP2PKHNonEmptyStackAbstractedCompreSucNonEmpty</a> <a id="10800" class="Symbol">:</a> <a id="10802" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="10808" href="stack.html#772" class="Function">Stack</a>
<a id="10814" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10742" class="Function">testStackfunP2PKHNonEmptyStackAbstractedCompreSucNonEmpty</a> <a id="10872" class="Symbol">=</a> <a id="10874" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6405" class="Function">p2PKHNonEmptyStackAbstr</a> <a id="10898" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2115" class="Postulate">msg₁</a> <a id="10903" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2186" class="Postulate">pbk</a> <a id="10907" class="Symbol">(</a><a id="10908" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2225" class="Postulate">sig₁</a>  <a id="10914" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10916" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2138" class="Postulate">stack₁</a><a id="10922" class="Symbol">)</a> <a id="10924" class="Symbol">(</a><a id="10925" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="10929" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#2206" class="Postulate">x₁</a><a id="10931" class="Symbol">)</a>



<a id="stackfunP2PKHNonEmptyStackAbstractedCorComprSucStackNonEmptyCor"></a><a id="10936" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10936" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorComprSucStackNonEmptyCor</a> <a id="11000" class="Symbol">:</a>
       <a id="11009" class="Symbol">(</a><a id="11010" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11010" class="Bound">msg₁</a> <a id="11015" class="Symbol">:</a> <a id="11017" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="11020" class="Symbol">)(</a><a id="11022" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11022" class="Bound">pbk</a> <a id="11026" class="Symbol">:</a> <a id="11028" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="11029" class="Symbol">)(</a><a id="11031" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11031" class="Bound">x</a> <a id="11033" class="Symbol">:</a> <a id="11035" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="11036" class="Symbol">)(</a><a id="11038" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11038" class="Bound">sig₁</a> <a id="11043" class="Symbol">:</a> <a id="11045" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="11046" class="Symbol">)(</a><a id="11048" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11048" class="Bound">stack₂</a> <a id="11055" class="Symbol">:</a> <a id="11057" href="stack.html#772" class="Function">Stack</a><a id="11062" class="Symbol">)</a>
       <a id="11071" class="Symbol">→</a> <a id="11073" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6405" class="Function">p2PKHNonEmptyStackAbstr</a> <a id="11097" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11010" class="Bound">msg₁</a> <a id="11102" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11022" class="Bound">pbk</a> <a id="11106" class="Symbol">(</a><a id="11107" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11038" class="Bound">sig₁</a>  <a id="11113" class="InductiveConstructor Operator">∷</a> <a id="11115" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11048" class="Bound">stack₂</a><a id="11121" class="Symbol">)</a> <a id="11123" class="Symbol">(</a><a id="11124" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="11128" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11031" class="Bound">x</a><a id="11129" class="Symbol">)</a>
          <a id="11141" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a>  <a id="11144" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="11149" class="Symbol">(</a><a id="11150" href="libraries.natLib.html#890" class="Function">boolToNat</a> <a id="11160" class="Symbol">(</a><a id="11161" href="semanticBasicOperations.html#3104" class="Function">isSigned</a>  <a id="11171" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11010" class="Bound">msg₁</a> <a id="11176" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11038" class="Bound">sig₁</a> <a id="11181" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11022" class="Bound">pbk</a><a id="11184" class="Symbol">)</a> <a id="11186" class="InductiveConstructor Operator">∷</a> <a id="11188" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11048" class="Bound">stack₂</a><a id="11194" class="Symbol">)</a>
<a id="11196" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10936" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorComprSucStackNonEmptyCor</a> <a id="11260" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11260" class="Bound">msg₂</a> <a id="11265" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11265" class="Bound">pbk₁</a> <a id="11270" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11270" class="Bound">sig₁</a> <a id="11275" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11275" class="Bound">x</a> <a id="11277" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11277" class="Bound">stack₃</a> <a id="11284" class="Symbol">=</a> <a id="11286" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="11292" class="Comment">{- the following can be ommitted probably
   since we have digged out the function completely
   but here is anyway a theorem that the original function gives you nothing
         if the stack has hight 1 only

-}</a>


<a id="11508" class="Comment">{- this function is obolete but an interesting observation -}</a>

<a id="stackfunP2PKHemptySingleStackIsNothing"></a><a id="11571" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11571" class="Function">stackfunP2PKHemptySingleStackIsNothing</a> <a id="11610" class="Symbol">:</a> <a id="11612" class="Symbol">(</a><a id="11613" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11613" class="Bound">pubKeyHash</a> <a id="11624" class="Symbol">:</a> <a id="11626" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="11627" class="Symbol">)(</a><a id="11629" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11629" class="Bound">time₁</a> <a id="11635" class="Symbol">:</a> <a id="11637" href="basicBitcoinDataType.html#694" class="Function">Time</a><a id="11641" class="Symbol">)(</a><a id="11643" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11643" class="Bound">msg₁</a> <a id="11648" class="Symbol">:</a> <a id="11650" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a><a id="11653" class="Symbol">)(</a><a id="11655" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11655" class="Bound">pbk</a> <a id="11659" class="Symbol">:</a> <a id="11661" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="11662" class="Symbol">)</a>
        <a id="11672" class="Symbol">→</a> <a id="11674" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="11676" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="11689" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11613" class="Bound">pubKeyHash</a> <a id="11700" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="11703" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11629" class="Bound">time₁</a> <a id="11709" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11643" class="Bound">msg₁</a> <a id="11714" class="Symbol">(</a><a id="11715" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11655" class="Bound">pbk</a> <a id="11719" class="InductiveConstructor Operator">∷</a> <a id="11721" class="InductiveConstructor">[]</a><a id="11723" class="Symbol">)</a> <a id="11725" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="11727" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="11735" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11571" class="Function">stackfunP2PKHemptySingleStackIsNothing</a>  <a id="11775" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11775" class="Bound">pubKeyHash</a> <a id="11786" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11786" class="Bound">time₁</a> <a id="11792" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11792" class="Bound">msg₁</a> <a id="11797" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11797" class="Bound">pbk</a>
  <a id="11803" class="Symbol">=</a>  <a id="11806" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟦</a> <a id="11808" href="verificationStackScripts.stackVerificationP2PKH.html#5626" class="Function">scriptP2PKHᵇ</a> <a id="11821" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11775" class="Bound">pubKeyHash</a> <a id="11832" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#2252" class="Function Operator">⟧ˢ</a> <a id="11835" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11786" class="Bound">time₁</a> <a id="11841" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11792" class="Bound">msg₁</a> <a id="11846" class="Symbol">(</a><a id="11847" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11797" class="Bound">pbk</a> <a id="11851" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="11853" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="11855" class="Symbol">)</a>
               <a id="11872" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="11875" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6874" class="Function">stackfunP2PKHNonEmptyStackAbstractedCor</a> <a id="11915" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11775" class="Bound">pubKeyHash</a> <a id="11926" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11786" class="Bound">time₁</a> <a id="11932" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11792" class="Bound">msg₁</a> <a id="11937" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11797" class="Bound">pbk</a> <a id="11941" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>   <a id="11946" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
     <a id="11953" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#6405" class="Function">p2PKHNonEmptyStackAbstr</a>  <a id="11978" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11792" class="Bound">msg₁</a> <a id="11983" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11797" class="Bound">pbk</a> <a id="11987" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="11990" class="Symbol">(</a><a id="11991" href="libraries.natLib.html#1060" class="Function">compareNaturals</a> <a id="12007" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11775" class="Bound">pubKeyHash</a> <a id="12018" class="Symbol">(</a><a id="12019" href="semanticBasicOperations.html#1123" class="Function">hashFun</a> <a id="12027" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11797" class="Bound">pbk</a><a id="12030" class="Symbol">))</a>
               <a id="12048" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="12051" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#10217" class="Function">stackfunP2PKHNonEmptyStackAbstractedCorEmptysNothing</a> <a id="12104" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11792" class="Bound">msg₁</a> <a id="12109" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11797" class="Bound">pbk</a> <a id="12113" class="Symbol">(</a><a id="12114" href="libraries.natLib.html#1060" class="Function">compareNaturals</a> <a id="12130" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11775" class="Bound">pubKeyHash</a> <a id="12141" class="Symbol">(</a><a id="12142" href="semanticBasicOperations.html#1123" class="Function">hashFun</a> <a id="12150" href="verificationStackScripts.stackVerificationP2PKHsymbolicExecution.html#11797" class="Bound">pbk</a><a id="12153" class="Symbol">))</a>   <a id="12158" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
     <a id="12165" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
     <a id="12178" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>
</pre></body></html>