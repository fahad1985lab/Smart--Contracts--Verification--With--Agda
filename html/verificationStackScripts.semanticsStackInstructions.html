<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>verificationStackScripts.semanticsStackInstructions</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="basicBitcoinDataType.html" class="Module">basicBitcoinDataType</a>

<a id="35" class="Keyword">module</a> <a id="42" href="verificationStackScripts.semanticsStackInstructions.html" class="Module">verificationStackScripts.semanticsStackInstructions</a> <a id="94" class="Symbol">(</a><a id="95" href="verificationStackScripts.semanticsStackInstructions.html#95" class="Bound">param</a> <a id="101" class="Symbol">:</a> <a id="103" href="basicBitcoinDataType.html#1169" class="Record">GlobalParameters</a><a id="119" class="Symbol">)</a> <a id="121" class="Keyword">where</a>



<a id="130" class="Keyword">open</a> <a id="135" class="Keyword">import</a> <a id="142" href="Data.Nat.html" class="Module">Data.Nat</a>  <a id="152" class="Keyword">hiding</a> <a id="159" class="Symbol">(</a><a id="160" href="Data.Nat.Base.html#1535" class="Datatype Operator">_≤_</a><a id="163" class="Symbol">)</a>
<a id="165" class="Keyword">open</a> <a id="170" class="Keyword">import</a> <a id="177" href="Data.List.html" class="Module">Data.List</a> <a id="187" class="Keyword">hiding</a> <a id="194" class="Symbol">(</a><a id="195" href="Data.List.Base.html#1810" class="Function Operator">_++_</a><a id="199" class="Symbol">)</a>
<a id="201" class="Keyword">open</a> <a id="206" class="Keyword">import</a> <a id="213" href="Data.Unit.html" class="Module">Data.Unit</a>  <a id="224" class="Keyword">hiding</a> <a id="231" class="Symbol">(</a><a id="232" href="Data.Unit.Base.html#1023" class="Record Operator">_≤_</a><a id="235" class="Symbol">)</a>
<a id="237" class="Keyword">open</a> <a id="242" class="Keyword">import</a> <a id="249" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="260" class="Keyword">open</a> <a id="265" class="Keyword">import</a> <a id="272" href="Data.Bool.html" class="Module">Data.Bool</a>  <a id="283" class="Keyword">hiding</a> <a id="290" class="Symbol">(</a><a id="291" href="Data.Bool.Base.html#672" class="Datatype Operator">_≤_</a> <a id="295" class="Symbol">;</a> <a id="297" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a> <a id="311" class="Symbol">)</a> <a id="313" class="Keyword">renaming</a> <a id="322" class="Symbol">(</a><a id="323" href="Data.Bool.Base.html#986" class="Function Operator">_∧_</a> <a id="327" class="Symbol">to</a> <a id="330" class="Function Operator">_∧b_</a> <a id="335" class="Symbol">;</a> <a id="337" href="Data.Bool.Base.html#1044" class="Function Operator">_∨_</a> <a id="341" class="Symbol">to</a> <a id="344" class="Function Operator">_∨b_</a> <a id="349" class="Symbol">;</a> <a id="351" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="353" class="Symbol">to</a> <a id="356" class="Function">True</a><a id="360" class="Symbol">)</a>
<a id="362" class="Keyword">open</a> <a id="367" class="Keyword">import</a> <a id="374" href="Data.Product.html" class="Module">Data.Product</a> <a id="387" class="Keyword">renaming</a> <a id="396" class="Symbol">(</a><a id="397" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="401" class="Symbol">to</a> <a id="404" class="InductiveConstructor Operator">_,,_</a> <a id="409" class="Symbol">)</a>
<a id="411" class="Keyword">open</a> <a id="416" class="Keyword">import</a> <a id="423" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="437" class="Keyword">hiding</a> <a id="444" class="Symbol">(</a><a id="445" href="Data.Nat.Base.html#1535" class="Datatype Operator">_≤_</a><a id="448" class="Symbol">)</a>
<a id="450" class="Keyword">open</a> <a id="455" class="Keyword">import</a> <a id="462" href="Data.Maybe.html" class="Module">Data.Maybe</a>
<a id="473" class="Keyword">import</a> <a id="480" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="518" class="Symbol">as</a> <a id="521" class="Module">Eq</a>
<a id="524" class="Keyword">open</a> <a id="529" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="532" class="Keyword">using</a> <a id="538" class="Symbol">(</a><a id="539" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="542" class="Symbol">;</a> <a id="544" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="548" class="Symbol">;</a> <a id="550" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a><a id="554" class="Symbol">;</a> <a id="556" class="Keyword">module</a> <a id="563" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a><a id="574" class="Symbol">;</a> <a id="576" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a><a id="579" class="Symbol">)</a>
<a id="581" class="Keyword">open</a> <a id="586" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>
<a id="598" class="Keyword">open</a> <a id="603" class="Keyword">import</a> <a id="610" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>


<a id="634" class="Comment">--our libraries</a>
<a id="650" class="Keyword">open</a> <a id="655" class="Keyword">import</a> <a id="662" href="libraries.listLib.html" class="Module">libraries.listLib</a>
<a id="680" class="Keyword">open</a> <a id="685" class="Keyword">import</a> <a id="692" href="libraries.natLib.html" class="Module">libraries.natLib</a>
<a id="709" class="Keyword">open</a> <a id="714" class="Keyword">import</a> <a id="721" href="libraries.boolLib.html" class="Module">libraries.boolLib</a>
<a id="739" class="Keyword">open</a> <a id="744" class="Keyword">import</a> <a id="751" href="libraries.andLib.html" class="Module">libraries.andLib</a>
<a id="768" class="Keyword">open</a> <a id="773" class="Keyword">import</a> <a id="780" href="libraries.maybeLib.html" class="Module">libraries.maybeLib</a>

<a id="800" class="Keyword">open</a> <a id="805" class="Keyword">import</a> <a id="812" href="stack.html" class="Module">stack</a>
<a id="818" class="Keyword">open</a> <a id="823" class="Keyword">import</a> <a id="830" href="semanticBasicOperations.html" class="Module">semanticBasicOperations</a> <a id="854" href="verificationStackScripts.semanticsStackInstructions.html#95" class="Bound">param</a>
<a id="860" class="Keyword">open</a> <a id="865" class="Keyword">import</a> <a id="872" href="instructionBasic.html" class="Module">instructionBasic</a>
<a id="889" class="Keyword">open</a> <a id="894" class="Keyword">import</a> <a id="901" href="verificationStackScripts.stackState.html" class="Module">verificationStackScripts.stackState</a>
<a id="937" class="Keyword">open</a> <a id="942" class="Keyword">import</a> <a id="949" href="verificationStackScripts.sPredicate.html" class="Module">verificationStackScripts.sPredicate</a>
<a id="985" class="Keyword">open</a> <a id="990" class="Keyword">import</a> <a id="997" href="verificationStackScripts.stackSemanticsInstructionsBasic.html" class="Module">verificationStackScripts.stackSemanticsInstructionsBasic</a> <a id="1054" href="verificationStackScripts.semanticsStackInstructions.html#95" class="Bound">param</a>



<a id="⟦_⟧ₛ"></a><a id="1063" href="verificationStackScripts.semanticsStackInstructions.html#1063" class="Function Operator">⟦_⟧ₛ</a> <a id="1068" class="Symbol">:</a> <a id="1070" href="instructionBasic.html#745" class="Datatype">InstructionBasic</a> <a id="1087" class="Symbol">→</a> <a id="1089" href="verificationStackScripts.stackState.html#931" class="Record">StackState</a> <a id="1100" class="Symbol">→</a> <a id="1102" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1108" href="verificationStackScripts.stackState.html#931" class="Record">StackState</a>
<a id="1119" href="verificationStackScripts.semanticsStackInstructions.html#1063" class="Function Operator">⟦</a> <a id="1121" href="verificationStackScripts.semanticsStackInstructions.html#1121" class="Bound">op</a> <a id="1124" href="verificationStackScripts.semanticsStackInstructions.html#1063" class="Function Operator">⟧ₛ</a>   <a id="1129" class="Symbol">=</a> <a id="1131" href="verificationStackScripts.stackState.html#3075" class="Function">liftStackFun2StackState</a> <a id="1155" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#994" class="Function Operator">⟦</a> <a id="1157" href="verificationStackScripts.semanticsStackInstructions.html#1121" class="Bound">op</a> <a id="1160" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#994" class="Function Operator">⟧ₛˢ</a>



<a id="⟦_⟧ₛ⁺"></a><a id="1167" href="verificationStackScripts.semanticsStackInstructions.html#1167" class="Function Operator">⟦_⟧ₛ⁺</a> <a id="1173" class="Symbol">:</a> <a id="1175" href="instructionBasic.html#745" class="Datatype">InstructionBasic</a> <a id="1192" class="Symbol">→</a> <a id="1194" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1200" href="verificationStackScripts.stackState.html#931" class="Record">StackState</a> <a id="1211" class="Symbol">→</a> <a id="1213" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1219" href="verificationStackScripts.stackState.html#931" class="Record">StackState</a>
<a id="1230" href="verificationStackScripts.semanticsStackInstructions.html#1167" class="Function Operator">⟦</a> <a id="1232" href="verificationStackScripts.semanticsStackInstructions.html#1232" class="Bound">op</a> <a id="1235" href="verificationStackScripts.semanticsStackInstructions.html#1167" class="Function Operator">⟧ₛ⁺</a> <a id="1239" href="verificationStackScripts.semanticsStackInstructions.html#1239" class="Bound">t</a> <a id="1241" class="Symbol">=</a> <a id="1243" href="verificationStackScripts.semanticsStackInstructions.html#1239" class="Bound">t</a> <a id="1245" href="Data.Maybe.Base.html#2227" class="Function Operator">&gt;&gt;=</a> <a id="1249" href="verificationStackScripts.semanticsStackInstructions.html#1063" class="Function Operator">⟦</a> <a id="1251" href="verificationStackScripts.semanticsStackInstructions.html#1232" class="Bound">op</a> <a id="1254" href="verificationStackScripts.semanticsStackInstructions.html#1063" class="Function Operator">⟧ₛ</a>



<a id="⟦_⟧"></a><a id="1260" href="verificationStackScripts.semanticsStackInstructions.html#1260" class="Function Operator">⟦_⟧</a> <a id="1264" class="Symbol">:</a> <a id="1266" href="instructionBasic.html#1042" class="Function">BitcoinScriptBasic</a> <a id="1285" class="Symbol">→</a> <a id="1287" href="verificationStackScripts.stackState.html#931" class="Record">StackState</a> <a id="1298" class="Symbol">→</a> <a id="1300" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1306" href="verificationStackScripts.stackState.html#931" class="Record">StackState</a>
<a id="1317" href="verificationStackScripts.semanticsStackInstructions.html#1260" class="Function Operator">⟦</a> <a id="1319" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>  <a id="1323" href="verificationStackScripts.semanticsStackInstructions.html#1260" class="Function Operator">⟧</a>  <a id="1326" class="Symbol">=</a> <a id="1328" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a>
<a id="1333" href="verificationStackScripts.semanticsStackInstructions.html#1260" class="Function Operator">⟦</a> <a id="1335" href="verificationStackScripts.semanticsStackInstructions.html#1335" class="Bound">op</a> <a id="1338" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1340" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>  <a id="1344" href="verificationStackScripts.semanticsStackInstructions.html#1260" class="Function Operator">⟧</a>  <a id="1347" class="Symbol">=</a> <a id="1349" href="verificationStackScripts.semanticsStackInstructions.html#1063" class="Function Operator">⟦</a> <a id="1351" href="verificationStackScripts.semanticsStackInstructions.html#1335" class="Bound">op</a> <a id="1354" href="verificationStackScripts.semanticsStackInstructions.html#1063" class="Function Operator">⟧ₛ</a>
<a id="1357" href="verificationStackScripts.semanticsStackInstructions.html#1260" class="CatchallClause Function Operator">⟦</a><a id="1358" class="CatchallClause"> </a><a id="1359" href="verificationStackScripts.semanticsStackInstructions.html#1359" class="CatchallClause Bound">op</a><a id="1361" class="CatchallClause"> </a><a id="1362" href="Agda.Builtin.List.html#200" class="CatchallClause InductiveConstructor Operator">∷</a><a id="1363" class="CatchallClause"> </a><a id="1364" href="verificationStackScripts.semanticsStackInstructions.html#1364" class="CatchallClause Bound">p</a><a id="1365" class="CatchallClause">   </a><a id="1368" href="verificationStackScripts.semanticsStackInstructions.html#1260" class="CatchallClause Function Operator">⟧</a><a id="1369" class="CatchallClause">  </a><a id="1371" href="verificationStackScripts.semanticsStackInstructions.html#1371" class="CatchallClause Bound">s</a> <a id="1373" class="Symbol">=</a> <a id="1375" href="verificationStackScripts.semanticsStackInstructions.html#1063" class="Function Operator">⟦</a> <a id="1377" href="verificationStackScripts.semanticsStackInstructions.html#1359" class="Bound">op</a> <a id="1380" href="verificationStackScripts.semanticsStackInstructions.html#1063" class="Function Operator">⟧ₛ</a> <a id="1383" href="verificationStackScripts.semanticsStackInstructions.html#1371" class="Bound">s</a> <a id="1385" href="Data.Maybe.Base.html#2227" class="Function Operator">&gt;&gt;=</a>  <a id="1390" href="verificationStackScripts.semanticsStackInstructions.html#1260" class="Function Operator">⟦</a> <a id="1392" href="verificationStackScripts.semanticsStackInstructions.html#1364" class="Bound">p</a> <a id="1394" href="verificationStackScripts.semanticsStackInstructions.html#1260" class="Function Operator">⟧</a>

<a id="⟦_⟧⁺"></a><a id="1397" href="verificationStackScripts.semanticsStackInstructions.html#1397" class="Function Operator">⟦_⟧⁺</a> <a id="1402" class="Symbol">:</a> <a id="1404" href="instructionBasic.html#1042" class="Function">BitcoinScriptBasic</a> <a id="1423" class="Symbol">→</a> <a id="1425" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1431" href="verificationStackScripts.stackState.html#931" class="Record">StackState</a> <a id="1442" class="Symbol">→</a> <a id="1444" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1450" href="verificationStackScripts.stackState.html#931" class="Record">StackState</a>
<a id="1461" href="verificationStackScripts.semanticsStackInstructions.html#1397" class="Function Operator">⟦</a> <a id="1463" href="verificationStackScripts.semanticsStackInstructions.html#1463" class="Bound">p</a> <a id="1465" href="verificationStackScripts.semanticsStackInstructions.html#1397" class="Function Operator">⟧⁺</a> <a id="1468" href="verificationStackScripts.semanticsStackInstructions.html#1468" class="Bound">s</a> <a id="1470" class="Symbol">=</a> <a id="1472" href="verificationStackScripts.semanticsStackInstructions.html#1468" class="Bound">s</a> <a id="1474" href="Data.Maybe.Base.html#2227" class="Function Operator">&gt;&gt;=</a> <a id="1478" href="verificationStackScripts.semanticsStackInstructions.html#1260" class="Function Operator">⟦</a> <a id="1480" href="verificationStackScripts.semanticsStackInstructions.html#1463" class="Bound">p</a> <a id="1482" href="verificationStackScripts.semanticsStackInstructions.html#1260" class="Function Operator">⟧</a>


<a id="validStackAux"></a><a id="1486" href="verificationStackScripts.semanticsStackInstructions.html#1486" class="Function">validStackAux</a> <a id="1500" class="Symbol">:</a> <a id="1502" class="Symbol">(</a><a id="1503" href="verificationStackScripts.semanticsStackInstructions.html#1503" class="Bound">pbkh</a> <a id="1508" class="Symbol">:</a> <a id="1510" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1511" class="Symbol">)</a> <a id="1513" class="Symbol">→</a>  <a id="1516" class="Symbol">(</a><a id="1517" href="verificationStackScripts.semanticsStackInstructions.html#1517" class="Bound">msg</a> <a id="1521" class="Symbol">:</a> <a id="1523" href="basicBitcoinDataType.html#854" class="Datatype">Msg</a><a id="1526" class="Symbol">)</a> <a id="1528" class="Symbol">→</a>  <a id="1531" href="stack.html#702" class="Function">Stack</a> <a id="1537" class="Symbol">→</a>  <a id="1540" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1545" href="verificationStackScripts.semanticsStackInstructions.html#1486" class="Function">validStackAux</a> <a id="1559" href="verificationStackScripts.semanticsStackInstructions.html#1559" class="Bound">pkh</a> <a id="1563" href="verificationStackScripts.semanticsStackInstructions.html#1563" class="Bound">msg[]</a>  <a id="1570" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>  <a id="1574" class="Symbol">=</a> <a id="1576" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="1582" href="verificationStackScripts.semanticsStackInstructions.html#1486" class="Function">validStackAux</a> <a id="1596" href="verificationStackScripts.semanticsStackInstructions.html#1596" class="Bound">pkh</a> <a id="1600" href="verificationStackScripts.semanticsStackInstructions.html#1600" class="Bound">msg</a> <a id="1604" class="Symbol">(</a><a id="1605" href="verificationStackScripts.semanticsStackInstructions.html#1605" class="Bound">pbk</a> <a id="1609" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1611" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1613" class="Symbol">)</a> <a id="1615" class="Symbol">=</a> <a id="1617" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="1623" href="verificationStackScripts.semanticsStackInstructions.html#1486" class="Function">validStackAux</a> <a id="1637" href="verificationStackScripts.semanticsStackInstructions.html#1637" class="Bound">pkh</a> <a id="1641" href="verificationStackScripts.semanticsStackInstructions.html#1641" class="Bound">msg</a> <a id="1645" class="Symbol">(</a><a id="1646" href="verificationStackScripts.semanticsStackInstructions.html#1646" class="Bound">pbk</a> <a id="1650" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1652" href="verificationStackScripts.semanticsStackInstructions.html#1652" class="Bound">sig</a> <a id="1656" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1658" href="verificationStackScripts.semanticsStackInstructions.html#1658" class="Bound">s</a><a id="1659" class="Symbol">)</a> <a id="1661" class="Symbol">=</a> <a id="1663" href="semanticBasicOperations.html#778" class="Function">hashFun</a> <a id="1671" href="verificationStackScripts.semanticsStackInstructions.html#1646" class="Bound">pbk</a>  <a id="1676" href="libraries.natLib.html#736" class="Function Operator">==b</a> <a id="1680" href="verificationStackScripts.semanticsStackInstructions.html#1637" class="Bound">pkh</a> <a id="1684" href="verificationStackScripts.semanticsStackInstructions.html#330" class="Function Operator">∧b</a> <a id="1687" href="semanticBasicOperations.html#2918" class="Function">isSigned</a>  <a id="1697" href="verificationStackScripts.semanticsStackInstructions.html#1641" class="Bound">msg</a> <a id="1701" href="verificationStackScripts.semanticsStackInstructions.html#1652" class="Bound">sig</a> <a id="1705" href="verificationStackScripts.semanticsStackInstructions.html#1646" class="Bound">pbk</a>

<a id="validStack"></a><a id="1710" href="verificationStackScripts.semanticsStackInstructions.html#1710" class="Function">validStack</a> <a id="1721" class="Symbol">:</a> <a id="1723" class="Symbol">(</a><a id="1724" href="verificationStackScripts.semanticsStackInstructions.html#1724" class="Bound">pkh</a> <a id="1728" class="Symbol">:</a> <a id="1730" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1731" class="Symbol">)</a> <a id="1733" class="Symbol">→</a>  <a id="1736" href="verificationStackScripts.sPredicate.html#1026" class="Function">BStackStatePred</a>
<a id="1752" href="verificationStackScripts.semanticsStackInstructions.html#1710" class="Function">validStack</a> <a id="1763" href="verificationStackScripts.semanticsStackInstructions.html#1763" class="Bound">pkh</a> <a id="1767" href="verificationStackScripts.stackState.html#975" class="InductiveConstructor Operator">⟨</a> <a id="1769" href="verificationStackScripts.semanticsStackInstructions.html#1769" class="Bound">time</a> <a id="1774" href="verificationStackScripts.stackState.html#975" class="InductiveConstructor Operator">,</a> <a id="1776" href="verificationStackScripts.semanticsStackInstructions.html#1776" class="Bound">msg₁</a> <a id="1781" href="verificationStackScripts.stackState.html#975" class="InductiveConstructor Operator">,</a> <a id="1783" href="verificationStackScripts.semanticsStackInstructions.html#1783" class="Bound">stack₁</a> <a id="1790" href="verificationStackScripts.stackState.html#975" class="InductiveConstructor Operator">⟩</a> <a id="1792" class="Symbol">=</a> <a id="1794" href="verificationStackScripts.semanticsStackInstructions.html#1486" class="Function">validStackAux</a>  <a id="1809" href="verificationStackScripts.semanticsStackInstructions.html#1763" class="Bound">pkh</a>   <a id="1815" href="verificationStackScripts.semanticsStackInstructions.html#1776" class="Bound">msg₁</a>  <a id="1821" href="verificationStackScripts.semanticsStackInstructions.html#1783" class="Bound">stack₁</a>
</pre></body></html>