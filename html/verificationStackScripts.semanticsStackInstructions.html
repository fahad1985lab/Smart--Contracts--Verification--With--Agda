<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>verificationStackScripts.semanticsStackInstructions</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="basicBitcoinDataType.html" class="Module">basicBitcoinDataType</a>

<a id="35" class="Keyword">module</a> <a id="42" href="verificationStackScripts.semanticsStackInstructions.html" class="Module">verificationStackScripts.semanticsStackInstructions</a> <a id="94" class="Symbol">(</a><a id="95" href="verificationStackScripts.semanticsStackInstructions.html#95" class="Bound">param</a> <a id="101" class="Symbol">:</a> <a id="103" href="basicBitcoinDataType.html#1157" class="Record">GlobalParameters</a><a id="119" class="Symbol">)</a> <a id="121" class="Keyword">where</a>



<a id="130" class="Keyword">open</a> <a id="135" class="Keyword">import</a> <a id="142" href="Data.Nat.html" class="Module">Data.Nat</a>  <a id="152" class="Keyword">hiding</a> <a id="159" class="Symbol">(</a><a id="160" href="Data.Nat.Base.html#1691" class="Datatype Operator">_≤_</a><a id="163" class="Symbol">)</a>
<a id="165" class="Keyword">open</a> <a id="170" class="Keyword">import</a> <a id="177" href="Data.List.html" class="Module">Data.List</a> <a id="187" class="Keyword">hiding</a> <a id="194" class="Symbol">(</a><a id="195" href="Data.List.Base.html#1954" class="Function Operator">_++_</a><a id="199" class="Symbol">)</a>
<a id="201" class="Keyword">open</a> <a id="206" class="Keyword">import</a> <a id="213" href="Data.Unit.html" class="Module">Data.Unit</a>  
<a id="225" class="Keyword">open</a> <a id="230" class="Keyword">import</a> <a id="237" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="248" class="Keyword">open</a> <a id="253" class="Keyword">import</a> <a id="260" href="Data.Bool.html" class="Module">Data.Bool</a>  <a id="271" class="Keyword">hiding</a> <a id="278" class="Symbol">(</a><a id="279" href="Data.Bool.Base.html#681" class="Datatype Operator">_≤_</a> <a id="283" class="Symbol">;</a> <a id="285" href="Data.Bool.Base.html#1505" class="Function Operator">if_then_else_</a> <a id="299" class="Symbol">)</a> <a id="301" class="Keyword">renaming</a> <a id="310" class="Symbol">(</a><a id="311" href="Data.Bool.Base.html#995" class="Function Operator">_∧_</a> <a id="315" class="Symbol">to</a> <a id="318" class="Function Operator">_∧b_</a> <a id="323" class="Symbol">;</a> <a id="325" href="Data.Bool.Base.html#1053" class="Function Operator">_∨_</a> <a id="329" class="Symbol">to</a> <a id="332" class="Function Operator">_∨b_</a> <a id="337" class="Symbol">;</a> <a id="339" href="Data.Bool.Base.html#1348" class="Function">T</a> <a id="341" class="Symbol">to</a> <a id="344" class="Function">True</a><a id="348" class="Symbol">)</a>
<a id="350" class="Keyword">open</a> <a id="355" class="Keyword">import</a> <a id="362" href="Data.Product.html" class="Module">Data.Product</a> <a id="375" class="Keyword">renaming</a> <a id="384" class="Symbol">(</a><a id="385" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="389" class="Symbol">to</a> <a id="392" class="InductiveConstructor Operator">_,,_</a> <a id="397" class="Symbol">)</a>
<a id="399" class="Keyword">open</a> <a id="404" class="Keyword">import</a> <a id="411" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="425" class="Keyword">hiding</a> <a id="432" class="Symbol">(</a><a id="433" href="Data.Nat.Base.html#1691" class="Datatype Operator">_≤_</a><a id="436" class="Symbol">)</a>
<a id="438" class="Keyword">open</a> <a id="443" class="Keyword">import</a> <a id="450" href="Data.Maybe.html" class="Module">Data.Maybe</a>
<a id="461" class="Keyword">import</a> <a id="468" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="506" class="Symbol">as</a> <a id="509" class="Module">Eq</a>
<a id="512" class="Keyword">open</a> <a id="517" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="520" class="Keyword">using</a> <a id="526" class="Symbol">(</a><a id="527" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="530" class="Symbol">;</a> <a id="532" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="536" class="Symbol">;</a> <a id="538" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a><a id="542" class="Symbol">;</a> <a id="544" class="Keyword">module</a> <a id="551" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a><a id="562" class="Symbol">;</a> <a id="564" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">sym</a><a id="567" class="Symbol">)</a>
<a id="569" class="Keyword">open</a> <a id="574" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a>
<a id="586" class="Keyword">open</a> <a id="591" class="Keyword">import</a> <a id="598" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>


<a id="622" class="Comment">--our libraries</a>
<a id="638" class="Keyword">open</a> <a id="643" class="Keyword">import</a> <a id="650" href="libraries.listLib.html" class="Module">libraries.listLib</a>
<a id="668" class="Keyword">open</a> <a id="673" class="Keyword">import</a> <a id="680" href="libraries.natLib.html" class="Module">libraries.natLib</a>
<a id="697" class="Keyword">open</a> <a id="702" class="Keyword">import</a> <a id="709" href="libraries.boolLib.html" class="Module">libraries.boolLib</a>
<a id="727" class="Keyword">open</a> <a id="732" class="Keyword">import</a> <a id="739" href="libraries.andLib.html" class="Module">libraries.andLib</a>
<a id="756" class="Keyword">open</a> <a id="761" class="Keyword">import</a> <a id="768" href="libraries.maybeLib.html" class="Module">libraries.maybeLib</a>

<a id="788" class="Keyword">open</a> <a id="793" class="Keyword">import</a> <a id="800" href="stack.html" class="Module">stack</a>
<a id="806" class="Keyword">open</a> <a id="811" class="Keyword">import</a> <a id="818" href="semanticBasicOperations.html" class="Module">semanticBasicOperations</a> <a id="842" href="verificationStackScripts.semanticsStackInstructions.html#95" class="Bound">param</a>
<a id="848" class="Keyword">open</a> <a id="853" class="Keyword">import</a> <a id="860" href="instructionBasic.html" class="Module">instructionBasic</a>
<a id="877" class="Keyword">open</a> <a id="882" class="Keyword">import</a> <a id="889" href="verificationStackScripts.stackState.html" class="Module">verificationStackScripts.stackState</a>
<a id="925" class="Keyword">open</a> <a id="930" class="Keyword">import</a> <a id="937" href="verificationStackScripts.sPredicate.html" class="Module">verificationStackScripts.sPredicate</a>
<a id="973" class="Keyword">open</a> <a id="978" class="Keyword">import</a> <a id="985" href="verificationStackScripts.stackSemanticsInstructionsBasic.html" class="Module">verificationStackScripts.stackSemanticsInstructionsBasic</a> <a id="1042" href="verificationStackScripts.semanticsStackInstructions.html#95" class="Bound">param</a>



<a id="⟦_⟧ₛ"></a><a id="1051" href="verificationStackScripts.semanticsStackInstructions.html#1051" class="Function Operator">⟦_⟧ₛ</a> <a id="1056" class="Symbol">:</a> <a id="1058" href="instructionBasic.html#733" class="Datatype">InstructionBasic</a> <a id="1075" class="Symbol">→</a> <a id="1077" href="verificationStackScripts.stackState.html#919" class="Record">StackState</a> <a id="1088" class="Symbol">→</a> <a id="1090" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1096" href="verificationStackScripts.stackState.html#919" class="Record">StackState</a>
<a id="1107" href="verificationStackScripts.semanticsStackInstructions.html#1051" class="Function Operator">⟦</a> <a id="1109" href="verificationStackScripts.semanticsStackInstructions.html#1109" class="Bound">op</a> <a id="1112" href="verificationStackScripts.semanticsStackInstructions.html#1051" class="Function Operator">⟧ₛ</a>   <a id="1117" class="Symbol">=</a> <a id="1119" href="verificationStackScripts.stackState.html#3063" class="Function">liftStackFun2StackState</a> <a id="1143" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#982" class="Function Operator">⟦</a> <a id="1145" href="verificationStackScripts.semanticsStackInstructions.html#1109" class="Bound">op</a> <a id="1148" href="verificationStackScripts.stackSemanticsInstructionsBasic.html#982" class="Function Operator">⟧ₛˢ</a>



<a id="⟦_⟧ₛ⁺"></a><a id="1155" href="verificationStackScripts.semanticsStackInstructions.html#1155" class="Function Operator">⟦_⟧ₛ⁺</a> <a id="1161" class="Symbol">:</a> <a id="1163" href="instructionBasic.html#733" class="Datatype">InstructionBasic</a> <a id="1180" class="Symbol">→</a> <a id="1182" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1188" href="verificationStackScripts.stackState.html#919" class="Record">StackState</a> <a id="1199" class="Symbol">→</a> <a id="1201" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1207" href="verificationStackScripts.stackState.html#919" class="Record">StackState</a>
<a id="1218" href="verificationStackScripts.semanticsStackInstructions.html#1155" class="Function Operator">⟦</a> <a id="1220" href="verificationStackScripts.semanticsStackInstructions.html#1220" class="Bound">op</a> <a id="1223" href="verificationStackScripts.semanticsStackInstructions.html#1155" class="Function Operator">⟧ₛ⁺</a> <a id="1227" href="verificationStackScripts.semanticsStackInstructions.html#1227" class="Bound">t</a> <a id="1229" class="Symbol">=</a> <a id="1231" href="verificationStackScripts.semanticsStackInstructions.html#1227" class="Bound">t</a> <a id="1233" href="Data.Maybe.Base.html#2256" class="Function Operator">&gt;&gt;=</a> <a id="1237" href="verificationStackScripts.semanticsStackInstructions.html#1051" class="Function Operator">⟦</a> <a id="1239" href="verificationStackScripts.semanticsStackInstructions.html#1220" class="Bound">op</a> <a id="1242" href="verificationStackScripts.semanticsStackInstructions.html#1051" class="Function Operator">⟧ₛ</a>



<a id="⟦_⟧"></a><a id="1248" href="verificationStackScripts.semanticsStackInstructions.html#1248" class="Function Operator">⟦_⟧</a> <a id="1252" class="Symbol">:</a> <a id="1254" href="instructionBasic.html#1030" class="Function">BitcoinScriptBasic</a> <a id="1273" class="Symbol">→</a> <a id="1275" href="verificationStackScripts.stackState.html#919" class="Record">StackState</a> <a id="1286" class="Symbol">→</a> <a id="1288" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1294" href="verificationStackScripts.stackState.html#919" class="Record">StackState</a>
<a id="1305" href="verificationStackScripts.semanticsStackInstructions.html#1248" class="Function Operator">⟦</a> <a id="1307" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>  <a id="1311" href="verificationStackScripts.semanticsStackInstructions.html#1248" class="Function Operator">⟧</a>  <a id="1314" class="Symbol">=</a> <a id="1316" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a>
<a id="1321" href="verificationStackScripts.semanticsStackInstructions.html#1248" class="Function Operator">⟦</a> <a id="1323" href="verificationStackScripts.semanticsStackInstructions.html#1323" class="Bound">op</a> <a id="1326" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1328" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>  <a id="1332" href="verificationStackScripts.semanticsStackInstructions.html#1248" class="Function Operator">⟧</a>  <a id="1335" class="Symbol">=</a> <a id="1337" href="verificationStackScripts.semanticsStackInstructions.html#1051" class="Function Operator">⟦</a> <a id="1339" href="verificationStackScripts.semanticsStackInstructions.html#1323" class="Bound">op</a> <a id="1342" href="verificationStackScripts.semanticsStackInstructions.html#1051" class="Function Operator">⟧ₛ</a>
<a id="1345" href="verificationStackScripts.semanticsStackInstructions.html#1248" class="CatchallClause Function Operator">⟦</a><a id="1346" class="CatchallClause"> </a><a id="1347" href="verificationStackScripts.semanticsStackInstructions.html#1347" class="CatchallClause Bound">op</a><a id="1349" class="CatchallClause"> </a><a id="1350" href="Agda.Builtin.List.html#199" class="CatchallClause InductiveConstructor Operator">∷</a><a id="1351" class="CatchallClause"> </a><a id="1352" href="verificationStackScripts.semanticsStackInstructions.html#1352" class="CatchallClause Bound">p</a><a id="1353" class="CatchallClause">   </a><a id="1356" href="verificationStackScripts.semanticsStackInstructions.html#1248" class="CatchallClause Function Operator">⟧</a><a id="1357" class="CatchallClause">  </a><a id="1359" href="verificationStackScripts.semanticsStackInstructions.html#1359" class="CatchallClause Bound">s</a> <a id="1361" class="Symbol">=</a> <a id="1363" href="verificationStackScripts.semanticsStackInstructions.html#1051" class="Function Operator">⟦</a> <a id="1365" href="verificationStackScripts.semanticsStackInstructions.html#1347" class="Bound">op</a> <a id="1368" href="verificationStackScripts.semanticsStackInstructions.html#1051" class="Function Operator">⟧ₛ</a> <a id="1371" href="verificationStackScripts.semanticsStackInstructions.html#1359" class="Bound">s</a> <a id="1373" href="Data.Maybe.Base.html#2256" class="Function Operator">&gt;&gt;=</a>  <a id="1378" href="verificationStackScripts.semanticsStackInstructions.html#1248" class="Function Operator">⟦</a> <a id="1380" href="verificationStackScripts.semanticsStackInstructions.html#1352" class="Bound">p</a> <a id="1382" href="verificationStackScripts.semanticsStackInstructions.html#1248" class="Function Operator">⟧</a>

<a id="⟦_⟧⁺"></a><a id="1385" href="verificationStackScripts.semanticsStackInstructions.html#1385" class="Function Operator">⟦_⟧⁺</a> <a id="1390" class="Symbol">:</a> <a id="1392" href="instructionBasic.html#1030" class="Function">BitcoinScriptBasic</a> <a id="1411" class="Symbol">→</a> <a id="1413" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1419" href="verificationStackScripts.stackState.html#919" class="Record">StackState</a> <a id="1430" class="Symbol">→</a> <a id="1432" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1438" href="verificationStackScripts.stackState.html#919" class="Record">StackState</a>
<a id="1449" href="verificationStackScripts.semanticsStackInstructions.html#1385" class="Function Operator">⟦</a> <a id="1451" href="verificationStackScripts.semanticsStackInstructions.html#1451" class="Bound">p</a> <a id="1453" href="verificationStackScripts.semanticsStackInstructions.html#1385" class="Function Operator">⟧⁺</a> <a id="1456" href="verificationStackScripts.semanticsStackInstructions.html#1456" class="Bound">s</a> <a id="1458" class="Symbol">=</a> <a id="1460" href="verificationStackScripts.semanticsStackInstructions.html#1456" class="Bound">s</a> <a id="1462" href="Data.Maybe.Base.html#2256" class="Function Operator">&gt;&gt;=</a> <a id="1466" href="verificationStackScripts.semanticsStackInstructions.html#1248" class="Function Operator">⟦</a> <a id="1468" href="verificationStackScripts.semanticsStackInstructions.html#1451" class="Bound">p</a> <a id="1470" href="verificationStackScripts.semanticsStackInstructions.html#1248" class="Function Operator">⟧</a>


<a id="validStackAux"></a><a id="1474" href="verificationStackScripts.semanticsStackInstructions.html#1474" class="Function">validStackAux</a> <a id="1488" class="Symbol">:</a> <a id="1490" class="Symbol">(</a><a id="1491" href="verificationStackScripts.semanticsStackInstructions.html#1491" class="Bound">pbkh</a> <a id="1496" class="Symbol">:</a> <a id="1498" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1499" class="Symbol">)</a> <a id="1501" class="Symbol">→</a>  <a id="1504" class="Symbol">(</a><a id="1505" href="verificationStackScripts.semanticsStackInstructions.html#1505" class="Bound">msg</a> <a id="1509" class="Symbol">:</a> <a id="1511" href="basicBitcoinDataType.html#842" class="Datatype">Msg</a><a id="1514" class="Symbol">)</a> <a id="1516" class="Symbol">→</a>  <a id="1519" href="stack.html#690" class="Function">Stack</a> <a id="1525" class="Symbol">→</a>  <a id="1528" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1533" href="verificationStackScripts.semanticsStackInstructions.html#1474" class="Function">validStackAux</a> <a id="1547" href="verificationStackScripts.semanticsStackInstructions.html#1547" class="Bound">pkh</a> <a id="1551" href="verificationStackScripts.semanticsStackInstructions.html#1551" class="Bound">msg[]</a>  <a id="1558" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>  <a id="1562" class="Symbol">=</a> <a id="1564" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="1570" href="verificationStackScripts.semanticsStackInstructions.html#1474" class="Function">validStackAux</a> <a id="1584" href="verificationStackScripts.semanticsStackInstructions.html#1584" class="Bound">pkh</a> <a id="1588" href="verificationStackScripts.semanticsStackInstructions.html#1588" class="Bound">msg</a> <a id="1592" class="Symbol">(</a><a id="1593" href="verificationStackScripts.semanticsStackInstructions.html#1593" class="Bound">pbk</a> <a id="1597" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1599" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1601" class="Symbol">)</a> <a id="1603" class="Symbol">=</a> <a id="1605" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="1611" href="verificationStackScripts.semanticsStackInstructions.html#1474" class="Function">validStackAux</a> <a id="1625" href="verificationStackScripts.semanticsStackInstructions.html#1625" class="Bound">pkh</a> <a id="1629" href="verificationStackScripts.semanticsStackInstructions.html#1629" class="Bound">msg</a> <a id="1633" class="Symbol">(</a><a id="1634" href="verificationStackScripts.semanticsStackInstructions.html#1634" class="Bound">pbk</a> <a id="1638" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1640" href="verificationStackScripts.semanticsStackInstructions.html#1640" class="Bound">sig</a> <a id="1644" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1646" href="verificationStackScripts.semanticsStackInstructions.html#1646" class="Bound">s</a><a id="1647" class="Symbol">)</a> <a id="1649" class="Symbol">=</a> <a id="1651" href="semanticBasicOperations.html#766" class="Function">hashFun</a> <a id="1659" href="verificationStackScripts.semanticsStackInstructions.html#1634" class="Bound">pbk</a>  <a id="1664" href="libraries.natLib.html#723" class="Function Operator">==b</a> <a id="1668" href="verificationStackScripts.semanticsStackInstructions.html#1625" class="Bound">pkh</a> <a id="1672" href="verificationStackScripts.semanticsStackInstructions.html#318" class="Function Operator">∧b</a> <a id="1675" href="semanticBasicOperations.html#2906" class="Function">isSigned</a>  <a id="1685" href="verificationStackScripts.semanticsStackInstructions.html#1629" class="Bound">msg</a> <a id="1689" href="verificationStackScripts.semanticsStackInstructions.html#1640" class="Bound">sig</a> <a id="1693" href="verificationStackScripts.semanticsStackInstructions.html#1634" class="Bound">pbk</a>

<a id="validStack"></a><a id="1698" href="verificationStackScripts.semanticsStackInstructions.html#1698" class="Function">validStack</a> <a id="1709" class="Symbol">:</a> <a id="1711" class="Symbol">(</a><a id="1712" href="verificationStackScripts.semanticsStackInstructions.html#1712" class="Bound">pkh</a> <a id="1716" class="Symbol">:</a> <a id="1718" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1719" class="Symbol">)</a> <a id="1721" class="Symbol">→</a>  <a id="1724" href="verificationStackScripts.sPredicate.html#1014" class="Function">BStackStatePred</a>
<a id="1740" href="verificationStackScripts.semanticsStackInstructions.html#1698" class="Function">validStack</a> <a id="1751" href="verificationStackScripts.semanticsStackInstructions.html#1751" class="Bound">pkh</a> <a id="1755" href="verificationStackScripts.stackState.html#963" class="InductiveConstructor Operator">⟨</a> <a id="1757" href="verificationStackScripts.semanticsStackInstructions.html#1757" class="Bound">time</a> <a id="1762" href="verificationStackScripts.stackState.html#963" class="InductiveConstructor Operator">,</a> <a id="1764" href="verificationStackScripts.semanticsStackInstructions.html#1764" class="Bound">msg₁</a> <a id="1769" href="verificationStackScripts.stackState.html#963" class="InductiveConstructor Operator">,</a> <a id="1771" href="verificationStackScripts.semanticsStackInstructions.html#1771" class="Bound">stack₁</a> <a id="1778" href="verificationStackScripts.stackState.html#963" class="InductiveConstructor Operator">⟩</a> <a id="1780" class="Symbol">=</a> <a id="1782" href="verificationStackScripts.semanticsStackInstructions.html#1474" class="Function">validStackAux</a>  <a id="1797" href="verificationStackScripts.semanticsStackInstructions.html#1751" class="Bound">pkh</a>   <a id="1803" href="verificationStackScripts.semanticsStackInstructions.html#1764" class="Bound">msg₁</a>  <a id="1809" href="verificationStackScripts.semanticsStackInstructions.html#1771" class="Bound">stack₁</a>
</pre></body></html>