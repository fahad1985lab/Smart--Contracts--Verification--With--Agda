<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>basicBitcoinDataType</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="basicBitcoinDataType.html" class="Module">basicBitcoinDataType</a> <a id="29" class="Keyword">where</a>



<a id="38" class="Keyword">open</a> <a id="43" class="Keyword">import</a> <a id="50" href="Data.Nat.html" class="Module">Data.Nat</a>  <a id="60" class="Keyword">hiding</a> <a id="67" class="Symbol">(</a><a id="68" href="Data.Nat.Base.html#1535" class="Datatype Operator">_≤_</a><a id="71" class="Symbol">)</a>
<a id="73" class="Keyword">open</a> <a id="78" class="Keyword">import</a> <a id="85" href="Data.List.html" class="Module">Data.List</a> <a id="95" class="Keyword">hiding</a> <a id="102" class="Symbol">(</a><a id="103" href="Data.List.Base.html#1810" class="Function Operator">_++_</a><a id="107" class="Symbol">)</a>
<a id="109" class="Keyword">open</a> <a id="114" class="Keyword">import</a> <a id="121" href="Data.Unit.html" class="Module">Data.Unit</a>  <a id="132" class="Keyword">hiding</a> <a id="139" class="Symbol">(</a><a id="140" href="Data.Unit.Base.html#1023" class="Record Operator">_≤_</a><a id="143" class="Symbol">)</a>
<a id="145" class="Keyword">open</a> <a id="150" class="Keyword">import</a> <a id="157" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="168" class="Keyword">open</a> <a id="173" class="Keyword">import</a> <a id="180" href="Data.Bool.html" class="Module">Data.Bool</a>  <a id="191" class="Keyword">hiding</a> <a id="198" class="Symbol">(</a><a id="199" href="Data.Bool.Base.html#672" class="Datatype Operator">_≤_</a> <a id="203" class="Symbol">;</a> <a id="205" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a> <a id="219" class="Symbol">)</a> <a id="221" class="Keyword">renaming</a> <a id="230" class="Symbol">(</a><a id="231" href="Data.Bool.Base.html#986" class="Function Operator">_∧_</a> <a id="235" class="Symbol">to</a> <a id="238" class="Function Operator">_∧b_</a> <a id="243" class="Symbol">;</a> <a id="245" href="Data.Bool.Base.html#1044" class="Function Operator">_∨_</a> <a id="249" class="Symbol">to</a> <a id="252" class="Function Operator">_∨b_</a> <a id="257" class="Symbol">;</a> <a id="259" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="261" class="Symbol">to</a> <a id="264" class="Function">True</a><a id="268" class="Symbol">)</a>
<a id="270" class="Keyword">open</a> <a id="275" class="Keyword">import</a> <a id="282" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="297" class="Keyword">hiding</a> <a id="304" class="Symbol">(</a><a id="305" href="Data.Bool.Base.html#672" class="Datatype Operator">_≤_</a> <a id="309" class="Symbol">;</a> <a id="311" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a> <a id="325" class="Symbol">)</a> <a id="327" class="Keyword">renaming</a> <a id="336" class="Symbol">(</a><a id="337" href="Data.Bool.Base.html#986" class="Function Operator">_∧_</a> <a id="341" class="Symbol">to</a> <a id="344" class="Function Operator">_∧b_</a> <a id="349" class="Symbol">;</a> <a id="351" href="Data.Bool.Base.html#1044" class="Function Operator">_∨_</a> <a id="355" class="Symbol">to</a> <a id="358" class="Function Operator">_∨b_</a> <a id="363" class="Symbol">;</a> <a id="365" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="367" class="Symbol">to</a> <a id="370" class="Function">True</a><a id="374" class="Symbol">)</a>
<a id="376" class="Keyword">open</a> <a id="381" class="Keyword">import</a> <a id="388" href="Data.Product.html" class="Module">Data.Product</a> <a id="401" class="Keyword">renaming</a> <a id="410" class="Symbol">(</a><a id="411" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="415" class="Symbol">to</a> <a id="418" class="InductiveConstructor Operator">_,,_</a> <a id="423" class="Symbol">)</a>
<a id="425" class="Keyword">open</a> <a id="430" class="Keyword">import</a> <a id="437" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="451" class="Keyword">hiding</a> <a id="458" class="Symbol">(</a><a id="459" href="Data.Nat.Base.html#1535" class="Datatype Operator">_≤_</a><a id="462" class="Symbol">)</a>
<a id="464" class="Keyword">open</a> <a id="469" class="Keyword">import</a> <a id="476" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="495" class="Keyword">hiding</a> <a id="502" class="Symbol">(</a><a id="503" href="Data.List.NonEmpty.Base.html#1141" class="Field">head</a><a id="507" class="Symbol">)</a>

<a id="510" class="Keyword">open</a> <a id="515" class="Keyword">import</a> <a id="522" href="libraries.listLib.html" class="Module">libraries.listLib</a>
<a id="540" class="Keyword">open</a> <a id="545" class="Keyword">import</a> <a id="552" href="libraries.natLib.html" class="Module">libraries.natLib</a>
<a id="569" class="Keyword">open</a> <a id="574" class="Keyword">import</a> <a id="581" href="libraries.boolLib.html" class="Module">libraries.boolLib</a>
<a id="599" class="Keyword">open</a> <a id="604" class="Keyword">import</a> <a id="611" href="libraries.andLib.html" class="Module">libraries.andLib</a>
<a id="628" class="Keyword">open</a> <a id="633" class="Keyword">import</a> <a id="640" href="libraries.maybeLib.html" class="Module">libraries.maybeLib</a>



<a id="Time"></a><a id="662" href="basicBitcoinDataType.html#662" class="Function">Time</a>   <a id="669" class="Symbol">:</a> <a id="671" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="675" href="basicBitcoinDataType.html#662" class="Function">Time</a>   <a id="682" class="Symbol">=</a>   <a id="686" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="Amount"></a><a id="688" href="basicBitcoinDataType.html#688" class="Function">Amount</a> <a id="695" class="Symbol">:</a> <a id="697" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="701" href="basicBitcoinDataType.html#688" class="Function">Amount</a> <a id="708" class="Symbol">=</a>  <a id="711" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="Address"></a><a id="714" href="basicBitcoinDataType.html#714" class="Function">Address</a> <a id="722" class="Symbol">:</a> <a id="724" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="728" href="basicBitcoinDataType.html#714" class="Function">Address</a>  <a id="737" class="Symbol">=</a>  <a id="740" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="TXID"></a><a id="743" href="basicBitcoinDataType.html#743" class="Function">TXID</a> <a id="748" class="Symbol">:</a> <a id="750" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="754" href="basicBitcoinDataType.html#743" class="Function">TXID</a> <a id="759" class="Symbol">=</a>    <a id="764" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="Signature"></a><a id="767" href="basicBitcoinDataType.html#767" class="Function">Signature</a> <a id="777" class="Symbol">:</a> <a id="779" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="783" href="basicBitcoinDataType.html#767" class="Function">Signature</a> <a id="793" class="Symbol">=</a>  <a id="796" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="PublicKey"></a><a id="799" href="basicBitcoinDataType.html#799" class="Function">PublicKey</a> <a id="809" class="Symbol">:</a> <a id="811" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="815" href="basicBitcoinDataType.html#799" class="Function">PublicKey</a>  <a id="826" class="Symbol">=</a>  <a id="829" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="832" class="Keyword">infixr</a> <a id="839" class="Number">3</a> <a id="841" href="basicBitcoinDataType.html#907" class="InductiveConstructor Operator">_+msg_</a>

<a id="849" class="Keyword">data</a> <a id="Msg"></a><a id="854" href="basicBitcoinDataType.html#854" class="Datatype">Msg</a> <a id="858" class="Symbol">:</a> <a id="860" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="864" class="Keyword">where</a>
   <a id="Msg.nat"></a><a id="873" href="basicBitcoinDataType.html#873" class="InductiveConstructor">nat</a>     <a id="881" class="Symbol">:</a>  <a id="884" class="Symbol">(</a><a id="885" href="basicBitcoinDataType.html#885" class="Bound">n</a> <a id="887" class="Symbol">:</a> <a id="889" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="890" class="Symbol">)</a>       <a id="898" class="Symbol">→</a> <a id="900" href="basicBitcoinDataType.html#854" class="Datatype">Msg</a>
   <a id="Msg._+msg_"></a><a id="907" href="basicBitcoinDataType.html#907" class="InductiveConstructor Operator">_+msg_</a>  <a id="915" class="Symbol">:</a>  <a id="918" class="Symbol">(</a><a id="919" href="basicBitcoinDataType.html#919" class="Bound">m</a> <a id="921" href="basicBitcoinDataType.html#921" class="Bound">m&#39;</a> <a id="924" class="Symbol">:</a> <a id="926" href="basicBitcoinDataType.html#854" class="Datatype">Msg</a><a id="929" class="Symbol">)</a>     <a id="935" class="Symbol">→</a> <a id="937" href="basicBitcoinDataType.html#854" class="Datatype">Msg</a>
   <a id="Msg.list"></a><a id="944" href="basicBitcoinDataType.html#944" class="InductiveConstructor">list</a>    <a id="952" class="Symbol">:</a>  <a id="955" class="Symbol">(</a><a id="956" href="basicBitcoinDataType.html#956" class="Bound">l</a>  <a id="959" class="Symbol">:</a> <a id="961" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="966" href="basicBitcoinDataType.html#854" class="Datatype">Msg</a><a id="969" class="Symbol">)</a>  <a id="972" class="Symbol">→</a> <a id="974" href="basicBitcoinDataType.html#854" class="Datatype">Msg</a>



<a id="981" class="Comment">-- function that compares time</a>
<a id="instructOpTime"></a><a id="1012" href="basicBitcoinDataType.html#1012" class="Function">instructOpTime</a> <a id="1027" class="Symbol">:</a> <a id="1029" class="Symbol">(</a><a id="1030" href="basicBitcoinDataType.html#1030" class="Bound">currentTime</a> <a id="1042" class="Symbol">:</a> <a id="1044" href="basicBitcoinDataType.html#662" class="Function">Time</a><a id="1048" class="Symbol">)</a> <a id="1050" class="Symbol">(</a><a id="1051" href="basicBitcoinDataType.html#1051" class="Bound">entryInContract</a> <a id="1067" class="Symbol">:</a> <a id="1069" href="basicBitcoinDataType.html#662" class="Function">Time</a><a id="1073" class="Symbol">)</a> <a id="1075" class="Symbol">→</a> <a id="1077" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1082" href="basicBitcoinDataType.html#1012" class="Function">instructOpTime</a> <a id="1097" href="basicBitcoinDataType.html#1097" class="Bound">currentTime</a> <a id="1109" href="basicBitcoinDataType.html#1109" class="Bound">entryInContract</a>  <a id="1126" class="Symbol">=</a> <a id="1128" href="basicBitcoinDataType.html#1109" class="Bound">entryInContract</a> <a id="1144" href="libraries.natLib.html#591" class="Function Operator">≤b</a> <a id="1147" href="basicBitcoinDataType.html#1097" class="Bound">currentTime</a>



<a id="1162" class="Keyword">record</a> <a id="GlobalParameters"></a><a id="1169" href="basicBitcoinDataType.html#1169" class="Record">GlobalParameters</a> <a id="1186" class="Symbol">:</a> <a id="1188" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1192" class="Keyword">where</a>
  <a id="1200" class="Keyword">field</a>
    <a id="GlobalParameters.publicKey2Address"></a><a id="1210" href="basicBitcoinDataType.html#1210" class="Field">publicKey2Address</a> <a id="1228" class="Symbol">:</a> <a id="1230" class="Symbol">(</a><a id="1231" href="basicBitcoinDataType.html#1231" class="Bound">pubk</a> <a id="1236" class="Symbol">:</a> <a id="1238" href="basicBitcoinDataType.html#799" class="Function">PublicKey</a><a id="1247" class="Symbol">)</a> <a id="1249" class="Symbol">→</a> <a id="1251" href="basicBitcoinDataType.html#714" class="Function">Address</a>
    <a id="GlobalParameters.hash"></a><a id="1263" href="basicBitcoinDataType.html#1263" class="Field">hash</a>              <a id="1281" class="Symbol">:</a> <a id="1283" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1285" class="Symbol">→</a> <a id="1287" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="GlobalParameters.signed"></a><a id="1293" href="basicBitcoinDataType.html#1293" class="Field">signed</a>            <a id="1311" class="Symbol">:</a> <a id="1313" class="Symbol">(</a><a id="1314" href="basicBitcoinDataType.html#1314" class="Bound">msg</a> <a id="1318" class="Symbol">:</a> <a id="1320" href="basicBitcoinDataType.html#854" class="Datatype">Msg</a><a id="1323" class="Symbol">)(</a><a id="1325" href="basicBitcoinDataType.html#1325" class="Bound">s</a> <a id="1327" class="Symbol">:</a> <a id="1329" href="basicBitcoinDataType.html#767" class="Function">Signature</a><a id="1338" class="Symbol">)(</a><a id="1340" href="basicBitcoinDataType.html#1340" class="Bound">publicKey</a> <a id="1350" class="Symbol">:</a> <a id="1352" href="basicBitcoinDataType.html#799" class="Function">PublicKey</a><a id="1361" class="Symbol">)</a> <a id="1363" class="Symbol">→</a> <a id="1365" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
  <a id="GlobalParameters.Signed"></a><a id="1372" href="basicBitcoinDataType.html#1372" class="Function">Signed</a> <a id="1379" class="Symbol">:</a> <a id="1381" class="Symbol">(</a><a id="1382" href="basicBitcoinDataType.html#1382" class="Bound">msg</a> <a id="1386" class="Symbol">:</a> <a id="1388" href="basicBitcoinDataType.html#854" class="Datatype">Msg</a><a id="1391" class="Symbol">)(</a><a id="1393" href="basicBitcoinDataType.html#1393" class="Bound">s</a> <a id="1395" class="Symbol">:</a> <a id="1397" href="basicBitcoinDataType.html#767" class="Function">Signature</a><a id="1406" class="Symbol">)(</a><a id="1408" href="basicBitcoinDataType.html#1408" class="Bound">publicKey</a> <a id="1418" class="Symbol">:</a> <a id="1420" href="basicBitcoinDataType.html#799" class="Function">PublicKey</a><a id="1429" class="Symbol">)</a> <a id="1431" class="Symbol">→</a> <a id="1433" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="1439" href="basicBitcoinDataType.html#1372" class="Function">Signed</a> <a id="1446" href="basicBitcoinDataType.html#1446" class="Bound">msg</a> <a id="1450" href="basicBitcoinDataType.html#1450" class="Bound">s</a> <a id="1452" href="basicBitcoinDataType.html#1452" class="Bound">publicKey</a>  <a id="1463" class="Symbol">=</a> <a id="1465" href="basicBitcoinDataType.html#264" class="Function">True</a> <a id="1470" class="Symbol">(</a><a id="1471" href="basicBitcoinDataType.html#1293" class="Field">signed</a> <a id="1478" href="basicBitcoinDataType.html#1446" class="Bound">msg</a> <a id="1482" href="basicBitcoinDataType.html#1450" class="Bound">s</a> <a id="1484" href="basicBitcoinDataType.html#1452" class="Bound">publicKey</a><a id="1493" class="Symbol">)</a>

<a id="1496" class="Keyword">open</a> <a id="1501" href="basicBitcoinDataType.html#1169" class="Module">GlobalParameters</a> <a id="1518" class="Keyword">public</a>
</pre></body></html>