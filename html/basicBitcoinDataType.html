<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>basicBitcoinDataType</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="basicBitcoinDataType.html" class="Module">basicBitcoinDataType</a> <a id="29" class="Keyword">where</a>



<a id="38" class="Keyword">open</a> <a id="43" class="Keyword">import</a> <a id="50" href="Data.Nat.html" class="Module">Data.Nat</a>  <a id="60" class="Keyword">hiding</a> <a id="67" class="Symbol">(</a><a id="68" href="Data.Nat.Base.html#1691" class="Datatype Operator">_≤_</a><a id="71" class="Symbol">)</a>
<a id="73" class="Keyword">open</a> <a id="78" class="Keyword">import</a> <a id="85" href="Data.List.html" class="Module">Data.List</a> <a id="95" class="Keyword">hiding</a> <a id="102" class="Symbol">(</a><a id="103" href="Data.List.Base.html#1954" class="Function Operator">_++_</a><a id="107" class="Symbol">)</a>
<a id="109" class="Keyword">open</a> <a id="114" class="Keyword">import</a> <a id="121" href="Data.Unit.html" class="Module">Data.Unit</a>  
<a id="133" class="Keyword">open</a> <a id="138" class="Keyword">import</a> <a id="145" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="156" class="Keyword">open</a> <a id="161" class="Keyword">import</a> <a id="168" href="Data.Bool.html" class="Module">Data.Bool</a>  <a id="179" class="Keyword">hiding</a> <a id="186" class="Symbol">(</a><a id="187" href="Data.Bool.Base.html#681" class="Datatype Operator">_≤_</a> <a id="191" class="Symbol">;</a> <a id="193" href="Data.Bool.Base.html#1505" class="Function Operator">if_then_else_</a> <a id="207" class="Symbol">)</a> <a id="209" class="Keyword">renaming</a> <a id="218" class="Symbol">(</a><a id="219" href="Data.Bool.Base.html#995" class="Function Operator">_∧_</a> <a id="223" class="Symbol">to</a> <a id="226" class="Function Operator">_∧b_</a> <a id="231" class="Symbol">;</a> <a id="233" href="Data.Bool.Base.html#1053" class="Function Operator">_∨_</a> <a id="237" class="Symbol">to</a> <a id="240" class="Function Operator">_∨b_</a> <a id="245" class="Symbol">;</a> <a id="247" href="Data.Bool.Base.html#1348" class="Function">T</a> <a id="249" class="Symbol">to</a> <a id="252" class="Function">True</a><a id="256" class="Symbol">)</a>
<a id="258" class="Keyword">open</a> <a id="263" class="Keyword">import</a> <a id="270" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="285" class="Keyword">hiding</a> <a id="292" class="Symbol">(</a><a id="293" href="Data.Bool.Base.html#681" class="Datatype Operator">_≤_</a> <a id="297" class="Symbol">;</a> <a id="299" href="Data.Bool.Base.html#1505" class="Function Operator">if_then_else_</a> <a id="313" class="Symbol">)</a> <a id="315" class="Keyword">renaming</a> <a id="324" class="Symbol">(</a><a id="325" href="Data.Bool.Base.html#995" class="Function Operator">_∧_</a> <a id="329" class="Symbol">to</a> <a id="332" class="Function Operator">_∧b_</a> <a id="337" class="Symbol">;</a> <a id="339" href="Data.Bool.Base.html#1053" class="Function Operator">_∨_</a> <a id="343" class="Symbol">to</a> <a id="346" class="Function Operator">_∨b_</a> <a id="351" class="Symbol">;</a> <a id="353" href="Data.Bool.Base.html#1348" class="Function">T</a> <a id="355" class="Symbol">to</a> <a id="358" class="Function">True</a><a id="362" class="Symbol">)</a>
<a id="364" class="Keyword">open</a> <a id="369" class="Keyword">import</a> <a id="376" href="Data.Product.html" class="Module">Data.Product</a> <a id="389" class="Keyword">renaming</a> <a id="398" class="Symbol">(</a><a id="399" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="403" class="Symbol">to</a> <a id="406" class="InductiveConstructor Operator">_,,_</a> <a id="411" class="Symbol">)</a>
<a id="413" class="Keyword">open</a> <a id="418" class="Keyword">import</a> <a id="425" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="439" class="Keyword">hiding</a> <a id="446" class="Symbol">(</a><a id="447" href="Data.Nat.Base.html#1691" class="Datatype Operator">_≤_</a><a id="450" class="Symbol">)</a>
<a id="452" class="Keyword">open</a> <a id="457" class="Keyword">import</a> <a id="464" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="483" class="Keyword">hiding</a> <a id="490" class="Symbol">(</a><a id="491" href="Data.List.NonEmpty.Base.html#1291" class="Field">head</a><a id="495" class="Symbol">)</a>

<a id="498" class="Keyword">open</a> <a id="503" class="Keyword">import</a> <a id="510" href="libraries.listLib.html" class="Module">libraries.listLib</a>
<a id="528" class="Keyword">open</a> <a id="533" class="Keyword">import</a> <a id="540" href="libraries.natLib.html" class="Module">libraries.natLib</a>
<a id="557" class="Keyword">open</a> <a id="562" class="Keyword">import</a> <a id="569" href="libraries.boolLib.html" class="Module">libraries.boolLib</a>
<a id="587" class="Keyword">open</a> <a id="592" class="Keyword">import</a> <a id="599" href="libraries.andLib.html" class="Module">libraries.andLib</a>
<a id="616" class="Keyword">open</a> <a id="621" class="Keyword">import</a> <a id="628" href="libraries.maybeLib.html" class="Module">libraries.maybeLib</a>



<a id="Time"></a><a id="650" href="basicBitcoinDataType.html#650" class="Function">Time</a>   <a id="657" class="Symbol">:</a> <a id="659" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="663" href="basicBitcoinDataType.html#650" class="Function">Time</a>   <a id="670" class="Symbol">=</a>   <a id="674" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="Amount"></a><a id="676" href="basicBitcoinDataType.html#676" class="Function">Amount</a> <a id="683" class="Symbol">:</a> <a id="685" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="689" href="basicBitcoinDataType.html#676" class="Function">Amount</a> <a id="696" class="Symbol">=</a>  <a id="699" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="Address"></a><a id="702" href="basicBitcoinDataType.html#702" class="Function">Address</a> <a id="710" class="Symbol">:</a> <a id="712" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="716" href="basicBitcoinDataType.html#702" class="Function">Address</a>  <a id="725" class="Symbol">=</a>  <a id="728" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="TXID"></a><a id="731" href="basicBitcoinDataType.html#731" class="Function">TXID</a> <a id="736" class="Symbol">:</a> <a id="738" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="742" href="basicBitcoinDataType.html#731" class="Function">TXID</a> <a id="747" class="Symbol">=</a>    <a id="752" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="Signature"></a><a id="755" href="basicBitcoinDataType.html#755" class="Function">Signature</a> <a id="765" class="Symbol">:</a> <a id="767" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="771" href="basicBitcoinDataType.html#755" class="Function">Signature</a> <a id="781" class="Symbol">=</a>  <a id="784" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="PublicKey"></a><a id="787" href="basicBitcoinDataType.html#787" class="Function">PublicKey</a> <a id="797" class="Symbol">:</a> <a id="799" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="803" href="basicBitcoinDataType.html#787" class="Function">PublicKey</a>  <a id="814" class="Symbol">=</a>  <a id="817" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="820" class="Keyword">infixr</a> <a id="827" class="Number">3</a> <a id="829" href="basicBitcoinDataType.html#895" class="InductiveConstructor Operator">_+msg_</a>

<a id="837" class="Keyword">data</a> <a id="Msg"></a><a id="842" href="basicBitcoinDataType.html#842" class="Datatype">Msg</a> <a id="846" class="Symbol">:</a> <a id="848" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="852" class="Keyword">where</a>
   <a id="Msg.nat"></a><a id="861" href="basicBitcoinDataType.html#861" class="InductiveConstructor">nat</a>     <a id="869" class="Symbol">:</a>  <a id="872" class="Symbol">(</a><a id="873" href="basicBitcoinDataType.html#873" class="Bound">n</a> <a id="875" class="Symbol">:</a> <a id="877" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="878" class="Symbol">)</a>       <a id="886" class="Symbol">→</a> <a id="888" href="basicBitcoinDataType.html#842" class="Datatype">Msg</a>
   <a id="Msg._+msg_"></a><a id="895" href="basicBitcoinDataType.html#895" class="InductiveConstructor Operator">_+msg_</a>  <a id="903" class="Symbol">:</a>  <a id="906" class="Symbol">(</a><a id="907" href="basicBitcoinDataType.html#907" class="Bound">m</a> <a id="909" href="basicBitcoinDataType.html#909" class="Bound">m&#39;</a> <a id="912" class="Symbol">:</a> <a id="914" href="basicBitcoinDataType.html#842" class="Datatype">Msg</a><a id="917" class="Symbol">)</a>     <a id="923" class="Symbol">→</a> <a id="925" href="basicBitcoinDataType.html#842" class="Datatype">Msg</a>
   <a id="Msg.list"></a><a id="932" href="basicBitcoinDataType.html#932" class="InductiveConstructor">list</a>    <a id="940" class="Symbol">:</a>  <a id="943" class="Symbol">(</a><a id="944" href="basicBitcoinDataType.html#944" class="Bound">l</a>  <a id="947" class="Symbol">:</a> <a id="949" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="954" href="basicBitcoinDataType.html#842" class="Datatype">Msg</a><a id="957" class="Symbol">)</a>  <a id="960" class="Symbol">→</a> <a id="962" href="basicBitcoinDataType.html#842" class="Datatype">Msg</a>



<a id="969" class="Comment">-- function that compares time</a>
<a id="instructOpTime"></a><a id="1000" href="basicBitcoinDataType.html#1000" class="Function">instructOpTime</a> <a id="1015" class="Symbol">:</a> <a id="1017" class="Symbol">(</a><a id="1018" href="basicBitcoinDataType.html#1018" class="Bound">currentTime</a> <a id="1030" class="Symbol">:</a> <a id="1032" href="basicBitcoinDataType.html#650" class="Function">Time</a><a id="1036" class="Symbol">)</a> <a id="1038" class="Symbol">(</a><a id="1039" href="basicBitcoinDataType.html#1039" class="Bound">entryInContract</a> <a id="1055" class="Symbol">:</a> <a id="1057" href="basicBitcoinDataType.html#650" class="Function">Time</a><a id="1061" class="Symbol">)</a> <a id="1063" class="Symbol">→</a> <a id="1065" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1070" href="basicBitcoinDataType.html#1000" class="Function">instructOpTime</a> <a id="1085" href="basicBitcoinDataType.html#1085" class="Bound">currentTime</a> <a id="1097" href="basicBitcoinDataType.html#1097" class="Bound">entryInContract</a>  <a id="1114" class="Symbol">=</a> <a id="1116" href="basicBitcoinDataType.html#1097" class="Bound">entryInContract</a> <a id="1132" href="libraries.natLib.html#578" class="Function Operator">≤b</a> <a id="1135" href="basicBitcoinDataType.html#1085" class="Bound">currentTime</a>



<a id="1150" class="Keyword">record</a> <a id="GlobalParameters"></a><a id="1157" href="basicBitcoinDataType.html#1157" class="Record">GlobalParameters</a> <a id="1174" class="Symbol">:</a> <a id="1176" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1180" class="Keyword">where</a>
  <a id="1188" class="Keyword">field</a>
    <a id="GlobalParameters.publicKey2Address"></a><a id="1198" href="basicBitcoinDataType.html#1198" class="Field">publicKey2Address</a> <a id="1216" class="Symbol">:</a> <a id="1218" class="Symbol">(</a><a id="1219" href="basicBitcoinDataType.html#1219" class="Bound">pubk</a> <a id="1224" class="Symbol">:</a> <a id="1226" href="basicBitcoinDataType.html#787" class="Function">PublicKey</a><a id="1235" class="Symbol">)</a> <a id="1237" class="Symbol">→</a> <a id="1239" href="basicBitcoinDataType.html#702" class="Function">Address</a>
    <a id="GlobalParameters.hash"></a><a id="1251" href="basicBitcoinDataType.html#1251" class="Field">hash</a>              <a id="1269" class="Symbol">:</a> <a id="1271" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1273" class="Symbol">→</a> <a id="1275" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
    <a id="GlobalParameters.signed"></a><a id="1281" href="basicBitcoinDataType.html#1281" class="Field">signed</a>            <a id="1299" class="Symbol">:</a> <a id="1301" class="Symbol">(</a><a id="1302" href="basicBitcoinDataType.html#1302" class="Bound">msg</a> <a id="1306" class="Symbol">:</a> <a id="1308" href="basicBitcoinDataType.html#842" class="Datatype">Msg</a><a id="1311" class="Symbol">)(</a><a id="1313" href="basicBitcoinDataType.html#1313" class="Bound">s</a> <a id="1315" class="Symbol">:</a> <a id="1317" href="basicBitcoinDataType.html#755" class="Function">Signature</a><a id="1326" class="Symbol">)(</a><a id="1328" href="basicBitcoinDataType.html#1328" class="Bound">publicKey</a> <a id="1338" class="Symbol">:</a> <a id="1340" href="basicBitcoinDataType.html#787" class="Function">PublicKey</a><a id="1349" class="Symbol">)</a> <a id="1351" class="Symbol">→</a> <a id="1353" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
  <a id="GlobalParameters.Signed"></a><a id="1360" href="basicBitcoinDataType.html#1360" class="Function">Signed</a> <a id="1367" class="Symbol">:</a> <a id="1369" class="Symbol">(</a><a id="1370" href="basicBitcoinDataType.html#1370" class="Bound">msg</a> <a id="1374" class="Symbol">:</a> <a id="1376" href="basicBitcoinDataType.html#842" class="Datatype">Msg</a><a id="1379" class="Symbol">)(</a><a id="1381" href="basicBitcoinDataType.html#1381" class="Bound">s</a> <a id="1383" class="Symbol">:</a> <a id="1385" href="basicBitcoinDataType.html#755" class="Function">Signature</a><a id="1394" class="Symbol">)(</a><a id="1396" href="basicBitcoinDataType.html#1396" class="Bound">publicKey</a> <a id="1406" class="Symbol">:</a> <a id="1408" href="basicBitcoinDataType.html#787" class="Function">PublicKey</a><a id="1417" class="Symbol">)</a> <a id="1419" class="Symbol">→</a> <a id="1421" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="1427" href="basicBitcoinDataType.html#1360" class="Function">Signed</a> <a id="1434" href="basicBitcoinDataType.html#1434" class="Bound">msg</a> <a id="1438" href="basicBitcoinDataType.html#1438" class="Bound">s</a> <a id="1440" href="basicBitcoinDataType.html#1440" class="Bound">publicKey</a>  <a id="1451" class="Symbol">=</a> <a id="1453" href="basicBitcoinDataType.html#252" class="Function">True</a> <a id="1458" class="Symbol">(</a><a id="1459" href="basicBitcoinDataType.html#1281" class="Field">signed</a> <a id="1466" href="basicBitcoinDataType.html#1434" class="Bound">msg</a> <a id="1470" href="basicBitcoinDataType.html#1438" class="Bound">s</a> <a id="1472" href="basicBitcoinDataType.html#1440" class="Bound">publicKey</a><a id="1481" class="Symbol">)</a>

<a id="1484" class="Keyword">open</a> <a id="1489" href="basicBitcoinDataType.html#1157" class="Module">GlobalParameters</a> <a id="1506" class="Keyword">public</a>
</pre></body></html>