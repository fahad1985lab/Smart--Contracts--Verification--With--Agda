<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>stack</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">--@PREFIX@stackexample</a>
<a id="24" class="Keyword">module</a> <a id="31" href="stack.html" class="Module">stack</a> <a id="37" class="Keyword">where</a>

<a id="44" class="Keyword">open</a> <a id="49" class="Keyword">import</a> <a id="56" href="Data.Nat.html" class="Module">Data.Nat</a>  <a id="66" class="Keyword">hiding</a> <a id="73" class="Symbol">(</a><a id="74" href="Data.Nat.Base.html#1535" class="Datatype Operator">_≤_</a><a id="77" class="Symbol">)</a>
<a id="79" class="Keyword">open</a> <a id="84" class="Keyword">import</a> <a id="91" href="Data.List.html" class="Module">Data.List</a> <a id="101" class="Keyword">hiding</a> <a id="108" class="Symbol">(</a><a id="109" href="Data.List.Base.html#1810" class="Function Operator">_++_</a><a id="113" class="Symbol">)</a>
<a id="115" class="Keyword">open</a> <a id="120" class="Keyword">import</a> <a id="127" href="Data.Unit.html" class="Module">Data.Unit</a>  <a id="138" class="Keyword">hiding</a> <a id="145" class="Symbol">(</a><a id="146" href="Data.Unit.Base.html#1023" class="Record Operator">_≤_</a><a id="149" class="Symbol">)</a>
<a id="151" class="Keyword">open</a> <a id="156" class="Keyword">import</a> <a id="163" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="174" class="Keyword">open</a> <a id="179" class="Keyword">import</a> <a id="186" href="Data.Maybe.html" class="Module">Data.Maybe</a>
<a id="197" class="Keyword">open</a> <a id="202" class="Keyword">import</a> <a id="209" href="Data.Bool.html" class="Module">Data.Bool</a>  <a id="220" class="Keyword">hiding</a> <a id="227" class="Symbol">(</a><a id="228" href="Data.Bool.Base.html#672" class="Datatype Operator">_≤_</a> <a id="232" class="Symbol">;</a> <a id="234" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a> <a id="248" class="Symbol">)</a> <a id="250" class="Keyword">renaming</a> <a id="259" class="Symbol">(</a><a id="260" href="Data.Bool.Base.html#986" class="Function Operator">_∧_</a> <a id="264" class="Symbol">to</a> <a id="267" class="Function Operator">_∧b_</a> <a id="272" class="Symbol">;</a> <a id="274" href="Data.Bool.Base.html#1044" class="Function Operator">_∨_</a> <a id="278" class="Symbol">to</a> <a id="281" class="Function Operator">_∨b_</a> <a id="286" class="Symbol">;</a> <a id="288" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="290" class="Symbol">to</a> <a id="293" class="Function">True</a><a id="297" class="Symbol">)</a>
<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="326" class="Keyword">hiding</a> <a id="333" class="Symbol">(</a><a id="334" href="Data.Bool.Base.html#672" class="Datatype Operator">_≤_</a> <a id="338" class="Symbol">;</a> <a id="340" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a> <a id="354" class="Symbol">)</a> <a id="356" class="Keyword">renaming</a> <a id="365" class="Symbol">(</a><a id="366" href="Data.Bool.Base.html#986" class="Function Operator">_∧_</a> <a id="370" class="Symbol">to</a> <a id="373" class="Function Operator">_∧b_</a> <a id="378" class="Symbol">;</a> <a id="380" href="Data.Bool.Base.html#1044" class="Function Operator">_∨_</a> <a id="384" class="Symbol">to</a> <a id="387" class="Function Operator">_∨b_</a> <a id="392" class="Symbol">;</a> <a id="394" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="396" class="Symbol">to</a> <a id="399" class="Function">True</a><a id="403" class="Symbol">)</a>
<a id="405" class="Keyword">open</a> <a id="410" class="Keyword">import</a> <a id="417" href="Data.Product.html" class="Module">Data.Product</a> <a id="430" class="Keyword">renaming</a> <a id="439" class="Symbol">(</a><a id="440" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="444" class="Symbol">to</a> <a id="447" class="InductiveConstructor Operator">_,,_</a> <a id="452" class="Symbol">)</a>
<a id="454" class="Keyword">open</a> <a id="459" class="Keyword">import</a> <a id="466" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="480" class="Keyword">hiding</a> <a id="487" class="Symbol">(</a><a id="488" href="Data.Nat.Base.html#1535" class="Datatype Operator">_≤_</a><a id="491" class="Symbol">)</a>
<a id="493" class="Keyword">open</a> <a id="498" class="Keyword">import</a> <a id="505" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="524" class="Keyword">hiding</a> <a id="531" class="Symbol">(</a><a id="532" href="Data.List.NonEmpty.Base.html#1141" class="Field">head</a><a id="536" class="Symbol">)</a>

<a id="539" class="Keyword">open</a> <a id="544" class="Keyword">import</a> <a id="551" href="libraries.listLib.html" class="Module">libraries.listLib</a>
<a id="569" class="Keyword">open</a> <a id="574" class="Keyword">import</a> <a id="581" href="libraries.natLib.html" class="Module">libraries.natLib</a>
<a id="598" class="Keyword">open</a> <a id="603" class="Keyword">import</a> <a id="610" href="libraries.boolLib.html" class="Module">libraries.boolLib</a>

<a id="629" class="Keyword">open</a> <a id="634" class="Keyword">import</a> <a id="641" href="libraries.andLib.html" class="Module">libraries.andLib</a>
<a id="658" class="Keyword">open</a> <a id="663" class="Keyword">import</a> <a id="670" href="libraries.miscLib.html" class="Module">libraries.miscLib</a>
<a id="688" class="Keyword">open</a> <a id="693" class="Keyword">import</a> <a id="700" href="libraries.maybeLib.html" class="Module">libraries.maybeLib</a>

<a id="720" class="Keyword">open</a> <a id="725" class="Keyword">import</a> <a id="732" href="basicBitcoinDataType.html" class="Module">basicBitcoinDataType</a>

<a id="754" class="Comment">--@BEGIN@stackdef</a>
<a id="Stack"></a><a id="772" href="stack.html#772" class="Function">Stack</a> <a id="778" class="Symbol">:</a> <a id="780" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="784" href="stack.html#772" class="Function">Stack</a> <a id="790" class="Symbol">=</a> <a id="792" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="797" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="799" class="Comment">--@END</a>

<a id="stackHasSingletonTop"></a><a id="807" href="stack.html#807" class="Function">stackHasSingletonTop</a>  <a id="829" class="Symbol">:</a> <a id="831" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="833" class="Symbol">→</a>   <a id="837" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="843" href="stack.html#772" class="Function">Stack</a> <a id="849" class="Symbol">→</a>  <a id="852" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="857" href="stack.html#807" class="Function">stackHasSingletonTop</a> <a id="878" href="stack.html#878" class="Bound">l</a> <a id="880" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="888" class="Symbol">=</a> <a id="890" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="896" href="stack.html#807" class="Function">stackHasSingletonTop</a> <a id="917" href="stack.html#917" class="Bound">l</a> <a id="919" class="Symbol">(</a><a id="920" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="925" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="927" class="Symbol">)</a> <a id="929" class="Symbol">=</a> <a id="931" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="937" href="stack.html#807" class="Function">stackHasSingletonTop</a> <a id="958" href="stack.html#958" class="Bound">l</a> <a id="960" class="Symbol">(</a><a id="961" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="966" class="Symbol">(</a><a id="967" href="stack.html#967" class="Bound">z</a> <a id="969" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="971" href="stack.html#971" class="Bound">y</a><a id="972" class="Symbol">))</a> <a id="975" class="Symbol">=</a>  <a id="978" href="stack.html#958" class="Bound">l</a>  <a id="981" href="libraries.natLib.html#736" class="Function Operator">==b</a> <a id="985" href="stack.html#967" class="Bound">z</a>


<a id="stackHasTop"></a><a id="989" href="stack.html#989" class="Function">stackHasTop</a>  <a id="1002" class="Symbol">:</a>   <a id="1006" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1011" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1013" class="Symbol">→</a>  <a id="1016" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a>  <a id="1023" href="stack.html#772" class="Function">Stack</a> <a id="1029" class="Symbol">→</a> <a id="1031" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1035" href="stack.html#989" class="Function">stackHasTop</a> <a id="1047" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1050" href="stack.html#1050" class="Bound">m</a> <a id="1052" class="Symbol">=</a> <a id="1054" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="1056" href="stack.html#989" class="Function">stackHasTop</a> <a id="1068" class="Symbol">(</a><a id="1069" href="stack.html#1069" class="Bound">y</a> <a id="1071" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1073" href="stack.html#1073" class="Bound">n</a><a id="1074" class="Symbol">)</a> <a id="1076" href="stack.html#1076" class="Bound">m</a> <a id="1078" class="Symbol">=</a> <a id="1080" href="stack.html#293" class="Function">True</a><a id="1084" class="Symbol">(</a><a id="1085" href="stack.html#807" class="Function">stackHasSingletonTop</a> <a id="1106" href="stack.html#1069" class="Bound">y</a> <a id="1108" href="stack.html#1076" class="Bound">m</a><a id="1109" class="Symbol">)</a>

<a id="stackAuxFunction"></a><a id="1112" href="stack.html#1112" class="Function">stackAuxFunction</a> <a id="1129" class="Symbol">:</a>  <a id="1132" href="stack.html#772" class="Function">Stack</a> <a id="1138" class="Symbol">→</a> <a id="1140" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="1145" class="Symbol">→</a> <a id="1147" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1153" href="stack.html#772" class="Function">Stack</a>
<a id="1159" href="stack.html#1112" class="Function">stackAuxFunction</a> <a id="1176" href="stack.html#1176" class="Bound">s</a> <a id="1178" href="stack.html#1178" class="Bound">b</a> <a id="1180" class="Symbol">=</a> <a id="1182" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1187" class="Symbol">(</a><a id="1188" href="libraries.natLib.html#890" class="Function">boolToNat</a> <a id="1198" href="stack.html#1178" class="Bound">b</a> <a id="1200" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1202" href="stack.html#1176" class="Bound">s</a><a id="1203" class="Symbol">)</a>


<a id="1207" class="Comment">-- Stack transformer</a>
<a id="StackTransformer"></a><a id="1228" href="stack.html#1228" class="Function">StackTransformer</a> <a id="1245" class="Symbol">:</a> <a id="1247" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1251" href="stack.html#1228" class="Function">StackTransformer</a> <a id="1268" class="Symbol">=</a> <a id="1270" href="basicBitcoinDataType.html#694" class="Function">Time</a> <a id="1275" class="Symbol">→</a> <a id="1277" href="basicBitcoinDataType.html#886" class="Datatype">Msg</a> <a id="1281" class="Symbol">→</a> <a id="1283" href="stack.html#772" class="Function">Stack</a> <a id="1289" class="Symbol">→</a> <a id="1291" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1297" href="stack.html#772" class="Function">Stack</a>

<a id="1304" class="Comment">-- function that checking if the stack is empty or the top element is false</a>
<a id="checkStackAux"></a><a id="1380" href="stack.html#1380" class="Function">checkStackAux</a> <a id="1394" class="Symbol">:</a> <a id="1396" href="stack.html#772" class="Function">Stack</a> <a id="1402" class="Symbol">→</a> <a id="1404" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1409" href="stack.html#1380" class="Function">checkStackAux</a> <a id="1423" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>  <a id="1427" class="Symbol">=</a> <a id="1429" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="1435" href="stack.html#1380" class="Function">checkStackAux</a> <a id="1449" class="Symbol">(</a><a id="1450" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="1455" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1457" href="stack.html#1457" class="Bound">bitcoinStack₁</a><a id="1470" class="Symbol">)</a>  <a id="1473" class="Symbol">=</a> <a id="1475" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="1481" href="stack.html#1380" class="Function">checkStackAux</a> <a id="1495" class="Symbol">(</a><a id="1496" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1500" href="stack.html#1500" class="Bound">x</a> <a id="1502" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1504" href="stack.html#1504" class="Bound">bitcoinStack₁</a><a id="1517" class="Symbol">)</a>  <a id="1520" class="Symbol">=</a> <a id="1522" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>

<a id="1528" class="Comment">-- lifting the checkStackAux to Maybe StackIfStack data type</a>
<a id="checkStack"></a><a id="1589" href="stack.html#1589" class="Function">checkStack</a> <a id="1600" class="Symbol">:</a>  <a id="1603" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1609" href="stack.html#772" class="Function">Stack</a>   <a id="1617" class="Symbol">→</a> <a id="1619" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1624" href="stack.html#1589" class="Function">checkStack</a> <a id="1635" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="1643" class="Symbol">=</a> <a id="1645" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="1651" href="stack.html#1589" class="Function">checkStack</a> <a id="1662" class="Symbol">(</a><a id="1663" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1668" href="stack.html#1668" class="Bound">x</a><a id="1669" class="Symbol">)</a> <a id="1671" class="Symbol">=</a> <a id="1673" href="stack.html#1380" class="Function">checkStackAux</a> <a id="1687" href="stack.html#1668" class="Bound">x</a>
</pre></body></html>