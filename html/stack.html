<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>stack</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="stack.html" class="Module">stack</a> <a id="14" class="Keyword">where</a>

<a id="21" class="Keyword">open</a> <a id="26" class="Keyword">import</a> <a id="33" href="Data.Nat.html" class="Module">Data.Nat</a>  <a id="43" class="Keyword">hiding</a> <a id="50" class="Symbol">(</a><a id="51" href="Data.Nat.Base.html#1535" class="Datatype Operator">_≤_</a><a id="54" class="Symbol">)</a>
<a id="56" class="Keyword">open</a> <a id="61" class="Keyword">import</a> <a id="68" href="Data.List.html" class="Module">Data.List</a> <a id="78" class="Keyword">hiding</a> <a id="85" class="Symbol">(</a><a id="86" href="Data.List.Base.html#1810" class="Function Operator">_++_</a><a id="90" class="Symbol">)</a>
<a id="92" class="Keyword">open</a> <a id="97" class="Keyword">import</a> <a id="104" href="Data.Unit.html" class="Module">Data.Unit</a>  <a id="115" class="Keyword">hiding</a> <a id="122" class="Symbol">(</a><a id="123" href="Data.Unit.Base.html#1023" class="Record Operator">_≤_</a><a id="126" class="Symbol">)</a>
<a id="128" class="Keyword">open</a> <a id="133" class="Keyword">import</a> <a id="140" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="151" class="Keyword">open</a> <a id="156" class="Keyword">import</a> <a id="163" href="Data.Maybe.html" class="Module">Data.Maybe</a>
<a id="174" class="Keyword">open</a> <a id="179" class="Keyword">import</a> <a id="186" href="Data.Bool.html" class="Module">Data.Bool</a>  <a id="197" class="Keyword">hiding</a> <a id="204" class="Symbol">(</a><a id="205" href="Data.Bool.Base.html#672" class="Datatype Operator">_≤_</a> <a id="209" class="Symbol">;</a> <a id="211" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a> <a id="225" class="Symbol">)</a> <a id="227" class="Keyword">renaming</a> <a id="236" class="Symbol">(</a><a id="237" href="Data.Bool.Base.html#986" class="Function Operator">_∧_</a> <a id="241" class="Symbol">to</a> <a id="244" class="Function Operator">_∧b_</a> <a id="249" class="Symbol">;</a> <a id="251" href="Data.Bool.Base.html#1044" class="Function Operator">_∨_</a> <a id="255" class="Symbol">to</a> <a id="258" class="Function Operator">_∨b_</a> <a id="263" class="Symbol">;</a> <a id="265" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="267" class="Symbol">to</a> <a id="270" class="Function">True</a><a id="274" class="Symbol">)</a>
<a id="276" class="Keyword">open</a> <a id="281" class="Keyword">import</a> <a id="288" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="303" class="Keyword">hiding</a> <a id="310" class="Symbol">(</a><a id="311" href="Data.Bool.Base.html#672" class="Datatype Operator">_≤_</a> <a id="315" class="Symbol">;</a> <a id="317" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a> <a id="331" class="Symbol">)</a> <a id="333" class="Keyword">renaming</a> <a id="342" class="Symbol">(</a><a id="343" href="Data.Bool.Base.html#986" class="Function Operator">_∧_</a> <a id="347" class="Symbol">to</a> <a id="350" class="Function Operator">_∧b_</a> <a id="355" class="Symbol">;</a> <a id="357" href="Data.Bool.Base.html#1044" class="Function Operator">_∨_</a> <a id="361" class="Symbol">to</a> <a id="364" class="Function Operator">_∨b_</a> <a id="369" class="Symbol">;</a> <a id="371" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="373" class="Symbol">to</a> <a id="376" class="Function">True</a><a id="380" class="Symbol">)</a>
<a id="382" class="Keyword">open</a> <a id="387" class="Keyword">import</a> <a id="394" href="Data.Product.html" class="Module">Data.Product</a> <a id="407" class="Keyword">renaming</a> <a id="416" class="Symbol">(</a><a id="417" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="421" class="Symbol">to</a> <a id="424" class="InductiveConstructor Operator">_,,_</a> <a id="429" class="Symbol">)</a>
<a id="431" class="Keyword">open</a> <a id="436" class="Keyword">import</a> <a id="443" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="457" class="Keyword">hiding</a> <a id="464" class="Symbol">(</a><a id="465" href="Data.Nat.Base.html#1535" class="Datatype Operator">_≤_</a><a id="468" class="Symbol">)</a>
<a id="470" class="Keyword">open</a> <a id="475" class="Keyword">import</a> <a id="482" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="501" class="Keyword">hiding</a> <a id="508" class="Symbol">(</a><a id="509" href="Data.List.NonEmpty.Base.html#1141" class="Field">head</a><a id="513" class="Symbol">)</a>

<a id="516" class="Keyword">open</a> <a id="521" class="Keyword">import</a> <a id="528" href="libraries.listLib.html" class="Module">libraries.listLib</a>
<a id="546" class="Keyword">open</a> <a id="551" class="Keyword">import</a> <a id="558" href="libraries.natLib.html" class="Module">libraries.natLib</a>
<a id="575" class="Keyword">open</a> <a id="580" class="Keyword">import</a> <a id="587" href="libraries.boolLib.html" class="Module">libraries.boolLib</a>

<a id="606" class="Keyword">open</a> <a id="611" class="Keyword">import</a> <a id="618" href="libraries.andLib.html" class="Module">libraries.andLib</a>
<a id="635" class="Keyword">open</a> <a id="640" class="Keyword">import</a> <a id="647" href="libraries.maybeLib.html" class="Module">libraries.maybeLib</a>

<a id="667" class="Keyword">open</a> <a id="672" class="Keyword">import</a> <a id="679" href="basicBitcoinDataType.html" class="Module">basicBitcoinDataType</a>


<a id="Stack"></a><a id="702" href="stack.html#702" class="Function">Stack</a> <a id="708" class="Symbol">:</a> <a id="710" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="714" href="stack.html#702" class="Function">Stack</a> <a id="720" class="Symbol">=</a> <a id="722" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="727" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>


<a id="stackHasSingletonTop"></a><a id="731" href="stack.html#731" class="Function">stackHasSingletonTop</a>  <a id="753" class="Symbol">:</a> <a id="755" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="757" class="Symbol">→</a>   <a id="761" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="767" href="stack.html#702" class="Function">Stack</a> <a id="773" class="Symbol">→</a>  <a id="776" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="781" href="stack.html#731" class="Function">stackHasSingletonTop</a> <a id="802" href="stack.html#802" class="Bound">l</a> <a id="804" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="812" class="Symbol">=</a> <a id="814" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="820" href="stack.html#731" class="Function">stackHasSingletonTop</a> <a id="841" href="stack.html#841" class="Bound">l</a> <a id="843" class="Symbol">(</a><a id="844" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="849" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="851" class="Symbol">)</a> <a id="853" class="Symbol">=</a> <a id="855" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="861" href="stack.html#731" class="Function">stackHasSingletonTop</a> <a id="882" href="stack.html#882" class="Bound">l</a> <a id="884" class="Symbol">(</a><a id="885" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="890" class="Symbol">(</a><a id="891" href="stack.html#891" class="Bound">z</a> <a id="893" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="895" href="stack.html#895" class="Bound">y</a><a id="896" class="Symbol">))</a> <a id="899" class="Symbol">=</a>  <a id="902" href="stack.html#882" class="Bound">l</a>  <a id="905" href="libraries.natLib.html#736" class="Function Operator">==b</a> <a id="909" href="stack.html#891" class="Bound">z</a>


<a id="stackHasTop"></a><a id="913" href="stack.html#913" class="Function">stackHasTop</a>  <a id="926" class="Symbol">:</a>   <a id="930" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="935" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="937" class="Symbol">→</a>  <a id="940" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a>  <a id="947" href="stack.html#702" class="Function">Stack</a> <a id="953" class="Symbol">→</a> <a id="955" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="959" href="stack.html#913" class="Function">stackHasTop</a> <a id="971" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="974" href="stack.html#974" class="Bound">m</a> <a id="976" class="Symbol">=</a> <a id="978" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="980" href="stack.html#913" class="Function">stackHasTop</a> <a id="992" class="Symbol">(</a><a id="993" href="stack.html#993" class="Bound">y</a> <a id="995" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="997" href="stack.html#997" class="Bound">n</a><a id="998" class="Symbol">)</a> <a id="1000" href="stack.html#1000" class="Bound">m</a> <a id="1002" class="Symbol">=</a> <a id="1004" href="stack.html#270" class="Function">True</a><a id="1008" class="Symbol">(</a><a id="1009" href="stack.html#731" class="Function">stackHasSingletonTop</a> <a id="1030" href="stack.html#993" class="Bound">y</a> <a id="1032" href="stack.html#1000" class="Bound">m</a><a id="1033" class="Symbol">)</a>

<a id="stackAuxFunction"></a><a id="1036" href="stack.html#1036" class="Function">stackAuxFunction</a> <a id="1053" class="Symbol">:</a>  <a id="1056" href="stack.html#702" class="Function">Stack</a> <a id="1062" class="Symbol">→</a> <a id="1064" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="1069" class="Symbol">→</a> <a id="1071" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1077" href="stack.html#702" class="Function">Stack</a>
<a id="1083" href="stack.html#1036" class="Function">stackAuxFunction</a> <a id="1100" href="stack.html#1100" class="Bound">s</a> <a id="1102" href="stack.html#1102" class="Bound">b</a> <a id="1104" class="Symbol">=</a> <a id="1106" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1111" class="Symbol">(</a><a id="1112" href="libraries.natLib.html#890" class="Function">boolToNat</a> <a id="1122" href="stack.html#1102" class="Bound">b</a> <a id="1124" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1126" href="stack.html#1100" class="Bound">s</a><a id="1127" class="Symbol">)</a>


<a id="1131" class="Comment">-- Stack transformer</a>
<a id="StackTransformer"></a><a id="1152" href="stack.html#1152" class="Function">StackTransformer</a> <a id="1169" class="Symbol">:</a> <a id="1171" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1175" href="stack.html#1152" class="Function">StackTransformer</a> <a id="1192" class="Symbol">=</a> <a id="1194" href="basicBitcoinDataType.html#662" class="Function">Time</a> <a id="1199" class="Symbol">→</a> <a id="1201" href="basicBitcoinDataType.html#854" class="Datatype">Msg</a> <a id="1205" class="Symbol">→</a> <a id="1207" href="stack.html#702" class="Function">Stack</a> <a id="1213" class="Symbol">→</a> <a id="1215" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1221" href="stack.html#702" class="Function">Stack</a>

<a id="1228" class="Comment">-- function that checking if the stack is empty or the top element is false</a>
<a id="checkStackAux"></a><a id="1304" href="stack.html#1304" class="Function">checkStackAux</a> <a id="1318" class="Symbol">:</a> <a id="1320" href="stack.html#702" class="Function">Stack</a> <a id="1326" class="Symbol">→</a> <a id="1328" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1333" href="stack.html#1304" class="Function">checkStackAux</a> <a id="1347" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>  <a id="1351" class="Symbol">=</a> <a id="1353" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="1359" href="stack.html#1304" class="Function">checkStackAux</a> <a id="1373" class="Symbol">(</a><a id="1374" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="1379" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1381" href="stack.html#1381" class="Bound">bitcoinStack₁</a><a id="1394" class="Symbol">)</a>  <a id="1397" class="Symbol">=</a> <a id="1399" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="1405" href="stack.html#1304" class="Function">checkStackAux</a> <a id="1419" class="Symbol">(</a><a id="1420" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1424" href="stack.html#1424" class="Bound">x</a> <a id="1426" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1428" href="stack.html#1428" class="Bound">bitcoinStack₁</a><a id="1441" class="Symbol">)</a>  <a id="1444" class="Symbol">=</a> <a id="1446" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>

<a id="1452" class="Comment">-- lifting the checkStackAux to Maybe StackIfStack data type</a>
<a id="checkStack"></a><a id="1513" href="stack.html#1513" class="Function">checkStack</a> <a id="1524" class="Symbol">:</a>  <a id="1527" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1533" href="stack.html#702" class="Function">Stack</a>   <a id="1541" class="Symbol">→</a> <a id="1543" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1548" href="stack.html#1513" class="Function">checkStack</a> <a id="1559" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="1567" class="Symbol">=</a> <a id="1569" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="1575" href="stack.html#1513" class="Function">checkStack</a> <a id="1586" class="Symbol">(</a><a id="1587" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1592" href="stack.html#1592" class="Bound">x</a><a id="1593" class="Symbol">)</a> <a id="1595" class="Symbol">=</a> <a id="1597" href="stack.html#1304" class="Function">checkStackAux</a> <a id="1611" href="stack.html#1592" class="Bound">x</a>
</pre></body></html>