<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>stack</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="stack.html" class="Module">stack</a> <a id="14" class="Keyword">where</a>

<a id="21" class="Keyword">open</a> <a id="26" class="Keyword">import</a> <a id="33" href="Data.Nat.html" class="Module">Data.Nat</a>  <a id="43" class="Keyword">hiding</a> <a id="50" class="Symbol">(</a><a id="51" href="Data.Nat.Base.html#1691" class="Datatype Operator">_≤_</a><a id="54" class="Symbol">)</a>
<a id="56" class="Keyword">open</a> <a id="61" class="Keyword">import</a> <a id="68" href="Data.List.html" class="Module">Data.List</a> <a id="78" class="Keyword">hiding</a> <a id="85" class="Symbol">(</a><a id="86" href="Data.List.Base.html#1954" class="Function Operator">_++_</a><a id="90" class="Symbol">)</a>
<a id="92" class="Keyword">open</a> <a id="97" class="Keyword">import</a> <a id="104" href="Data.Unit.html" class="Module">Data.Unit</a>  
<a id="116" class="Keyword">open</a> <a id="121" class="Keyword">import</a> <a id="128" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="Data.Maybe.html" class="Module">Data.Maybe</a>
<a id="162" class="Keyword">open</a> <a id="167" class="Keyword">import</a> <a id="174" href="Data.Bool.html" class="Module">Data.Bool</a>  <a id="185" class="Keyword">hiding</a> <a id="192" class="Symbol">(</a><a id="193" href="Data.Bool.Base.html#681" class="Datatype Operator">_≤_</a> <a id="197" class="Symbol">;</a> <a id="199" href="Data.Bool.Base.html#1505" class="Function Operator">if_then_else_</a> <a id="213" class="Symbol">)</a> <a id="215" class="Keyword">renaming</a> <a id="224" class="Symbol">(</a><a id="225" href="Data.Bool.Base.html#995" class="Function Operator">_∧_</a> <a id="229" class="Symbol">to</a> <a id="232" class="Function Operator">_∧b_</a> <a id="237" class="Symbol">;</a> <a id="239" href="Data.Bool.Base.html#1053" class="Function Operator">_∨_</a> <a id="243" class="Symbol">to</a> <a id="246" class="Function Operator">_∨b_</a> <a id="251" class="Symbol">;</a> <a id="253" href="Data.Bool.Base.html#1348" class="Function">T</a> <a id="255" class="Symbol">to</a> <a id="258" class="Function">True</a><a id="262" class="Symbol">)</a>
<a id="264" class="Keyword">open</a> <a id="269" class="Keyword">import</a> <a id="276" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="291" class="Keyword">hiding</a> <a id="298" class="Symbol">(</a><a id="299" href="Data.Bool.Base.html#681" class="Datatype Operator">_≤_</a> <a id="303" class="Symbol">;</a> <a id="305" href="Data.Bool.Base.html#1505" class="Function Operator">if_then_else_</a> <a id="319" class="Symbol">)</a> <a id="321" class="Keyword">renaming</a> <a id="330" class="Symbol">(</a><a id="331" href="Data.Bool.Base.html#995" class="Function Operator">_∧_</a> <a id="335" class="Symbol">to</a> <a id="338" class="Function Operator">_∧b_</a> <a id="343" class="Symbol">;</a> <a id="345" href="Data.Bool.Base.html#1053" class="Function Operator">_∨_</a> <a id="349" class="Symbol">to</a> <a id="352" class="Function Operator">_∨b_</a> <a id="357" class="Symbol">;</a> <a id="359" href="Data.Bool.Base.html#1348" class="Function">T</a> <a id="361" class="Symbol">to</a> <a id="364" class="Function">True</a><a id="368" class="Symbol">)</a>
<a id="370" class="Keyword">open</a> <a id="375" class="Keyword">import</a> <a id="382" href="Data.Product.html" class="Module">Data.Product</a> <a id="395" class="Keyword">renaming</a> <a id="404" class="Symbol">(</a><a id="405" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="409" class="Symbol">to</a> <a id="412" class="InductiveConstructor Operator">_,,_</a> <a id="417" class="Symbol">)</a>
<a id="419" class="Keyword">open</a> <a id="424" class="Keyword">import</a> <a id="431" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="445" class="Keyword">hiding</a> <a id="452" class="Symbol">(</a><a id="453" href="Data.Nat.Base.html#1691" class="Datatype Operator">_≤_</a><a id="456" class="Symbol">)</a>
<a id="458" class="Keyword">open</a> <a id="463" class="Keyword">import</a> <a id="470" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="489" class="Keyword">hiding</a> <a id="496" class="Symbol">(</a><a id="497" href="Data.List.NonEmpty.Base.html#1291" class="Field">head</a><a id="501" class="Symbol">)</a>

<a id="504" class="Keyword">open</a> <a id="509" class="Keyword">import</a> <a id="516" href="libraries.listLib.html" class="Module">libraries.listLib</a>
<a id="534" class="Keyword">open</a> <a id="539" class="Keyword">import</a> <a id="546" href="libraries.natLib.html" class="Module">libraries.natLib</a>
<a id="563" class="Keyword">open</a> <a id="568" class="Keyword">import</a> <a id="575" href="libraries.boolLib.html" class="Module">libraries.boolLib</a>

<a id="594" class="Keyword">open</a> <a id="599" class="Keyword">import</a> <a id="606" href="libraries.andLib.html" class="Module">libraries.andLib</a>
<a id="623" class="Keyword">open</a> <a id="628" class="Keyword">import</a> <a id="635" href="libraries.maybeLib.html" class="Module">libraries.maybeLib</a>

<a id="655" class="Keyword">open</a> <a id="660" class="Keyword">import</a> <a id="667" href="basicBitcoinDataType.html" class="Module">basicBitcoinDataType</a>


<a id="Stack"></a><a id="690" href="stack.html#690" class="Function">Stack</a> <a id="696" class="Symbol">:</a> <a id="698" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="702" href="stack.html#690" class="Function">Stack</a> <a id="708" class="Symbol">=</a> <a id="710" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="715" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>


<a id="stackHasSingletonTop"></a><a id="719" href="stack.html#719" class="Function">stackHasSingletonTop</a>  <a id="741" class="Symbol">:</a> <a id="743" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="745" class="Symbol">→</a>   <a id="749" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="755" href="stack.html#690" class="Function">Stack</a> <a id="761" class="Symbol">→</a>  <a id="764" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="769" href="stack.html#719" class="Function">stackHasSingletonTop</a> <a id="790" href="stack.html#790" class="Bound">l</a> <a id="792" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="800" class="Symbol">=</a> <a id="802" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="808" href="stack.html#719" class="Function">stackHasSingletonTop</a> <a id="829" href="stack.html#829" class="Bound">l</a> <a id="831" class="Symbol">(</a><a id="832" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="837" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="839" class="Symbol">)</a> <a id="841" class="Symbol">=</a> <a id="843" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="849" href="stack.html#719" class="Function">stackHasSingletonTop</a> <a id="870" href="stack.html#870" class="Bound">l</a> <a id="872" class="Symbol">(</a><a id="873" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="878" class="Symbol">(</a><a id="879" href="stack.html#879" class="Bound">z</a> <a id="881" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="883" href="stack.html#883" class="Bound">y</a><a id="884" class="Symbol">))</a> <a id="887" class="Symbol">=</a>  <a id="890" href="stack.html#870" class="Bound">l</a>  <a id="893" href="libraries.natLib.html#723" class="Function Operator">==b</a> <a id="897" href="stack.html#879" class="Bound">z</a>


<a id="stackHasTop"></a><a id="901" href="stack.html#901" class="Function">stackHasTop</a>  <a id="914" class="Symbol">:</a>   <a id="918" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="923" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="925" class="Symbol">→</a>  <a id="928" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a>  <a id="935" href="stack.html#690" class="Function">Stack</a> <a id="941" class="Symbol">→</a> <a id="943" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="947" href="stack.html#901" class="Function">stackHasTop</a> <a id="959" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="962" href="stack.html#962" class="Bound">m</a> <a id="964" class="Symbol">=</a> <a id="966" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="968" href="stack.html#901" class="Function">stackHasTop</a> <a id="980" class="Symbol">(</a><a id="981" href="stack.html#981" class="Bound">y</a> <a id="983" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="985" href="stack.html#985" class="Bound">n</a><a id="986" class="Symbol">)</a> <a id="988" href="stack.html#988" class="Bound">m</a> <a id="990" class="Symbol">=</a> <a id="992" href="stack.html#258" class="Function">True</a><a id="996" class="Symbol">(</a><a id="997" href="stack.html#719" class="Function">stackHasSingletonTop</a> <a id="1018" href="stack.html#981" class="Bound">y</a> <a id="1020" href="stack.html#988" class="Bound">m</a><a id="1021" class="Symbol">)</a>

<a id="stackAuxFunction"></a><a id="1024" href="stack.html#1024" class="Function">stackAuxFunction</a> <a id="1041" class="Symbol">:</a>  <a id="1044" href="stack.html#690" class="Function">Stack</a> <a id="1050" class="Symbol">→</a> <a id="1052" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a> <a id="1057" class="Symbol">→</a> <a id="1059" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1065" href="stack.html#690" class="Function">Stack</a>
<a id="1071" href="stack.html#1024" class="Function">stackAuxFunction</a> <a id="1088" href="stack.html#1088" class="Bound">s</a> <a id="1090" href="stack.html#1090" class="Bound">b</a> <a id="1092" class="Symbol">=</a> <a id="1094" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1099" class="Symbol">(</a><a id="1100" href="libraries.natLib.html#877" class="Function">boolToNat</a> <a id="1110" href="stack.html#1090" class="Bound">b</a> <a id="1112" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1114" href="stack.html#1088" class="Bound">s</a><a id="1115" class="Symbol">)</a>


<a id="1119" class="Comment">-- Stack transformer</a>
<a id="StackTransformer"></a><a id="1140" href="stack.html#1140" class="Function">StackTransformer</a> <a id="1157" class="Symbol">:</a> <a id="1159" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1163" href="stack.html#1140" class="Function">StackTransformer</a> <a id="1180" class="Symbol">=</a> <a id="1182" href="basicBitcoinDataType.html#650" class="Function">Time</a> <a id="1187" class="Symbol">→</a> <a id="1189" href="basicBitcoinDataType.html#842" class="Datatype">Msg</a> <a id="1193" class="Symbol">→</a> <a id="1195" href="stack.html#690" class="Function">Stack</a> <a id="1201" class="Symbol">→</a> <a id="1203" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1209" href="stack.html#690" class="Function">Stack</a>

<a id="1216" class="Comment">-- function that checking if the stack is empty or the top element is false</a>
<a id="checkStackAux"></a><a id="1292" href="stack.html#1292" class="Function">checkStackAux</a> <a id="1306" class="Symbol">:</a> <a id="1308" href="stack.html#690" class="Function">Stack</a> <a id="1314" class="Symbol">→</a> <a id="1316" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1321" href="stack.html#1292" class="Function">checkStackAux</a> <a id="1335" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>  <a id="1339" class="Symbol">=</a> <a id="1341" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="1347" href="stack.html#1292" class="Function">checkStackAux</a> <a id="1361" class="Symbol">(</a><a id="1362" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="1367" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1369" href="stack.html#1369" class="Bound">bitcoinStack₁</a><a id="1382" class="Symbol">)</a>  <a id="1385" class="Symbol">=</a> <a id="1387" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="1393" href="stack.html#1292" class="Function">checkStackAux</a> <a id="1407" class="Symbol">(</a><a id="1408" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1412" href="stack.html#1412" class="Bound">x</a> <a id="1414" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1416" href="stack.html#1416" class="Bound">bitcoinStack₁</a><a id="1429" class="Symbol">)</a>  <a id="1432" class="Symbol">=</a> <a id="1434" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>

<a id="1440" class="Comment">-- lifting the checkStackAux to Maybe StackIfStack data type</a>
<a id="checkStack"></a><a id="1501" href="stack.html#1501" class="Function">checkStack</a> <a id="1512" class="Symbol">:</a>  <a id="1515" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1521" href="stack.html#690" class="Function">Stack</a>   <a id="1529" class="Symbol">→</a> <a id="1531" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1536" href="stack.html#1501" class="Function">checkStack</a> <a id="1547" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1555" class="Symbol">=</a> <a id="1557" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="1563" href="stack.html#1501" class="Function">checkStack</a> <a id="1574" class="Symbol">(</a><a id="1575" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1580" href="stack.html#1580" class="Bound">x</a><a id="1581" class="Symbol">)</a> <a id="1583" class="Symbol">=</a> <a id="1585" href="stack.html#1292" class="Function">checkStackAux</a> <a id="1599" href="stack.html#1580" class="Bound">x</a>
</pre></body></html>